<?xml version="1.0" encoding="UTF-8"?>
<Package Id="null" Name="BCOM_TRAVEL"  xmlns="http://www.wfmc.org/2002/XPDL1.0" xmlns:xpdl="http://www.wfmc.org/2002/XPDL1.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.wfmc.org/2002/XPDL1.0 http://wfmc.org/standards/docs/TC-1025_schema_10_xpdl.xsd">
 <PackageHeader>
  <XPDLVersion>1.0</XPDLVersion>
  <Vendor>Ilex Meibo</Vendor>
 </PackageHeader>
 <RedefinableHeader PublicationStatus="RELEASED">
  <Author>Meibo</Author>
  <Version>3</Version>
 </RedefinableHeader>
 <ConformanceClass GraphConformance="NON_BLOCKED"/>
 <WorkflowProcesses>
  <WorkflowProcess AccessLevel="PUBLIC" Id="1397224855079" Name="Processus_ARRIVEE_PERSONNE">
   <ProcessHeader DurationUnit="D">
    <Description>Processus Meibo</Description>
   </ProcessHeader>
   <RedefinableHeader PublicationStatus="RELEASED">
    <Author>Meibo</Author>
    <Version>3</Version>
   </RedefinableHeader>
   <ExtendedAttributes>
    <ExtendedAttribute Name="scale"  Value="100%"/>
    <ExtendedAttribute Name="role"  Value="AdminInventaire"/>
    <ExtendedAttribute Name="role"  Value="AdminMeibo"/>
    <ExtendedAttribute Name="role"  Value="AdminSGeneraux"/>
    <ExtendedAttribute Name="role"  Value="AdminTelephonie"/>
    <ExtendedAttribute Name="role"  Value="RH"/>
    <ExtendedAttribute Name="role"  Value="Studio"/>
    <ExtendedAttribute Name="fr_name"  Value="Processus_ARRIVEE_PERSONNE"/>
    <ExtendedAttribute Name="fr_description"  Value=""/>
    <ExtendedAttribute Name="actionsList" Value="">
      <Action Name="Notification_InExtenso" Type="pluginMail-1" ID="1401954256837">
<plugin en="Plugin to send e-mails (v1.2)" fr="Plugin d&apos;envoi d&apos;e-mails (v1.2)" name="pluginMail-1">
  <subject>{process.ARR02_OBJET}</subject>
  <html>true</html>
  <body>{process.MAILS_ENTETE}&#10;{process.ARR02_MESSAGE}&#10;{process.MAILS_SIGNATURE}</body>
  <files>&#10;  </files>
  <to>
    <mail>
      <mail>{process.MAIL_inExtenso}</mail>
    </mail>
  </to>
  <cc>&#10;  </cc>
  <bcc>&#10;  </bcc>
  <from>{process.MAIL_MEIBO}</from>
  <debug>true</debug>
  <SMTPAuth>true</SMTPAuth>
</plugin>

      </Action>
      <Action Name="Notification_Mobile" Type="pluginMail-1" ID="1401954653738">
<plugin en="Plugin to send e-mails (v1.2)" fr="Plugin d&apos;envoi d&apos;e-mails (v1.2)" name="pluginMail-1">
  <subject>{process.ARR01_OBJET}</subject>
  <html>true</html>
  <body>{process.MAILS_ENTETE}&#10;{process.ARR01_MESSAGE}&#10;{process.MAILS_SIGNATURE}</body>
  <files>&#10;  </files>
  <to>
    <mail>
      <mail>{process.sendMailAdminTelephonie}</mail>
    </mail>
  </to>
  <cc>&#10;  </cc>
  <bcc>&#10;  </bcc>
  <from>{process.MAIL_MEIBO}</from>
  <debug>false</debug>
  <SMTPAuth>true</SMTPAuth>
</plugin>

      </Action>
      <Action Name="Notification_Xivo" Type="pluginMail-1" ID="1401955166621">
<plugin en="Plugin to send e-mails (v1.2)" fr="Plugin d&apos;envoi d&apos;e-mails (v1.2)" name="pluginMail-1">
  <subject>{process.ARR04_OBJET}</subject>
  <html>true</html>
  <body>{process.MAILS_ENTETE}&#10;{process.ARR04_MESSAGE}&#10;{process.MAILS_SIGNATURE}</body>
  <files>&#10;  </files>
  <to>
    <mail>
      <mail>{process.sendMailAdminTelephonie}</mail>
    </mail>
  </to>
  <cc>&#10;  </cc>
  <bcc>&#10;  </bcc>
  <from>{process.MAIL_MEIBO}</from>
  <debug>false</debug>
  <SMTPAuth>true</SMTPAuth>
</plugin>

      </Action>
      <Action Name="Notification_AlerteArrivee" Type="pluginMail-1" ID="1401955422257">
<plugin en="Plugin to send e-mails (v1.2)" fr="Plugin d&apos;envoi d&apos;e-mails (v1.2)" name="pluginMail-1">
  <subject>{process.ARR07_OBJET}</subject>
  <html>true</html>
  <body>{process.MAILS_ENTETE}&#10;{process.ARR07_MESSAGE}&#10;{process.MAILS_SIGNATURE}</body>
  <files>&#10;  </files>
  <to>
    <mail>
      <mail>{process.sendMailAlerteArrivee}</mail>
    </mail>
  </to>
  <cc>&#10;  </cc>
  <bcc>&#10;  </bcc>
  <from>{process.MAIL_MEIBO}</from>
  <debug>false</debug>
  <SMTPAuth>true</SMTPAuth>
</plugin>

      </Action>
      <Action Name="Notification_Arrivee" Type="pluginMail-1" ID="1401956012478">
<plugin en="Plugin to send e-mails (v1.2)" fr="Plugin d&apos;envoi d&apos;e-mails (v1.2)" name="pluginMail-1">
  <subject>{process.ARR08_OBJET}</subject>
  <html>true</html>
  <body>{process.MAILS_ENTETE}&#10;{process.ARR08_MESSAGE}&#10;{process.MAILS_SIGNATURE}</body>
  <files>&#10;  </files>
  <to>
    <mail>
      <mail>{process.sendMailArrivee}</mail>
    </mail>
  </to>
  <cc>&#10;  </cc>
  <bcc>&#10;  </bcc>
  <from>{process.MAIL_MEIBO}</from>
  <debug>false</debug>
  <SMTPAuth>true</SMTPAuth>
</plugin>

      </Action>
      <Action Name="Notification_Helpdesk" Type="pluginMail-1" ID="1401956266341">
<plugin en="Plugin to send e-mails (v1.2)" fr="Plugin d&apos;envoi d&apos;e-mails (v1.2)" name="pluginMail-1">
  <subject>{process.ARR09_OBJET}</subject>
  <html>true</html>
  <body>{process.MAILS_ENTETE}&#10;{process.ARR09_MESSAGE}&#10;{process.MAILS_SIGNATURE}</body>
  <files>&#10;  </files>
  <to>
    <mail>
      <mail>{process.sendMailHelpdesk}</mail>
    </mail>
  </to>
  <cc>&#10;  </cc>
  <bcc>&#10;  </bcc>
  <from>{process.MAIL_MEIBO}</from>
  <debug>false</debug>
  <SMTPAuth>true</SMTPAuth>
</plugin>

      </Action>
    </ExtendedAttribute>
   </ExtendedAttributes>
   <DataFields>
   </DataFields>
   <FormalParameters>
    <FormalParameter Id="TestMobile" Index="0" Mode="INOUT">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="TestExterne" Index="1" Mode="INOUT">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="TestTelephone" Index="2" Mode="INOUT">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="civilite" Index="3" Mode="INOUT">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="sn" Index="4" Mode="INOUT">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="givenName" Index="5" Mode="INOUT">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="dateArrivee" Index="6" Mode="INOUT">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="grp_contrat" Index="7" Mode="INOUT">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="pourcentagePresence" Index="8" Mode="INOUT">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="dateFinContrat" Index="9" Mode="INOUT">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="manager" Index="10" Mode="INOUT">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="company" Index="11" Mode="INOUT">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="dotation" Index="12" Mode="INOUT">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="habilitationFonctionnelle" Index="13" Mode="INOUT">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="habilitationOperationnelle" Index="14" Mode="INOUT">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="dateAttenteArriveeJM14" Index="15" Mode="INOUT">
     <DataType>
      <BasicType Type="DEADLINE"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="dateAttenteArrivee" Index="16" Mode="INOUT">
     <DataType>
      <BasicType Type="DEADLINE"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="MAIL_MEIBO" Index="17" Mode="INOUT">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="MAILS_ENTETE" Index="18" Mode="INOUT">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="MAILS_SIGNATURE" Index="19" Mode="INOUT">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="MAIL_inExtenso" Index="20" Mode="INOUT">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="MAIL_ACCUEIL" Index="21" Mode="INOUT">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="ARR01_OBJET" Index="22" Mode="INOUT">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="ARR01_MESSAGE" Index="23" Mode="INOUT">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="ARR02_OBJET" Index="24" Mode="INOUT">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="ARR02_MESSAGE" Index="25" Mode="INOUT">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="ARR03_OBJET" Index="26" Mode="INOUT">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="ARR03_MESSAGE" Index="27" Mode="INOUT">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="ARR04_OBJET" Index="28" Mode="INOUT">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="ARR04_MESSAGE" Index="29" Mode="INOUT">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="ARR05_OBJET" Index="30" Mode="INOUT">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="ARR05_MESSAGE" Index="31" Mode="INOUT">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="ARR06_OBJET" Index="32" Mode="INOUT">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="ARR06_MESSAGE" Index="33" Mode="INOUT">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="ARR07_OBJET" Index="34" Mode="INOUT">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="ARR07_MESSAGE" Index="35" Mode="INOUT">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="ARR08_OBJET" Index="36" Mode="INOUT">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="ARR08_MESSAGE" Index="37" Mode="INOUT">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="BCOM_LIEN_MEIBO" Index="38" Mode="INOUT">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="sendMailAdminTelephonie" Index="39" Mode="INOUT">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="sendMailAdminInventaire" Index="40" Mode="INOUT">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="sendMailAdminSGeneraux" Index="41" Mode="INOUT">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="sendMailRH" Index="42" Mode="INOUT">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="sendMailManager" Index="43" Mode="INOUT">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="dnPers" Index="44" Mode="INOUT">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="telephoneMobile" Index="45" Mode="INOUT">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="telephoneFixe" Index="46" Mode="INOUT">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="badgeID" Index="47" Mode="INOUT">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="idAD" Index="48" Mode="INOUT">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="boiteMail" Index="49" Mode="INOUT">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="lieu" Index="50" Mode="INOUT">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="BCOM_ARRIVEE_AD_MDP_USER" Index="51" Mode="INOUT">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="sendMailHelpdesk" Index="52" Mode="INOUT">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="ARR09_MESSAGE" Index="53" Mode="INOUT">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="ARR09_OBJET" Index="54" Mode="INOUT">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="retourXivo" Index="55" Mode="INOUT">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="sendMailAlerteArrivee" Index="56" Mode="INOUT">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="sendMailArrivee" Index="57" Mode="INOUT">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="GGU_PersonList" Index="58" Mode="INOUT">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </FormalParameter>
   </FormalParameters>
   <Participants>
    <Participant Id="AdminInventaire" Name="AdminInventaire">
     <ParticipantType Type="ROLE"/>
    </Participant>
    <Participant Id="AdminMeibo" Name="AdminMeibo">
     <ParticipantType Type="ROLE"/>
    </Participant>
    <Participant Id="AdminSGeneraux" Name="AdminSGeneraux">
     <ParticipantType Type="ROLE"/>
    </Participant>
    <Participant Id="AdminTelephonie" Name="AdminTelephonie">
     <ParticipantType Type="ROLE"/>
    </Participant>
    <Participant Id="RH" Name="RH">
     <ParticipantType Type="ROLE"/>
    </Participant>
    <Participant Id="Studio" Name="Studio">
     <ParticipantType Type="ROLE"/>
    </Participant>
    <Participant Id="Utilisateur" Name="Utilisateur">
     <ParticipantType Type="ROLE"/>
    </Participant>
   </Participants>
   <Activities>
    <Activity Id="A1397226310200" Name="">
     <Description></Description>
     <Route/>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Manual</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="XOR"/>
       <Split Type="AND">
        <TransitionRefs>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="Debut"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="0"/>
      <ExtendedAttribute Name="YOffset" Value="120"/>
      <ExtendedAttribute Name="Width" Value="120"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1397226328326" Name="">
     <Description></Description>
     <Route/>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Manual</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="AND"/>
       <Split Type="AND">
        <TransitionRefs>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="Fin"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="368"/>
      <ExtendedAttribute Name="YOffset" Value="432"/>
      <ExtendedAttribute Name="Width" Value="120"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1397226341874" Name="">
     <Description></Description>
     <Implementation>
      <Tool Id="MeiboScript" Type="SCRIPT">
       <ActualParameters>
        <ActualParameter>/**/
/* Script workflow - Provisioning AD */
/**/
/**/
/* Script modifi&#233; par akerva le 16/04
/**/ 
/////////////////////
// Debut du script //
/////////////////////  

/*R&#233;cup&#233;ration des variables workflow de la personne*/
var civilite = returnEmpty(meibo.getWorkflowVariable(&quot;civilite&quot;));
var sn = returnEmpty(meibo.getWorkflowVariable(&quot;sn&quot;));
var givenName = returnEmpty(meibo.getWorkflowVariable(&quot;givenName&quot;));
var dateArrivee = returnEmpty(meibo.getWorkflowVariable(&quot;dateArrivee&quot;));
var pourcentagePresence = returnEmpty(meibo.getWorkflowVariable(&quot;pourcentagePresence&quot;));
var dateFinContrat = returnEmpty(meibo.getWorkflowVariable(&quot;dateFinContrat&quot;));
var manager = returnEmpty(meibo.getWorkflowVariable(&quot;manager&quot;));
var company = returnEmpty(meibo.getWorkflowVariable(&quot;company&quot;));
var natureContrat = returnEmpty(meibo.getWorkflowVariable(&quot;grp_contrat&quot;));
var lieu = returnEmpty(meibo.getWorkflowVariable(&quot;lieu&quot;));
/*R&#233;cup&#233;ration de l&apos;ou des personne de l&apos;AD*/
var parameters = getProvisioningParameters_General();
var BCOM_AD_OU_PEOPLE = parameters.get(&quot;BCOM_AD_OU_PEOPLE&quot;); 

/*Cr&#233;ation d&apos;un resultset*/
var resultset = new ResultSet();
var entry = new Entry();
entry.civilite=civilite;
entry.sn=sn;
entry.givenName=givenName;
entry.dateArrivee=dateArrivee;
entry.pourcentagePresence=pourcentagePresence;
entry.dateFinContrat=dateFinContrat;
entry.manager=manager;
entry.company=company;
entry.baseDN=BCOM_AD_OU_PEOPLE;
entry.natureContrat=natureContrat;
entry.lieu=lieu;

resultset.addEntry(entry);

/*Provisioning AD*/
meibo.setGlobalVar(&quot;BCOM_ARRIVEE_AD_DN&quot;,&quot;&quot;);
meibo.setGlobalVar(&quot;BCOM_ARRIVEE_AD_IDAD&quot;,&quot;&quot;);
meibo.setGlobalVar(&quot;BCOM_ARRIVEE_AD_MDP_USER&quot;,&quot;&quot;);
var provisioningStatus = meibo.executeProvisioning(&quot;Provisioning_AD_CREATE_USER&quot;,resultset,parameters);
if ( provisioningStatus.getExitCode() != 0 ){
  var parametersMail = getProvisioningParameters_Mails();
  var parametersDroit = getProvisioningParameters_Droit();
  var messageError = provisioningStatus.getErrorMsg();//-- r&#233;cup&#233;ration du message d&apos;erreur
  var grp_adminMeibo = parametersDroit.get(&quot;BCOM_PROFIL_AdminMeibo&quot;); 
  var sendMailAdminMeibo = getAdressMailByRole(grp_adminMeibo);
  //plugin de mail d&apos;erreur
  parametersMail.add(&quot;messageError&quot;,messageError+&quot;&lt;/br&gt;&lt;/br&gt;&quot;);
  parametersMail.add(&quot;sendMailAdminMeibo&quot;,sendMailAdminMeibo);
  parametersMail.add(&quot;action&quot;,&quot;Processus d&apos;arriv&#233;e, Provisioning utilisateur dans Active Directory&quot;);
  meibo.executePlugin(&quot;Notification_ERREUR_PROVISIONING&quot;,parametersMail);
}
else{
  var dnPers = returnEmpty(meibo.getGlobalVar(&quot;BCOM_ARRIVEE_AD_DN&quot;));
  var idAD = returnEmpty(meibo.getGlobalVar(&quot;BCOM_ARRIVEE_AD_IDAD&quot;));
  var BCOM_ARRIVEE_AD_MDP_USER = returnEmpty(meibo.getGlobalVar(&quot;BCOM_ARRIVEE_AD_MDP_USER&quot;));
  meibo.setWorkflowVariable(&quot;idAD&quot;,idAD);
  meibo.setWorkflowVariable(&quot;dnPers&quot;,dnPers);
  meibo.setWorkflowVariable(&quot;BCOM_ARRIVEE_AD_MDP_USER&quot;,BCOM_ARRIVEE_AD_MDP_USER);
}

/////////////////////
// Fin du script //
/////////////////////</ActualParameter>
       </ActualParameters>
      </Tool>
     </Implementation>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Automatic</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="XOR"/>
       <Split Type="XOR">
        <TransitionRefs>
         <TransitionRef Id="T1397227488254"/>
         <TransitionRef Id="T1397814265861"/>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="Provisioning AD"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="196"/>
      <ExtendedAttribute Name="YOffset" Value="32"/>
      <ExtendedAttribute Name="Width" Value="164"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1397226380413" Name="">
     <Description></Description>
     <Implementation>
      <Tool Id="MeiboScript" Type="SCRIPT">
       <ActualParameters>
        <ActualParameter>/**/
/* Script workflow - Provisioning Exchange */
/**/
/**/
/* Script modifi&#233; par akerva le 16/04
/**/ 
/////////////////////
// Debut du script //
/////////////////////  

/*R&#233;cup&#233;ration des variables workflow de la personne*/
var idAD = returnEmpty(meibo.getWorkflowVariable(&quot;idAD&quot;));
var sn = returnEmpty(meibo.getWorkflowVariable(&quot;sn&quot;));
var givenName = returnEmpty(meibo.getWorkflowVariable(&quot;givenName&quot;));
/*R&#233;cup&#233;ration de l&apos;ou des personne de l&apos;AD*/
var parameters = getProvisioningParameters_General();


/*Cr&#233;ation d&apos;un resultset*/
var resultset = new ResultSet();
var entry = new Entry();
entry.cn=idAD;
entry.sn=sn;
entry.givenName=givenName;
resultset.addEntry(entry);

/*Provisioning AD*/

var provisioningStatus = meibo.executeProvisioning(&quot;Provisioning_EXCHANGE_CREATE_USER&quot;,resultset,parameters);
if ( provisioningStatus.getExitCode() != 0 ){
  var parametersMail = getProvisioningParameters_Mails();
  var parametersDroit = getProvisioningParameters_Droit();
  var messageError = provisioningStatus.getErrorMsg();//-- r&#233;cup&#233;ration du message d&apos;erreur
  var grp_adminMeibo = parametersDroit.get(&quot;BCOM_PROFIL_AdminMeibo&quot;); 
  var sendMailAdminMeibo = getAdressMailByRole(grp_adminMeibo);
  //plugin de mail d&apos;erreur
  parametersMail.add(&quot;messageError&quot;,messageError+&quot;&lt;/br&gt;&lt;/br&gt;&quot;);
  parametersMail.add(&quot;sendMailAdminMeibo&quot;,sendMailAdminMeibo);
   parametersMail.add(&quot;action&quot;,&quot;Processus d&apos;arriv&#233;e, Provisioning utilisateur dans Exchange&quot;);
  meibo.executePlugin(&quot;Notification_ERREUR_PROVISIONING&quot;,parametersMail);
}

/////////////////////
// Fin du script //
/////////////////////</ActualParameter>
       </ActualParameters>
      </Tool>
     </Implementation>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Automatic</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="XOR"/>
       <Split Type="AND">
        <TransitionRefs>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="Provisioning Exchange"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="528"/>
      <ExtendedAttribute Name="YOffset" Value="32"/>
      <ExtendedAttribute Name="Width" Value="181"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1397226413463" Name="">
     <Description></Description>
     <Implementation>
      <No/>
     </Implementation>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Automatic</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="XOR"/>
       <Split Type="AND">
        <TransitionRefs>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="Notification Admin Telephonie"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="1372"/>
      <ExtendedAttribute Name="YOffset" Value="136"/>
      <ExtendedAttribute Name="Width" Value="265"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1397226573706" Name="">
     <Description></Description>
     <Route/>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Manual</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="XOR"/>
       <Split Type="AND">
        <TransitionRefs>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="route"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="1668"/>
      <ExtendedAttribute Name="YOffset" Value="32"/>
      <ExtendedAttribute Name="Width" Value="120"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1397226594896" Name="">
     <Description></Description>
     <Implementation>
      <No/>
     </Implementation>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Automatic</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="XOR"/>
       <Split Type="AND">
        <TransitionRefs>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="Notification Admin Inventaire"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="1612"/>
      <ExtendedAttribute Name="YOffset" Value="396"/>
      <ExtendedAttribute Name="Width" Value="237"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1397226634794" Name="">
     <Description></Description>
     <Implementation>
      <Tool Id="MeiboScript" Type="SCRIPT">
       <ActualParameters>
        <ActualParameter>//Pas de script 
//Envoie un mail sur l&apos;&#233;venement de la t&#226;ches.</ActualParameter>
       </ActualParameters>
      </Tool>
     </Implementation>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Automatic</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="AND"/>
       <Split Type="AND">
        <TransitionRefs>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value=" Notification Admin Telephonie"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="8"/>
      <ExtendedAttribute Name="YOffset" Value="416"/>
      <ExtendedAttribute Name="Width" Value="221"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
      <ExtendedAttribute Name="Handlers" Value="HandlerList" >
<plugin en="Detect events" fr="D&#233;tection d&apos;&#233;v&#233;nements">
  <entries>
    <activity.state.Executing>
      <action>1401954653738</action>
    </activity.state.Executing>
  </entries>
</plugin>

      </ExtendedAttribute>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1397226734467" Name="">
     <Description></Description>
     <Implementation>
      <Tool Id="MeiboScript" Type="SCRIPT">
       <ActualParameters>
        <ActualParameter>//Pas de script 
//Envoie un mail sur l&apos;&#233;venement de la t&#226;ches.</ActualParameter>
       </ActualParameters>
      </Tool>
     </Implementation>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Automatic</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="AND"/>
       <Split Type="AND">
        <TransitionRefs>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="Notification InExtenso"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="412"/>
      <ExtendedAttribute Name="YOffset" Value="316"/>
      <ExtendedAttribute Name="Width" Value="217"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
      <ExtendedAttribute Name="Handlers" Value="HandlerList" >
<plugin en="Detect events" fr="D&#233;tection d&apos;&#233;v&#233;nements">
  <entries>
    <activity.state.Executing>
      <action>1401954256837</action>
    </activity.state.Executing>
  </entries>
</plugin>

      </ExtendedAttribute>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1397227289783" Name="">
     <Description></Description>
     <Route/>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Manual</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="XOR"/>
       <Split Type="XOR">
        <TransitionRefs>
         <TransitionRef Id="T1397227313339"/>
         <TransitionRef Id="T1399381950981"/>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="Mobile ?"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="56"/>
      <ExtendedAttribute Name="YOffset" Value="204"/>
      <ExtendedAttribute Name="Width" Value="120"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1397227376432" Name="">
     <Description></Description>
     <Route/>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Manual</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="XOR"/>
       <Split Type="XOR">
        <TransitionRefs>
         <TransitionRef Id="T1397227424129"/>
         <TransitionRef Id="T1399382345341"/>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="Non Externe ?"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="440"/>
      <ExtendedAttribute Name="YOffset" Value="204"/>
      <ExtendedAttribute Name="Width" Value="161"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
      <ExtendedAttribute Name="Handlers" Value="HandlerList" >
<plugin en="Detect events" fr="D&#233;tection d&apos;&#233;v&#233;nements">
  <entries>
    <script.event.>
      <name>test</name>
      <action>1401954256837</action>
    </script.event.>
  </entries>
</plugin>

      </ExtendedAttribute>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1397227514376" Name="">
     <Description></Description>
     <Route/>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Manual</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="XOR"/>
       <Split Type="XOR">
        <TransitionRefs>
         <TransitionRef Id="T1397227549346"/>
         <TransitionRef Id="T1397227849259"/>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="Telephone ?"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="772"/>
      <ExtendedAttribute Name="YOffset" Value="136"/>
      <ExtendedAttribute Name="Width" Value="148"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1397227557940" Name="">
     <Description></Description>
     <Route/>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Manual</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="XOR"/>
       <Split Type="AND">
        <TransitionRefs>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="route"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="784"/>
      <ExtendedAttribute Name="YOffset" Value="300"/>
      <ExtendedAttribute Name="Width" Value="120"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1397227571065" Name="">
     <Description></Description>
     <Implementation>
      <Tool Id="MeiboView" Type="APPLICATION">
       <ActualParameters>
        <ActualParameter>People</ActualParameter>
        <ActualParameter>Formulaire_SAISIE_NUMERO_ADX</ActualParameter>
        <ActualParameter>dnPers</ActualParameter>
       </ActualParameters>
      </Tool>
     </Implementation>
     <Performer>AdminTelephonie</Performer>
     <Priority>1</Priority>
     <StartMode>Manual</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="XOR"/>
       <Split Type="AND">
        <TransitionRefs>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="Saisie n&#176; ADX"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="1372"/>
      <ExtendedAttribute Name="YOffset" Value="212"/>
      <ExtendedAttribute Name="Width" Value="265"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1397227924968" Name="">
     <Description></Description>
     <Implementation>
      <Tool Id="MeiboScript" Type="SCRIPT">
       <ActualParameters>
        <ActualParameter>/**/
/* Script workflow - Provisioning AD + xivo */
/**/
/**/
/* Script modifi&#233; par akerva le 16/04
/**/ 
/////////////////////
// Debut du script //
/////////////////////  
var parametersMails = getProvisioningParameters_Mails();
/*R&#233;cup&#233;ration des variables workflow de la personne*/
var telephoneFixe = returnEmpty(meibo.getWorkflowVariable(&quot;telephoneFixe&quot;));
var telephoneMobile = returnEmpty(meibo.getWorkflowVariable(&quot;telephoneMobile&quot;));
var dnPers = returnEmpty(meibo.getWorkflowVariable(&quot;dnPers&quot;));

////////////////////////////////////////////////////////////////////////////////////////
//                          Active Directory
////////////////////////////////////////////////////////////////////////////////////////


/*R&#233;cup&#233;ration de l&apos;ou des personne de l&apos;AD*/
var parameters = getProvisioningParameters_General();
var BCOM_AD_OU_PEOPLE = parameters.get(&quot;BCOM_AD_OU_PEOPLE&quot;); 

/*Cr&#233;ation d&apos;un resultset*/
var resultset = new ResultSet();
var entry = new Entry();
entry.telephoneFixe=telephoneFixe;
entry.telephoneMobile=telephoneMobile;
entry.dnPers=dnPers;


resultset.addEntry(entry);

/*Provisioning AD*/

var provisioningStatus = meibo.executeProvisioning(&quot;Provisioning_AD_UPDATE_PHONE&quot;,resultset,parameters);
if ( provisioningStatus.getExitCode() != 0 ){
  
  var parametersDroit = getProvisioningParameters_Droit();
  var messageError = provisioningStatus.getErrorMsg();//-- r&#233;cup&#233;ration du message d&apos;erreur
  var grp_adminMeibo = parametersDroit.get(&quot;BCOM_PROFIL_AdminMeibo&quot;); 
  var sendMailAdminMeibo = getAdressMailByRole(grp_adminMeibo);
  //plugin de mail d&apos;erreur
  parametersMails.add(&quot;messageError&quot;,messageError+&quot;&lt;/br&gt;&lt;/br&gt;&quot;);
  parametersMails.add(&quot;sendMailAdminMeibo&quot;,sendMailAdminMeibo);
  parametersMails.add(&quot;action&quot;,&quot;Processus d&apos;arriv&#233;e, Provisioning t&#233;l&#233;phone dans Active Directory&quot;);
  meibo.executePlugin(&quot;Notification_ERREUR_PROVISIONING&quot;,parametersMails);
}

////////////////////////////////////////////////////////////////////////////////////////
//                                      XIVO
////////////////////////////////////////////////////////////////////////////////////////
/*R&#233;cup&#233;ration param&#232;tres XIVO*/
var BCOM_XIVO_USER_APIREST = parameters.get(&quot;BCOM_XIVO_USER_APIREST&quot;); 
var BCOM_XIVO_USER_MDP_APIREST = parameters.get(&quot;BCOM_XIVO_USER_MDP_APIREST&quot;); 
var BCOM_XIVO_IP_APIREST = parameters.get(&quot;BCOM_XIVO_IP_APIREST&quot;); 
var BCOM_XIVO_PORT_APIREST = parameters.get(&quot;BCOM_XIVO_PORT_APIREST&quot;); 
var BCOM_XIVO_PROFIL_USER_APIREST = parameters.get(&quot;BCOM_XIVO_PROFIL_USER_APIREST&quot;);

//r&#233;cup&#232;ration param&#232;tre utilisateur
var sn = returnEmpty(meibo.getWorkflowVariable(&quot;sn&quot;));
var givenName = returnEmpty(meibo.getWorkflowVariable(&quot;givenName&quot;));
var idAD = returnEmpty(meibo.getWorkflowVariable(&quot;idAD&quot;));
var BCOM_ARRIVEE_AD_MDP_USER = returnEmpty(meibo.getWorkflowVariable(&quot;BCOM_ARRIVEE_AD_MDP_USER&quot;));

//mise en forme des num&#233;ro de t&#233;l&#233;phone

var ipPhone = telephoneFixe.substring(12);
ipPhone = ipPhone.replace(&quot; &quot;,&quot;&quot;);

telephoneFixe = telephoneFixe.replace(&quot;+33 &quot;,&quot;0&quot;);
telephoneFixe = telephoneFixe.replace(&quot; &quot;,&quot;&quot;);

if ( telephoneMobile != &quot;&quot; ){
  telephoneMobile = telephoneMobile.replace(&quot;+33 &quot;,&quot;0&quot;);
  telephoneMobile = telephoneMobile.replace(&quot; &quot;,&quot;&quot;);
}
else{
  telephoneMobile = null;
}


//r&#233;cup&#233;ration du mail dans AD

var entry = meibo.getDnEntry(&quot;People&quot;,dnPers,&quot;mail&quot;);
var mail = returnEmpty(entry.mail[0]);
if ( mail == &quot;&quot; ){
  mail = null;
}

var x = new xivo.arrivedUser();
var retour = x.generalAction(BCOM_XIVO_USER_APIREST,BCOM_XIVO_USER_MDP_APIREST,BCOM_XIVO_IP_APIREST,parseInt(BCOM_XIVO_PORT_APIREST),miseEnForme(givenName),sn.toUpperCase(),BCOM_ARRIVEE_AD_MDP_USER,telephoneFixe,telephoneMobile,ipPhone,mail,idAD,BCOM_XIVO_PROFIL_USER_APIREST);

meibo.setWorkflowVariable(&quot;retourXivo&quot;,retour);
 
////////////////////////////////////////////////////////////////////////////////////////
//                       Preparation Notification message 4
////////////////////////////////////////////////////////////////////////////////////////
 
/*variable utilis&#233; pour le nom du processus et du message d&apos;avertissement lors de la fin du formulaire*/
/* info sur la cible */
var civilite = returnEmpty(meibo.getWorkflowVariable(&quot;civilite&quot;));
var titrePersCible = &quot;&quot; ;
if ( civilite != &quot;&quot; ){
  titrePersCible = miseEnForme(civilite) + &quot; &quot; + miseEnForme(sn) + &quot; &quot; + miseEnForme(givenName);
}
else{
  titrePersCible = miseEnForme(sn) + &quot; &quot; + miseEnForme(givenName);
} 
var ARR04_OBJET = parametersMails.get(&quot;ARR-04_OBJET&quot;);
ARR04_OBJET = ARR04_OBJET.replace(&quot;@@@displayName_Cible@@@&quot;,titrePersCible);
var ARR04_MESSAGE = parametersMails.get(&quot;ARR-04_MESSAGE&quot;);
ARR04_MESSAGE = ARR04_MESSAGE.replace(&quot;@@@displayName_Cible@@@&quot;,titrePersCible); 
if ( retour != &quot;false&quot; ){
  ARR04_MESSAGE = ARR04_MESSAGE.replace(&quot;@@@numeroXivo_Cible@@@&quot;,retour);  
}
else{
  ARR04_MESSAGE = ARR04_MESSAGE.replace(&quot;@@@numeroXivo_Cible@@@&quot;,&quot;&quot;); 
} 

meibo.setWorkflowVariable(&quot;ARR04_OBJET&quot;,ARR04_OBJET);
meibo.setWorkflowVariable(&quot;ARR04_MESSAGE&quot;,ARR04_MESSAGE);
/////////////////////
// Fin du script //
/////////////////////</ActualParameter>
       </ActualParameters>
      </Tool>
     </Implementation>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Automatic</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="XOR"/>
       <Split Type="AND">
        <TransitionRefs>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="Provisioning XIVO + Mise a jour AD"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="1376"/>
      <ExtendedAttribute Name="YOffset" Value="296"/>
      <ExtendedAttribute Name="Width" Value="261"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1397228010237" Name="">
     <Description></Description>
     <Implementation>
      <Tool Id="MeiboScript" Type="SCRIPT">
       <ActualParameters>
        <ActualParameter>//Pas de script 
//Envoie un mail sur l&apos;&#233;venement de la t&#226;ches.</ActualParameter>
       </ActualParameters>
      </Tool>
     </Implementation>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Automatic</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="XOR"/>
       <Split Type="AND">
        <TransitionRefs>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="Notification Admin Telephonie"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="1012"/>
      <ExtendedAttribute Name="YOffset" Value="300"/>
      <ExtendedAttribute Name="Width" Value="265"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
      <ExtendedAttribute Name="Handlers" Value="HandlerList" >
<plugin en="Detect events" fr="D&#233;tection d&apos;&#233;v&#233;nements">
  <entries>
    <activity.state.Executing>
      <action>1401955166621</action>
    </activity.state.Executing>
  </entries>
</plugin>

      </ExtendedAttribute>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1397228066077" Name="">
     <Description></Description>
     <Implementation>
      <Tool Id="MeiboView" Type="APPLICATION">
       <ActualParameters>
        <ActualParameter>People</ActualParameter>
        <ActualParameter>Formulaire_LISTE_DOTATION_GLPI</ActualParameter>
        <ActualParameter>dnPers</ActualParameter>
       </ActualParameters>
      </Tool>
     </Implementation>
     <Performer>AdminInventaire</Performer>
     <Priority>1</Priority>
     <StartMode>Manual</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="XOR"/>
       <Split Type="AND">
        <TransitionRefs>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="Liste des dotation (Check GLPI)"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="1012"/>
      <ExtendedAttribute Name="YOffset" Value="392"/>
      <ExtendedAttribute Name="Width" Value="253"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1397228128939" Name="">
     <Description></Description>
     <Implementation>
      <No/>
     </Implementation>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Automatic</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="XOR"/>
       <Split Type="AND">
        <TransitionRefs>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="Notification Admin SGeneraux"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="1612"/>
      <ExtendedAttribute Name="YOffset" Value="544"/>
      <ExtendedAttribute Name="Width" Value="241"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1397228188288" Name="">
     <Description></Description>
     <Implementation>
      <Tool Id="MeiboView" Type="APPLICATION">
       <ActualParameters>
        <ActualParameter>People</ActualParameter>
        <ActualParameter>Formulaire_SAISIE_NUMERO_BADGE</ActualParameter>
        <ActualParameter>dnPers</ActualParameter>
       </ActualParameters>
      </Tool>
     </Implementation>
     <Performer>AdminSGeneraux</Performer>
     <Priority>1</Priority>
     <StartMode>Manual</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="XOR"/>
       <Split Type="AND">
        <TransitionRefs>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="Saisie n&#176; badge"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="1616"/>
      <ExtendedAttribute Name="YOffset" Value="788"/>
      <ExtendedAttribute Name="Width" Value="225"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1397228225745" Name="">
     <Description></Description>
     <Route/>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Manual</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="XOR"/>
       <Split Type="AND">
        <TransitionRefs>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="route"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="368"/>
      <ExtendedAttribute Name="YOffset" Value="792"/>
      <ExtendedAttribute Name="Width" Value="120"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1397228269714" Name="">
     <Description></Description>
     <Implementation>
      <No/>
     </Implementation>
     <Performer>Studio</Performer>
     <Priority>1</Priority>
      <Deadline Execution="SYNCHR">
       <DeadlineCondition>VARIABLE dateAttenteArriveeJM14</DeadlineCondition>
       <ExceptionName>AttenteAriveeJM14</ExceptionName>
      </Deadline>
     <StartMode>Manual</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="XOR"/>
       <Split Type="AND">
        <TransitionRefs>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="Pause Date Arrivee J-14"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="1352"/>
      <ExtendedAttribute Name="YOffset" Value="548"/>
      <ExtendedAttribute Name="Width" Value="213"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1397228390007" Name="">
     <Description></Description>
     <Implementation>
      <Tool Id="MeiboScript" Type="SCRIPT">
       <ActualParameters>
        <ActualParameter>//Pas de script 
//Envoie un mail sur l&apos;&#233;venement de la t&#226;ches.</ActualParameter>
       </ActualParameters>
      </Tool>
     </Implementation>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Automatic</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="XOR"/>
       <Split Type="AND">
        <TransitionRefs>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="Notifications Alerte Arrivee"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="1360"/>
      <ExtendedAttribute Name="YOffset" Value="700"/>
      <ExtendedAttribute Name="Width" Value="201"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
      <ExtendedAttribute Name="Handlers" Value="HandlerList" >
<plugin en="Detect events" fr="D&#233;tection d&apos;&#233;v&#233;nements">
  <entries>
    <activity.state.Executing>
      <action>1401955422257</action>
    </activity.state.Executing>
  </entries>
</plugin>

      </ExtendedAttribute>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1397228435504" Name="">
     <Description></Description>
     <Implementation>
      <No/>
     </Implementation>
     <Performer>Studio</Performer>
     <Priority>1</Priority>
      <Deadline Execution="SYNCHR">
       <DeadlineCondition>VARIABLE dateAttenteArrivee</DeadlineCondition>
       <ExceptionName>AttenteArrivee</ExceptionName>
      </Deadline>
     <StartMode>Manual</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="XOR"/>
       <Split Type="AND">
        <TransitionRefs>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="Pause Date Arrivee"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="1092"/>
      <ExtendedAttribute Name="YOffset" Value="700"/>
      <ExtendedAttribute Name="Width" Value="189"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1397228477718" Name="">
     <Description></Description>
     <Implementation>
      <Tool Id="MeiboScript" Type="SCRIPT">
       <ActualParameters>
        <ActualParameter>//Pas de script 
//Envoie un mail sur l&apos;&#233;venement de la t&#226;ches.</ActualParameter>
       </ActualParameters>
      </Tool>
     </Implementation>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Automatic</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="XOR"/>
       <Split Type="AND">
        <TransitionRefs>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="Notifications Arrivee"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="760"/>
      <ExtendedAttribute Name="YOffset" Value="700"/>
      <ExtendedAttribute Name="Width" Value="177"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
      <ExtendedAttribute Name="Handlers" Value="HandlerList" >
<plugin en="Detect events" fr="D&#233;tection d&apos;&#233;v&#233;nements">
  <entries>
    <activity.state.Executing>
      <action>1401956012478</action>
    </activity.state.Executing>
  </entries>
</plugin>

      </ExtendedAttribute>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1397228525855" Name="">
     <Description></Description>
     <Implementation>
      <Tool Id="MeiboScript" Type="SCRIPT">
       <ActualParameters>
        <ActualParameter>//$debug
/**/
/* Script workflow - Provisioning AD (GGRs) */
/**/
/**/
/* Script modifi&#233; par akerva le 16/04
/**/ 
/////////////////////
// Debut du script //
/////////////////////  

/*R&#233;cup&#233;ration des variables workflow de la personne*/
var habilitationFonctionnelle = returnEmpty(meibo.getWorkflowVariable(&quot;habilitationFonctionnelle&quot;));
var habilitationOperationnelle = returnEmpty(meibo.getWorkflowVariable(&quot;habilitationOperationnelle&quot;));
var GGU_PersonList = returnEmpty(meibo.getWorkflowVariable(&quot;GGU_PersonList&quot;));
var grp_contrat = returnEmpty(meibo.getWorkflowVariable(&quot;grp_contrat&quot;));
var idAD = returnEmpty(meibo.getWorkflowVariable(&quot;idAD&quot;));
var civilite = returnEmpty(meibo.getWorkflowVariable(&quot;civilite&quot;));
var sn = returnEmpty(meibo.getWorkflowVariable(&quot;sn&quot;));
var givenName = returnEmpty(meibo.getWorkflowVariable(&quot;givenName&quot;));
var dateArrivee = returnEmpty(meibo.getWorkflowVariable(&quot;dateArrivee&quot;));
var pourcentagePresence = returnEmpty(meibo.getWorkflowVariable(&quot;pourcentagePresence&quot;));
var dateFinContrat = returnEmpty(meibo.getWorkflowVariable(&quot;dateFinContrat&quot;));
var manager = returnEmpty(meibo.getWorkflowVariable(&quot;manager&quot;));
var company = returnEmpty(meibo.getWorkflowVariable(&quot;company&quot;));
var dnPers = returnEmpty(meibo.getWorkflowVariable(&quot;dnPers&quot;));

////////////////////////////////////////////////////////////////////////////////////////
//                          Active Directory
////////////////////////////////////////////////////////////////////////////////////////


/*R&#233;cup&#233;ration de l&apos;ou des personne de l&apos;AD*/
var parameters = getProvisioningParameters_General();
var BCOM_AD_OU_PEOPLE = parameters.get(&quot;BCOM_AD_OU_PEOPLE&quot;); 

/*Cr&#233;ation d&apos;un resultset*/
var resultset = new ResultSet();
var entry = new Entry();

entry.baseDN=BCOM_AD_OU_PEOPLE;
entry.idAD=idAD;
entry.habilitationFonctionnelle=habilitationFonctionnelle;
entry.habilitationOperationnelle=habilitationOperationnelle;
entry.GGU_PersonList=GGU_PersonList;
entry.grp_contrat=grp_contrat;
entry.dnPers=dnPers;

resultset.addEntry(entry);

/*Provisioning AD*/

var provisioningStatus = meibo.executeProvisioning(&quot;Provisioning_AD_UPDATE_GGR_UNIX&quot;,resultset,parameters);
if ( provisioningStatus.getExitCode() != 0 ){
  var parametersMail = getProvisioningParameters_Mails();
  var parametersDroit = getProvisioningParameters_Droit();
  var messageError = provisioningStatus.getErrorMsg();//-- r&#233;cup&#233;ration du message d&apos;erreur
  var grp_adminMeibo = parametersDroit.get(&quot;BCOM_PROFIL_AdminMeibo&quot;); 
  var sendMailAdminMeibo = getAdressMailByRole(grp_adminMeibo);
  //plugin de mail d&apos;erreur
  parametersMail.add(&quot;messageError&quot;,messageError+&quot;&lt;/br&gt;&lt;/br&gt;&quot;);
  parametersMail.add(&quot;sendMailAdminMeibo&quot;,sendMailAdminMeibo);
  parametersMail.add(&quot;action&quot;,&quot;Processus d&apos;arriv&#233;e, Provisioning Groupe GGR et attribut unix&quot;);
  meibo.executePlugin(&quot;Notification_ERREUR_PROVISIONING&quot;,parametersMail);
}</ActualParameter>
       </ActualParameters>
      </Tool>
     </Implementation>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Automatic</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="XOR"/>
       <Split Type="AND">
        <TransitionRefs>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="Provisioning AD (GGRs)"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="496"/>
      <ExtendedAttribute Name="YOffset" Value="700"/>
      <ExtendedAttribute Name="Width" Value="205"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1397814240165" Name="">
     <Description></Description>
     <Route/>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Manual</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="XOR"/>
       <Split Type="AND">
        <TransitionRefs>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="route"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="532"/>
      <ExtendedAttribute Name="YOffset" Value="144"/>
      <ExtendedAttribute Name="Width" Value="120"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1397814279190" Name="">
     <Description></Description>
     <Route/>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Manual</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="XOR"/>
       <Split Type="AND">
        <TransitionRefs>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="route"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="784"/>
      <ExtendedAttribute Name="YOffset" Value="36"/>
      <ExtendedAttribute Name="Width" Value="120"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1398174486397" Name="">
     <Description></Description>
     <Implementation>
      <Tool Id="MeiboScript" Type="SCRIPT">
       <ActualParameters>
        <ActualParameter>initializeResource();</ActualParameter>
       </ActualParameters>
      </Tool>
     </Implementation>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Automatic</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="XOR"/>
       <Split Type="AND">
        <TransitionRefs>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="Initialisation des ressources"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="160"/>
      <ExtendedAttribute Name="YOffset" Value="120"/>
      <ExtendedAttribute Name="Width" Value="233"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1398861605500" Name="">
     <Description></Description>
     <Implementation>
      <Tool Id="MeiboScript" Type="SCRIPT">
       <ActualParameters>
        <ActualParameter>//Pas de script 
//Envoie un mail sur l&apos;&#233;venement de la t&#226;ches.</ActualParameter>
       </ActualParameters>
      </Tool>
     </Implementation>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Automatic</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="XOR"/>
       <Split Type="AND">
        <TransitionRefs>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="Notification Helpdesk"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="500"/>
      <ExtendedAttribute Name="YOffset" Value="544"/>
      <ExtendedAttribute Name="Width" Value="197"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
      <ExtendedAttribute Name="Handlers" Value="HandlerList" >
<plugin en="Detect events" fr="D&#233;tection d&apos;&#233;v&#233;nements">
  <entries>
    <activity.state.Executing>
      <action>1401956266341</action>
    </activity.state.Executing>
  </entries>
</plugin>

      </ExtendedAttribute>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1398861815098" Name="">
     <Description></Description>
     <Implementation>
      <Tool Id="MeiboScript" Type="SCRIPT">
       <ActualParameters>
        <ActualParameter>/**/
/* Script workflow - Pr&#233;paration mail helpdesk */
/**/
/**/
/* Script modifi&#233; par akerva le 16/04
/**/ 
/////////////////////
// Debut du script //
/////////////////////  

/*R&#233;cup&#233;ration des variables workflow de la personne*/
var BCOM_ARRIVEE_AD_MDP_USER = returnEmpty(meibo.getWorkflowVariable(&quot;BCOM_ARRIVEE_AD_MDP_USER&quot;));
var idAD = returnEmpty(meibo.getWorkflowVariable(&quot;idAD&quot;));
var dnPers = returnEmpty(meibo.getWorkflowVariable(&quot;dnPers&quot;));
var civilite = returnEmpty(meibo.getWorkflowVariable(&quot;civilite&quot;));
var sn = returnEmpty(meibo.getWorkflowVariable(&quot;sn&quot;));
var givenName = returnEmpty(meibo.getWorkflowVariable(&quot;givenName&quot;));

// fichier de propri&#233;t&#233;s des mails
var parametersMails = getProvisioningParameters_Mails();

/*variable utilis&#233; pour le nom du processus et du message d&apos;avertissement lors de la fin du formulaire*/
  /* info sur la cible */
  var titrePersCible = &quot;&quot; ;
  if ( civilite != &quot;&quot; ){
    titrePersCible = miseEnForme(civilite) + &quot; &quot; + miseEnForme(sn) + &quot; &quot; + miseEnForme(givenName);
  }
  else{
    titrePersCible = miseEnForme(sn) + &quot; &quot; + miseEnForme(givenName);
  }


/*Message 09*/
var ARR09_OBJET = parametersMails.get(&quot;ARR-09_OBJET&quot;);
ARR09_OBJET = ARR09_OBJET.replace(&quot;@@@displayName_Cible@@@&quot;,titrePersCible);
var ARR09_MESSAGE = parametersMails.get(&quot;ARR-09_MESSAGE&quot;);
ARR09_MESSAGE = ARR09_MESSAGE.replace(&quot;@@@displayName_Cible@@@&quot;,titrePersCible);
ARR09_MESSAGE = ARR09_MESSAGE.replace(&quot;@@@loginAD_Cible@@@&quot;,idAD);
ARR09_MESSAGE = ARR09_MESSAGE.replace(&quot;@@@MDP_Cible@@@&quot;,BCOM_ARRIVEE_AD_MDP_USER);

meibo.setWorkflowVariable(&quot;ARR09_OBJET&quot;,ARR09_OBJET);
meibo.setWorkflowVariable(&quot;ARR09_MESSAGE&quot;,ARR09_MESSAGE);

var sendMailHelpdesk= parametersMails.get(&quot;MAIL_HELPDESK&quot;);
meibo.setWorkflowVariable(&quot;sendMailHelpdesk&quot;,sendMailHelpdesk);</ActualParameter>
       </ActualParameters>
      </Tool>
     </Implementation>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Automatic</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="XOR"/>
       <Split Type="AND">
        <TransitionRefs>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="Preparation mail helpdesk"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="500"/>
      <ExtendedAttribute Name="YOffset" Value="612"/>
      <ExtendedAttribute Name="Width" Value="197"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1399381931683" Name="">
     <Description></Description>
     <Route/>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Manual</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="XOR"/>
       <Split Type="AND">
        <TransitionRefs>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="route"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="164"/>
      <ExtendedAttribute Name="YOffset" Value="304"/>
      <ExtendedAttribute Name="Width" Value="120"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1399382329211" Name="">
     <Description></Description>
     <Route/>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Manual</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="XOR"/>
       <Split Type="AND">
        <TransitionRefs>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="route"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="264"/>
      <ExtendedAttribute Name="YOffset" Value="204"/>
      <ExtendedAttribute Name="Width" Value="120"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1399382365699" Name="">
     <Description></Description>
     <Route/>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Manual</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="AND"/>
       <Split Type="AND">
        <TransitionRefs>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="route"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="264"/>
      <ExtendedAttribute Name="YOffset" Value="368"/>
      <ExtendedAttribute Name="Width" Value="120"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
   </Activities>
   <Transitions>
    <Transition Id="T1397227313339" Name="T1397227313339" From="A1397227289783" To="A1397226634794">
     <Condition Type="CONDITION">TestMobile==&quot;true&quot;</Condition>
    </Transition>
    <Transition Id="T1397227424129" Name="T1397227424129" From="A1397227376432" To="A1397226734467">
     <Condition Type="CONDITION">TestExterne==&quot;false&quot;</Condition>
    </Transition>
    <Transition Id="T1397227488254" Name="T1397227488254" From="A1397226341874" To="A1397226380413">
     <Condition Type="CONDITION">boiteMail==&quot;TRUE&quot;</Condition>
    </Transition>
    <Transition Id="T1397227549346" Name="T1397227549346" From="A1397227514376" To="A1397226413463">
     <Condition Type="CONDITION">TestTelephone==&quot;true&quot;</Condition>
    </Transition>
    <Transition Id="T1397227849259" Name="T1397227849259" From="A1397227514376" To="A1397227557940">
     <Condition Type="OTHERWISE"></Condition>
    </Transition>
    <Transition Id="T1397227871322" Name="T1397227871322" From="A1397226573706" To="A1397226594896"/>
    <Transition Id="T1397227892910" Name="T1397227892910" From="A1397227557940" To="A1397226328326"/>
    <Transition Id="T1397228039737" Name="T1397228039737" From="A1397227924968" To="A1397228010237"/>
    <Transition Id="T1397228115188" Name="T1397228115188" From="A1397226594896" To="A1397228066077"/>
    <Transition Id="T1397228118300" Name="T1397228118300" From="A1397228066077" To="A1397226328326"/>
    <Transition Id="T1397228161147" Name="T1397228161147" From="A1397226594896" To="A1397228128939"/>
    <Transition Id="T1397228242926" Name="T1397228242926" From="A1397228188288" To="A1397228225745"/>
    <Transition Id="T1397228246294" Name="T1397228246294" From="A1397228225745" To="A1397226328326"/>
    <Transition Id="T1397228255899" Name="T1397228255899" From="A1397228128939" To="A1397228188288"/>
    <Transition Id="T1397228371977" Name="T1397228371977" From="A1397228128939" To="A1397228269714"/>
    <Transition Id="T1397814265861" Name="T1397814265861" From="A1397226341874" To="A1397814240165">
     <Condition Type="OTHERWISE"></Condition>
    </Transition>
    <Transition Id="T1397814320188" Name="T1397814320188" From="A1397814279190" To="A1397227514376"/>
    <Transition Id="T1397814322669" Name="T1397814322669" From="A1397814279190" To="A1397226573706"/>
    <Transition Id="T1398174524817" Name="T1398174524817" From="A1397226310200" To="A1398174486397"/>
    <Transition Id="T1398174526320" Name="T1398174526320" From="A1398174486397" To="A1397226341874"/>
    <Transition Id="T1398174527976" Name="T1398174527976" From="A1398174486397" To="A1397227376432"/>
    <Transition Id="T1398174530008" Name="T1398174530008" From="A1398174486397" To="A1397227289783"/>
    <Transition Id="T1398861641095" Name="T1398861641095" From="A1398861605500" To="A1397226328326"/>
    <Transition Id="T1398861851876" Name="T1398861851876" From="A1397228525855" To="A1398861815098"/>
    <Transition Id="T1398861853244" Name="T1398861853244" From="A1398861815098" To="A1398861605500"/>
    <Transition Id="T1399381950981" Name="T1399381950981" From="A1397227289783" To="A1399381931683">
     <Condition Type="OTHERWISE"></Condition>
    </Transition>
    <Transition Id="T1399381993482" Name="T1399381993482" From="A1397226634794" To="A1399381931683"/>
    <Transition Id="T1399382043371" Name="T1399382043371" From="A1397226413463" To="A1397227571065"/>
    <Transition Id="T1399382056319" Name="T1399382056319" From="A1397227571065" To="A1397227924968"/>
    <Transition Id="T1399382058472" Name="T1399382058472" From="A1397228010237" To="A1397227557940"/>
    <Transition Id="T1399382184005" Name="T1399382184005" From="A1397228477718" To="A1397228525855"/>
    <Transition Id="T1399382192383" Name="T1399382192383" From="A1397228435504" To="A1397228477718">
     <Condition Type="EXCEPTION">AttenteArrivee</Condition>
    </Transition>
    <Transition Id="T1399382204551" Name="T1399382204551" From="A1397228390007" To="A1397228435504"/>
    <Transition Id="T1399382345341" Name="T1399382345341" From="A1397227376432" To="A1399382329211">
     <Condition Type="OTHERWISE"></Condition>
    </Transition>
    <Transition Id="T1399382357197" Name="T1399382357197" From="A1397226734467" To="A1399382329211"/>
    <Transition Id="T1399382378117" Name="T1399382378117" From="A1399381931683" To="A1399382365699"/>
    <Transition Id="T1399382380301" Name="T1399382380301" From="A1399382329211" To="A1399382365699"/>
    <Transition Id="T1399382382547" Name="T1399382382547" From="A1399382365699" To="A1397226328326"/>
    <Transition Id="T1399994739441" Name="T1399994739441" From="A1397814240165" To="A1397814279190"/>
    <Transition Id="T1399994741656" Name="T1399994741656" From="A1397226380413" To="A1397814279190"/>
    <Transition Id="T1402585814332" Name="T1402585814332" From="A1397228269714" To="A1397228390007">
     <Condition Type="EXCEPTION">AttenteAriveeJM14</Condition>
    </Transition>
   </Transitions>
  </WorkflowProcess>
  <WorkflowProcess AccessLevel="PUBLIC" Id="1397224855079" Name="Processus_ARRIVEE_PERSONNE">
   <ProcessHeader DurationUnit="D">
    <Description>Processus Meibo</Description>
   </ProcessHeader>
   <RedefinableHeader PublicationStatus="RELEASED">
    <Author>Meibo</Author>
    <Version>3</Version>
   </RedefinableHeader>
   <ExtendedAttributes>
    <ExtendedAttribute Name="scale"  Value="100%"/>
    <ExtendedAttribute Name="role"  Value="AdminInventaire"/>
    <ExtendedAttribute Name="role"  Value="AdminMeibo"/>
    <ExtendedAttribute Name="role"  Value="AdminSGeneraux"/>
    <ExtendedAttribute Name="role"  Value="AdminTelephonie"/>
    <ExtendedAttribute Name="role"  Value="RH"/>
    <ExtendedAttribute Name="role"  Value="Studio"/>
    <ExtendedAttribute Name="fr_name"  Value="Processus_ARRIVEE_PERSONNE"/>
    <ExtendedAttribute Name="fr_description"  Value=""/>
    <ExtendedAttribute Name="actionsList" Value="">
      <Action Name="Notification_InExtenso" Type="pluginMail-1" ID="1401954256837">
<plugin en="Plugin to send e-mails (v1.2)" fr="Plugin d&apos;envoi d&apos;e-mails (v1.2)" name="pluginMail-1">
  <subject>{process.ARR02_OBJET}</subject>
  <html>true</html>
  <body>{process.MAILS_ENTETE}&#10;{process.ARR02_MESSAGE}&#10;{process.MAILS_SIGNATURE}</body>
  <files>&#10;  </files>
  <to>
    <mail>
      <mail>{process.MAIL_inExtenso}</mail>
    </mail>
  </to>
  <cc>&#10;  </cc>
  <bcc>&#10;  </bcc>
  <from>{process.MAIL_MEIBO}</from>
  <debug>true</debug>
  <SMTPAuth>true</SMTPAuth>
</plugin>

      </Action>
      <Action Name="Notification_Mobile" Type="pluginMail-1" ID="1401954653738">
<plugin en="Plugin to send e-mails (v1.2)" fr="Plugin d&apos;envoi d&apos;e-mails (v1.2)" name="pluginMail-1">
  <subject>{process.ARR01_OBJET}</subject>
  <html>true</html>
  <body>{process.MAILS_ENTETE}&#10;{process.ARR01_MESSAGE}&#10;{process.MAILS_SIGNATURE}</body>
  <files>&#10;  </files>
  <to>
    <mail>
      <mail>{process.sendMailAdminTelephonie}</mail>
    </mail>
  </to>
  <cc>&#10;  </cc>
  <bcc>&#10;  </bcc>
  <from>{process.MAIL_MEIBO}</from>
  <debug>false</debug>
  <SMTPAuth>true</SMTPAuth>
</plugin>

      </Action>
      <Action Name="Notification_Xivo" Type="pluginMail-1" ID="1401955166621">
<plugin en="Plugin to send e-mails (v1.2)" fr="Plugin d&apos;envoi d&apos;e-mails (v1.2)" name="pluginMail-1">
  <subject>{process.ARR04_OBJET}</subject>
  <html>true</html>
  <body>{process.MAILS_ENTETE}&#10;{process.ARR04_MESSAGE}&#10;{process.MAILS_SIGNATURE}</body>
  <files>&#10;  </files>
  <to>
    <mail>
      <mail>{process.sendMailAdminTelephonie}</mail>
    </mail>
  </to>
  <cc>&#10;  </cc>
  <bcc>&#10;  </bcc>
  <from>{process.MAIL_MEIBO}</from>
  <debug>false</debug>
  <SMTPAuth>true</SMTPAuth>
</plugin>

      </Action>
      <Action Name="Notification_AlerteArrivee" Type="pluginMail-1" ID="1401955422257">
<plugin en="Plugin to send e-mails (v1.2)" fr="Plugin d&apos;envoi d&apos;e-mails (v1.2)" name="pluginMail-1">
  <subject>{process.ARR07_OBJET}</subject>
  <html>true</html>
  <body>{process.MAILS_ENTETE}&#10;{process.ARR07_MESSAGE}&#10;{process.MAILS_SIGNATURE}</body>
  <files>&#10;  </files>
  <to>
    <mail>
      <mail>{process.sendMailAlerteArrivee}</mail>
    </mail>
  </to>
  <cc>&#10;  </cc>
  <bcc>&#10;  </bcc>
  <from>{process.MAIL_MEIBO}</from>
  <debug>false</debug>
  <SMTPAuth>true</SMTPAuth>
</plugin>

      </Action>
      <Action Name="Notification_Arrivee" Type="pluginMail-1" ID="1401956012478">
<plugin en="Plugin to send e-mails (v1.2)" fr="Plugin d&apos;envoi d&apos;e-mails (v1.2)" name="pluginMail-1">
  <subject>{process.ARR08_OBJET}</subject>
  <html>true</html>
  <body>{process.MAILS_ENTETE}&#10;{process.ARR08_MESSAGE}&#10;{process.MAILS_SIGNATURE}</body>
  <files>&#10;  </files>
  <to>
    <mail>
      <mail>{process.sendMailArrivee}</mail>
    </mail>
  </to>
  <cc>&#10;  </cc>
  <bcc>&#10;  </bcc>
  <from>{process.MAIL_MEIBO}</from>
  <debug>false</debug>
  <SMTPAuth>true</SMTPAuth>
</plugin>

      </Action>
      <Action Name="Notification_Helpdesk" Type="pluginMail-1" ID="1401956266341">
<plugin en="Plugin to send e-mails (v1.2)" fr="Plugin d&apos;envoi d&apos;e-mails (v1.2)" name="pluginMail-1">
  <subject>{process.ARR09_OBJET}</subject>
  <html>true</html>
  <body>{process.MAILS_ENTETE}&#10;{process.ARR09_MESSAGE}&#10;{process.MAILS_SIGNATURE}</body>
  <files>&#10;  </files>
  <to>
    <mail>
      <mail>{process.sendMailHelpdesk}</mail>
    </mail>
  </to>
  <cc>&#10;  </cc>
  <bcc>&#10;  </bcc>
  <from>{process.MAIL_MEIBO}</from>
  <debug>false</debug>
  <SMTPAuth>true</SMTPAuth>
</plugin>

      </Action>
    </ExtendedAttribute>
   </ExtendedAttributes>
   <DataFields>
   </DataFields>
   <FormalParameters>
    <FormalParameter Id="TestMobile" Index="0" Mode="INOUT">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="TestExterne" Index="1" Mode="INOUT">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="TestTelephone" Index="2" Mode="INOUT">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="civilite" Index="3" Mode="INOUT">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="sn" Index="4" Mode="INOUT">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="givenName" Index="5" Mode="INOUT">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="dateArrivee" Index="6" Mode="INOUT">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="grp_contrat" Index="7" Mode="INOUT">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="pourcentagePresence" Index="8" Mode="INOUT">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="dateFinContrat" Index="9" Mode="INOUT">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="manager" Index="10" Mode="INOUT">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="company" Index="11" Mode="INOUT">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="dotation" Index="12" Mode="INOUT">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="habilitationFonctionnelle" Index="13" Mode="INOUT">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="habilitationOperationnelle" Index="14" Mode="INOUT">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="dateAttenteArriveeJM14" Index="15" Mode="INOUT">
     <DataType>
      <BasicType Type="DEADLINE"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="dateAttenteArrivee" Index="16" Mode="INOUT">
     <DataType>
      <BasicType Type="DEADLINE"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="MAIL_MEIBO" Index="17" Mode="INOUT">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="MAILS_ENTETE" Index="18" Mode="INOUT">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="MAILS_SIGNATURE" Index="19" Mode="INOUT">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="MAIL_inExtenso" Index="20" Mode="INOUT">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="MAIL_ACCUEIL" Index="21" Mode="INOUT">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="ARR01_OBJET" Index="22" Mode="INOUT">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="ARR01_MESSAGE" Index="23" Mode="INOUT">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="ARR02_OBJET" Index="24" Mode="INOUT">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="ARR02_MESSAGE" Index="25" Mode="INOUT">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="ARR03_OBJET" Index="26" Mode="INOUT">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="ARR03_MESSAGE" Index="27" Mode="INOUT">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="ARR04_OBJET" Index="28" Mode="INOUT">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="ARR04_MESSAGE" Index="29" Mode="INOUT">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="ARR05_OBJET" Index="30" Mode="INOUT">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="ARR05_MESSAGE" Index="31" Mode="INOUT">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="ARR06_OBJET" Index="32" Mode="INOUT">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="ARR06_MESSAGE" Index="33" Mode="INOUT">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="ARR07_OBJET" Index="34" Mode="INOUT">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="ARR07_MESSAGE" Index="35" Mode="INOUT">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="ARR08_OBJET" Index="36" Mode="INOUT">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="ARR08_MESSAGE" Index="37" Mode="INOUT">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="BCOM_LIEN_MEIBO" Index="38" Mode="INOUT">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="sendMailAdminTelephonie" Index="39" Mode="INOUT">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="sendMailAdminInventaire" Index="40" Mode="INOUT">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="sendMailAdminSGeneraux" Index="41" Mode="INOUT">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="sendMailRH" Index="42" Mode="INOUT">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="sendMailManager" Index="43" Mode="INOUT">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="dnPers" Index="44" Mode="INOUT">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="telephoneMobile" Index="45" Mode="INOUT">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="telephoneFixe" Index="46" Mode="INOUT">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="badgeID" Index="47" Mode="INOUT">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="idAD" Index="48" Mode="INOUT">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="boiteMail" Index="49" Mode="INOUT">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="lieu" Index="50" Mode="INOUT">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="BCOM_ARRIVEE_AD_MDP_USER" Index="51" Mode="INOUT">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="sendMailHelpdesk" Index="52" Mode="INOUT">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="ARR09_MESSAGE" Index="53" Mode="INOUT">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="ARR09_OBJET" Index="54" Mode="INOUT">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="retourXivo" Index="55" Mode="INOUT">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="sendMailAlerteArrivee" Index="56" Mode="INOUT">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="sendMailArrivee" Index="57" Mode="INOUT">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="GGU_PersonList" Index="58" Mode="INOUT">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </FormalParameter>
   </FormalParameters>
   <Participants>
    <Participant Id="AdminInventaire" Name="AdminInventaire">
     <ParticipantType Type="ROLE"/>
    </Participant>
    <Participant Id="AdminMeibo" Name="AdminMeibo">
     <ParticipantType Type="ROLE"/>
    </Participant>
    <Participant Id="AdminSGeneraux" Name="AdminSGeneraux">
     <ParticipantType Type="ROLE"/>
    </Participant>
    <Participant Id="AdminTelephonie" Name="AdminTelephonie">
     <ParticipantType Type="ROLE"/>
    </Participant>
    <Participant Id="RH" Name="RH">
     <ParticipantType Type="ROLE"/>
    </Participant>
    <Participant Id="Studio" Name="Studio">
     <ParticipantType Type="ROLE"/>
    </Participant>
    <Participant Id="Utilisateur" Name="Utilisateur">
     <ParticipantType Type="ROLE"/>
    </Participant>
   </Participants>
   <Activities>
    <Activity Id="A1397226310200" Name="">
     <Description></Description>
     <Route/>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Manual</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="XOR"/>
       <Split Type="AND">
        <TransitionRefs>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="Debut"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="0"/>
      <ExtendedAttribute Name="YOffset" Value="120"/>
      <ExtendedAttribute Name="Width" Value="120"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1397226328326" Name="">
     <Description></Description>
     <Route/>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Manual</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="AND"/>
       <Split Type="AND">
        <TransitionRefs>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="Fin"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="368"/>
      <ExtendedAttribute Name="YOffset" Value="432"/>
      <ExtendedAttribute Name="Width" Value="120"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1397226341874" Name="">
     <Description></Description>
     <Implementation>
      <Tool Id="MeiboScript" Type="SCRIPT">
       <ActualParameters>
        <ActualParameter>/**/
/* Script workflow - Provisioning AD */
/**/
/**/
/* Script modifi&#233; par akerva le 16/04
/**/ 
/////////////////////
// Debut du script //
/////////////////////  

/*R&#233;cup&#233;ration des variables workflow de la personne*/
var civilite = returnEmpty(meibo.getWorkflowVariable(&quot;civilite&quot;));
var sn = returnEmpty(meibo.getWorkflowVariable(&quot;sn&quot;));
var givenName = returnEmpty(meibo.getWorkflowVariable(&quot;givenName&quot;));
var dateArrivee = returnEmpty(meibo.getWorkflowVariable(&quot;dateArrivee&quot;));
var pourcentagePresence = returnEmpty(meibo.getWorkflowVariable(&quot;pourcentagePresence&quot;));
var dateFinContrat = returnEmpty(meibo.getWorkflowVariable(&quot;dateFinContrat&quot;));
var manager = returnEmpty(meibo.getWorkflowVariable(&quot;manager&quot;));
var company = returnEmpty(meibo.getWorkflowVariable(&quot;company&quot;));
var natureContrat = returnEmpty(meibo.getWorkflowVariable(&quot;grp_contrat&quot;));
var lieu = returnEmpty(meibo.getWorkflowVariable(&quot;lieu&quot;));
/*R&#233;cup&#233;ration de l&apos;ou des personne de l&apos;AD*/
var parameters = getProvisioningParameters_General();
var BCOM_AD_OU_PEOPLE = parameters.get(&quot;BCOM_AD_OU_PEOPLE&quot;); 

/*Cr&#233;ation d&apos;un resultset*/
var resultset = new ResultSet();
var entry = new Entry();
entry.civilite=civilite;
entry.sn=sn;
entry.givenName=givenName;
entry.dateArrivee=dateArrivee;
entry.pourcentagePresence=pourcentagePresence;
entry.dateFinContrat=dateFinContrat;
entry.manager=manager;
entry.company=company;
entry.baseDN=BCOM_AD_OU_PEOPLE;
entry.natureContrat=natureContrat;
entry.lieu=lieu;

resultset.addEntry(entry);

/*Provisioning AD*/
meibo.setGlobalVar(&quot;BCOM_ARRIVEE_AD_DN&quot;,&quot;&quot;);
meibo.setGlobalVar(&quot;BCOM_ARRIVEE_AD_IDAD&quot;,&quot;&quot;);
meibo.setGlobalVar(&quot;BCOM_ARRIVEE_AD_MDP_USER&quot;,&quot;&quot;);
var provisioningStatus = meibo.executeProvisioning(&quot;Provisioning_AD_CREATE_USER&quot;,resultset,parameters);
if ( provisioningStatus.getExitCode() != 0 ){
  var parametersMail = getProvisioningParameters_Mails();
  var parametersDroit = getProvisioningParameters_Droit();
  var messageError = provisioningStatus.getErrorMsg();//-- r&#233;cup&#233;ration du message d&apos;erreur
  var grp_adminMeibo = parametersDroit.get(&quot;BCOM_PROFIL_AdminMeibo&quot;); 
  var sendMailAdminMeibo = getAdressMailByRole(grp_adminMeibo);
  //plugin de mail d&apos;erreur
  parametersMail.add(&quot;messageError&quot;,messageError+&quot;&lt;/br&gt;&lt;/br&gt;&quot;);
  parametersMail.add(&quot;sendMailAdminMeibo&quot;,sendMailAdminMeibo);
  parametersMail.add(&quot;action&quot;,&quot;Processus d&apos;arriv&#233;e, Provisioning utilisateur dans Active Directory&quot;);
  meibo.executePlugin(&quot;Notification_ERREUR_PROVISIONING&quot;,parametersMail);
}
else{
  var dnPers = returnEmpty(meibo.getGlobalVar(&quot;BCOM_ARRIVEE_AD_DN&quot;));
  var idAD = returnEmpty(meibo.getGlobalVar(&quot;BCOM_ARRIVEE_AD_IDAD&quot;));
  var BCOM_ARRIVEE_AD_MDP_USER = returnEmpty(meibo.getGlobalVar(&quot;BCOM_ARRIVEE_AD_MDP_USER&quot;));
  meibo.setWorkflowVariable(&quot;idAD&quot;,idAD);
  meibo.setWorkflowVariable(&quot;dnPers&quot;,dnPers);
  meibo.setWorkflowVariable(&quot;BCOM_ARRIVEE_AD_MDP_USER&quot;,BCOM_ARRIVEE_AD_MDP_USER);
}

/////////////////////
// Fin du script //
/////////////////////</ActualParameter>
       </ActualParameters>
      </Tool>
     </Implementation>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Automatic</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="XOR"/>
       <Split Type="XOR">
        <TransitionRefs>
         <TransitionRef Id="T1397227488254"/>
         <TransitionRef Id="T1397814265861"/>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="Provisioning AD"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="196"/>
      <ExtendedAttribute Name="YOffset" Value="32"/>
      <ExtendedAttribute Name="Width" Value="164"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1397226380413" Name="">
     <Description></Description>
     <Implementation>
      <Tool Id="MeiboScript" Type="SCRIPT">
       <ActualParameters>
        <ActualParameter>/**/
/* Script workflow - Provisioning Exchange */
/**/
/**/
/* Script modifi&#233; par akerva le 16/04
/**/ 
/////////////////////
// Debut du script //
/////////////////////  

/*R&#233;cup&#233;ration des variables workflow de la personne*/
var idAD = returnEmpty(meibo.getWorkflowVariable(&quot;idAD&quot;));
var sn = returnEmpty(meibo.getWorkflowVariable(&quot;sn&quot;));
var givenName = returnEmpty(meibo.getWorkflowVariable(&quot;givenName&quot;));
/*R&#233;cup&#233;ration de l&apos;ou des personne de l&apos;AD*/
var parameters = getProvisioningParameters_General();


/*Cr&#233;ation d&apos;un resultset*/
var resultset = new ResultSet();
var entry = new Entry();
entry.cn=idAD;
entry.sn=sn;
entry.givenName=givenName;
resultset.addEntry(entry);

/*Provisioning AD*/

var provisioningStatus = meibo.executeProvisioning(&quot;Provisioning_EXCHANGE_CREATE_USER&quot;,resultset,parameters);
if ( provisioningStatus.getExitCode() != 0 ){
  var parametersMail = getProvisioningParameters_Mails();
  var parametersDroit = getProvisioningParameters_Droit();
  var messageError = provisioningStatus.getErrorMsg();//-- r&#233;cup&#233;ration du message d&apos;erreur
  var grp_adminMeibo = parametersDroit.get(&quot;BCOM_PROFIL_AdminMeibo&quot;); 
  var sendMailAdminMeibo = getAdressMailByRole(grp_adminMeibo);
  //plugin de mail d&apos;erreur
  parametersMail.add(&quot;messageError&quot;,messageError+&quot;&lt;/br&gt;&lt;/br&gt;&quot;);
  parametersMail.add(&quot;sendMailAdminMeibo&quot;,sendMailAdminMeibo);
   parametersMail.add(&quot;action&quot;,&quot;Processus d&apos;arriv&#233;e, Provisioning utilisateur dans Exchange&quot;);
  meibo.executePlugin(&quot;Notification_ERREUR_PROVISIONING&quot;,parametersMail);
}

/////////////////////
// Fin du script //
/////////////////////</ActualParameter>
       </ActualParameters>
      </Tool>
     </Implementation>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Automatic</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="XOR"/>
       <Split Type="AND">
        <TransitionRefs>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="Provisioning Exchange"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="528"/>
      <ExtendedAttribute Name="YOffset" Value="32"/>
      <ExtendedAttribute Name="Width" Value="181"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1397226413463" Name="">
     <Description></Description>
     <Implementation>
      <No/>
     </Implementation>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Automatic</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="XOR"/>
       <Split Type="AND">
        <TransitionRefs>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="Notification Admin Telephonie"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="1372"/>
      <ExtendedAttribute Name="YOffset" Value="136"/>
      <ExtendedAttribute Name="Width" Value="265"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1397226573706" Name="">
     <Description></Description>
     <Route/>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Manual</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="XOR"/>
       <Split Type="AND">
        <TransitionRefs>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="route"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="1668"/>
      <ExtendedAttribute Name="YOffset" Value="32"/>
      <ExtendedAttribute Name="Width" Value="120"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1397226594896" Name="">
     <Description></Description>
     <Implementation>
      <No/>
     </Implementation>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Automatic</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="XOR"/>
       <Split Type="AND">
        <TransitionRefs>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="Notification Admin Inventaire"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="1612"/>
      <ExtendedAttribute Name="YOffset" Value="396"/>
      <ExtendedAttribute Name="Width" Value="237"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1397226634794" Name="">
     <Description></Description>
     <Implementation>
      <Tool Id="MeiboScript" Type="SCRIPT">
       <ActualParameters>
        <ActualParameter>//Pas de script 
//Envoie un mail sur l&apos;&#233;venement de la t&#226;ches.</ActualParameter>
       </ActualParameters>
      </Tool>
     </Implementation>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Automatic</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="AND"/>
       <Split Type="AND">
        <TransitionRefs>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value=" Notification Admin Telephonie"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="8"/>
      <ExtendedAttribute Name="YOffset" Value="416"/>
      <ExtendedAttribute Name="Width" Value="221"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
      <ExtendedAttribute Name="Handlers" Value="HandlerList" >
<plugin en="Detect events" fr="D&#233;tection d&apos;&#233;v&#233;nements">
  <entries>
    <activity.state.Executing>
      <action>1401954653738</action>
    </activity.state.Executing>
  </entries>
</plugin>

      </ExtendedAttribute>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1397226734467" Name="">
     <Description></Description>
     <Implementation>
      <Tool Id="MeiboScript" Type="SCRIPT">
       <ActualParameters>
        <ActualParameter>//Pas de script 
//Envoie un mail sur l&apos;&#233;venement de la t&#226;ches.</ActualParameter>
       </ActualParameters>
      </Tool>
     </Implementation>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Automatic</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="AND"/>
       <Split Type="AND">
        <TransitionRefs>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="Notification InExtenso"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="412"/>
      <ExtendedAttribute Name="YOffset" Value="316"/>
      <ExtendedAttribute Name="Width" Value="217"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
      <ExtendedAttribute Name="Handlers" Value="HandlerList" >
<plugin en="Detect events" fr="D&#233;tection d&apos;&#233;v&#233;nements">
  <entries>
    <activity.state.Executing>
      <action>1401954256837</action>
    </activity.state.Executing>
  </entries>
</plugin>

      </ExtendedAttribute>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1397227289783" Name="">
     <Description></Description>
     <Route/>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Manual</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="XOR"/>
       <Split Type="XOR">
        <TransitionRefs>
         <TransitionRef Id="T1397227313339"/>
         <TransitionRef Id="T1399381950981"/>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="Mobile ?"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="56"/>
      <ExtendedAttribute Name="YOffset" Value="204"/>
      <ExtendedAttribute Name="Width" Value="120"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1397227376432" Name="">
     <Description></Description>
     <Route/>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Manual</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="XOR"/>
       <Split Type="XOR">
        <TransitionRefs>
         <TransitionRef Id="T1397227424129"/>
         <TransitionRef Id="T1399382345341"/>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="Non Externe ?"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="440"/>
      <ExtendedAttribute Name="YOffset" Value="204"/>
      <ExtendedAttribute Name="Width" Value="161"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
      <ExtendedAttribute Name="Handlers" Value="HandlerList" >
<plugin en="Detect events" fr="D&#233;tection d&apos;&#233;v&#233;nements">
  <entries>
    <script.event.>
      <name>test</name>
      <action>1401954256837</action>
    </script.event.>
  </entries>
</plugin>

      </ExtendedAttribute>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1397227514376" Name="">
     <Description></Description>
     <Route/>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Manual</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="XOR"/>
       <Split Type="XOR">
        <TransitionRefs>
         <TransitionRef Id="T1397227549346"/>
         <TransitionRef Id="T1397227849259"/>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="Telephone ?"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="772"/>
      <ExtendedAttribute Name="YOffset" Value="136"/>
      <ExtendedAttribute Name="Width" Value="148"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1397227557940" Name="">
     <Description></Description>
     <Route/>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Manual</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="XOR"/>
       <Split Type="AND">
        <TransitionRefs>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="route"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="784"/>
      <ExtendedAttribute Name="YOffset" Value="300"/>
      <ExtendedAttribute Name="Width" Value="120"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1397227571065" Name="">
     <Description></Description>
     <Implementation>
      <Tool Id="MeiboView" Type="APPLICATION">
       <ActualParameters>
        <ActualParameter>People</ActualParameter>
        <ActualParameter>Formulaire_SAISIE_NUMERO_ADX</ActualParameter>
        <ActualParameter>dnPers</ActualParameter>
       </ActualParameters>
      </Tool>
     </Implementation>
     <Performer>AdminTelephonie</Performer>
     <Priority>1</Priority>
     <StartMode>Manual</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="XOR"/>
       <Split Type="AND">
        <TransitionRefs>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="Saisie n&#176; ADX"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="1372"/>
      <ExtendedAttribute Name="YOffset" Value="212"/>
      <ExtendedAttribute Name="Width" Value="265"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1397227924968" Name="">
     <Description></Description>
     <Implementation>
      <Tool Id="MeiboScript" Type="SCRIPT">
       <ActualParameters>
        <ActualParameter>/**/
/* Script workflow - Provisioning AD + xivo */
/**/
/**/
/* Script modifi&#233; par akerva le 16/04
/**/ 
/////////////////////
// Debut du script //
/////////////////////  
var parametersMails = getProvisioningParameters_Mails();
/*R&#233;cup&#233;ration des variables workflow de la personne*/
var telephoneFixe = returnEmpty(meibo.getWorkflowVariable(&quot;telephoneFixe&quot;));
var telephoneMobile = returnEmpty(meibo.getWorkflowVariable(&quot;telephoneMobile&quot;));
var dnPers = returnEmpty(meibo.getWorkflowVariable(&quot;dnPers&quot;));

////////////////////////////////////////////////////////////////////////////////////////
//                          Active Directory
////////////////////////////////////////////////////////////////////////////////////////


/*R&#233;cup&#233;ration de l&apos;ou des personne de l&apos;AD*/
var parameters = getProvisioningParameters_General();
var BCOM_AD_OU_PEOPLE = parameters.get(&quot;BCOM_AD_OU_PEOPLE&quot;); 

/*Cr&#233;ation d&apos;un resultset*/
var resultset = new ResultSet();
var entry = new Entry();
entry.telephoneFixe=telephoneFixe;
entry.telephoneMobile=telephoneMobile;
entry.dnPers=dnPers;


resultset.addEntry(entry);

/*Provisioning AD*/

var provisioningStatus = meibo.executeProvisioning(&quot;Provisioning_AD_UPDATE_PHONE&quot;,resultset,parameters);
if ( provisioningStatus.getExitCode() != 0 ){
  
  var parametersDroit = getProvisioningParameters_Droit();
  var messageError = provisioningStatus.getErrorMsg();//-- r&#233;cup&#233;ration du message d&apos;erreur
  var grp_adminMeibo = parametersDroit.get(&quot;BCOM_PROFIL_AdminMeibo&quot;); 
  var sendMailAdminMeibo = getAdressMailByRole(grp_adminMeibo);
  //plugin de mail d&apos;erreur
  parametersMails.add(&quot;messageError&quot;,messageError+&quot;&lt;/br&gt;&lt;/br&gt;&quot;);
  parametersMails.add(&quot;sendMailAdminMeibo&quot;,sendMailAdminMeibo);
  parametersMails.add(&quot;action&quot;,&quot;Processus d&apos;arriv&#233;e, Provisioning t&#233;l&#233;phone dans Active Directory&quot;);
  meibo.executePlugin(&quot;Notification_ERREUR_PROVISIONING&quot;,parametersMails);
}

////////////////////////////////////////////////////////////////////////////////////////
//                                      XIVO
////////////////////////////////////////////////////////////////////////////////////////
/*R&#233;cup&#233;ration param&#232;tres XIVO*/
var BCOM_XIVO_USER_APIREST = parameters.get(&quot;BCOM_XIVO_USER_APIREST&quot;); 
var BCOM_XIVO_USER_MDP_APIREST = parameters.get(&quot;BCOM_XIVO_USER_MDP_APIREST&quot;); 
var BCOM_XIVO_IP_APIREST = parameters.get(&quot;BCOM_XIVO_IP_APIREST&quot;); 
var BCOM_XIVO_PORT_APIREST = parameters.get(&quot;BCOM_XIVO_PORT_APIREST&quot;); 
var BCOM_XIVO_PROFIL_USER_APIREST = parameters.get(&quot;BCOM_XIVO_PROFIL_USER_APIREST&quot;);

//r&#233;cup&#232;ration param&#232;tre utilisateur
var sn = returnEmpty(meibo.getWorkflowVariable(&quot;sn&quot;));
var givenName = returnEmpty(meibo.getWorkflowVariable(&quot;givenName&quot;));
var idAD = returnEmpty(meibo.getWorkflowVariable(&quot;idAD&quot;));
var BCOM_ARRIVEE_AD_MDP_USER = returnEmpty(meibo.getWorkflowVariable(&quot;BCOM_ARRIVEE_AD_MDP_USER&quot;));

//mise en forme des num&#233;ro de t&#233;l&#233;phone

var ipPhone = telephoneFixe.substring(12);
ipPhone = ipPhone.replace(&quot; &quot;,&quot;&quot;);

telephoneFixe = telephoneFixe.replace(&quot;+33 &quot;,&quot;0&quot;);
telephoneFixe = telephoneFixe.replace(&quot; &quot;,&quot;&quot;);

if ( telephoneMobile != &quot;&quot; ){
  telephoneMobile = telephoneMobile.replace(&quot;+33 &quot;,&quot;0&quot;);
  telephoneMobile = telephoneMobile.replace(&quot; &quot;,&quot;&quot;);
}
else{
  telephoneMobile = null;
}


//r&#233;cup&#233;ration du mail dans AD

var entry = meibo.getDnEntry(&quot;People&quot;,dnPers,&quot;mail&quot;);
var mail = returnEmpty(entry.mail[0]);
if ( mail == &quot;&quot; ){
  mail = null;
}

var x = new xivo.arrivedUser();
var retour = x.generalAction(BCOM_XIVO_USER_APIREST,BCOM_XIVO_USER_MDP_APIREST,BCOM_XIVO_IP_APIREST,parseInt(BCOM_XIVO_PORT_APIREST),miseEnForme(givenName),sn.toUpperCase(),BCOM_ARRIVEE_AD_MDP_USER,telephoneFixe,telephoneMobile,ipPhone,mail,idAD,BCOM_XIVO_PROFIL_USER_APIREST);

meibo.setWorkflowVariable(&quot;retourXivo&quot;,retour);
 
////////////////////////////////////////////////////////////////////////////////////////
//                       Preparation Notification message 4
////////////////////////////////////////////////////////////////////////////////////////
 
/*variable utilis&#233; pour le nom du processus et du message d&apos;avertissement lors de la fin du formulaire*/
/* info sur la cible */
var civilite = returnEmpty(meibo.getWorkflowVariable(&quot;civilite&quot;));
var titrePersCible = &quot;&quot; ;
if ( civilite != &quot;&quot; ){
  titrePersCible = miseEnForme(civilite) + &quot; &quot; + miseEnForme(sn) + &quot; &quot; + miseEnForme(givenName);
}
else{
  titrePersCible = miseEnForme(sn) + &quot; &quot; + miseEnForme(givenName);
} 
var ARR04_OBJET = parametersMails.get(&quot;ARR-04_OBJET&quot;);
ARR04_OBJET = ARR04_OBJET.replace(&quot;@@@displayName_Cible@@@&quot;,titrePersCible);
var ARR04_MESSAGE = parametersMails.get(&quot;ARR-04_MESSAGE&quot;);
ARR04_MESSAGE = ARR04_MESSAGE.replace(&quot;@@@displayName_Cible@@@&quot;,titrePersCible); 
if ( retour != &quot;false&quot; ){
  ARR04_MESSAGE = ARR04_MESSAGE.replace(&quot;@@@numeroXivo_Cible@@@&quot;,retour);  
}
else{
  ARR04_MESSAGE = ARR04_MESSAGE.replace(&quot;@@@numeroXivo_Cible@@@&quot;,&quot;&quot;); 
} 

meibo.setWorkflowVariable(&quot;ARR04_OBJET&quot;,ARR04_OBJET);
meibo.setWorkflowVariable(&quot;ARR04_MESSAGE&quot;,ARR04_MESSAGE);
/////////////////////
// Fin du script //
/////////////////////</ActualParameter>
       </ActualParameters>
      </Tool>
     </Implementation>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Automatic</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="XOR"/>
       <Split Type="AND">
        <TransitionRefs>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="Provisioning XIVO + Mise a jour AD"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="1376"/>
      <ExtendedAttribute Name="YOffset" Value="296"/>
      <ExtendedAttribute Name="Width" Value="261"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1397228010237" Name="">
     <Description></Description>
     <Implementation>
      <Tool Id="MeiboScript" Type="SCRIPT">
       <ActualParameters>
        <ActualParameter>//Pas de script 
//Envoie un mail sur l&apos;&#233;venement de la t&#226;ches.</ActualParameter>
       </ActualParameters>
      </Tool>
     </Implementation>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Automatic</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="XOR"/>
       <Split Type="AND">
        <TransitionRefs>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="Notification Admin Telephonie"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="1012"/>
      <ExtendedAttribute Name="YOffset" Value="300"/>
      <ExtendedAttribute Name="Width" Value="265"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
      <ExtendedAttribute Name="Handlers" Value="HandlerList" >
<plugin en="Detect events" fr="D&#233;tection d&apos;&#233;v&#233;nements">
  <entries>
    <activity.state.Executing>
      <action>1401955166621</action>
    </activity.state.Executing>
  </entries>
</plugin>

      </ExtendedAttribute>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1397228066077" Name="">
     <Description></Description>
     <Implementation>
      <Tool Id="MeiboView" Type="APPLICATION">
       <ActualParameters>
        <ActualParameter>People</ActualParameter>
        <ActualParameter>Formulaire_LISTE_DOTATION_GLPI</ActualParameter>
        <ActualParameter>dnPers</ActualParameter>
       </ActualParameters>
      </Tool>
     </Implementation>
     <Performer>AdminInventaire</Performer>
     <Priority>1</Priority>
     <StartMode>Manual</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="XOR"/>
       <Split Type="AND">
        <TransitionRefs>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="Liste des dotation (Check GLPI)"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="1012"/>
      <ExtendedAttribute Name="YOffset" Value="392"/>
      <ExtendedAttribute Name="Width" Value="253"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1397228128939" Name="">
     <Description></Description>
     <Implementation>
      <No/>
     </Implementation>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Automatic</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="XOR"/>
       <Split Type="AND">
        <TransitionRefs>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="Notification Admin SGeneraux"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="1612"/>
      <ExtendedAttribute Name="YOffset" Value="544"/>
      <ExtendedAttribute Name="Width" Value="241"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1397228188288" Name="">
     <Description></Description>
     <Implementation>
      <Tool Id="MeiboView" Type="APPLICATION">
       <ActualParameters>
        <ActualParameter>People</ActualParameter>
        <ActualParameter>Formulaire_SAISIE_NUMERO_BADGE</ActualParameter>
        <ActualParameter>dnPers</ActualParameter>
       </ActualParameters>
      </Tool>
     </Implementation>
     <Performer>AdminSGeneraux</Performer>
     <Priority>1</Priority>
     <StartMode>Manual</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="XOR"/>
       <Split Type="AND">
        <TransitionRefs>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="Saisie n&#176; badge"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="1616"/>
      <ExtendedAttribute Name="YOffset" Value="788"/>
      <ExtendedAttribute Name="Width" Value="225"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1397228225745" Name="">
     <Description></Description>
     <Route/>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Manual</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="XOR"/>
       <Split Type="AND">
        <TransitionRefs>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="route"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="368"/>
      <ExtendedAttribute Name="YOffset" Value="792"/>
      <ExtendedAttribute Name="Width" Value="120"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1397228269714" Name="">
     <Description></Description>
     <Implementation>
      <No/>
     </Implementation>
     <Performer>Studio</Performer>
     <Priority>1</Priority>
      <Deadline Execution="SYNCHR">
       <DeadlineCondition>VARIABLE dateAttenteArriveeJM14</DeadlineCondition>
       <ExceptionName>AttenteAriveeJM14</ExceptionName>
      </Deadline>
     <StartMode>Manual</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="XOR"/>
       <Split Type="AND">
        <TransitionRefs>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="Pause Date Arrivee J-14"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="1352"/>
      <ExtendedAttribute Name="YOffset" Value="548"/>
      <ExtendedAttribute Name="Width" Value="213"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1397228390007" Name="">
     <Description></Description>
     <Implementation>
      <Tool Id="MeiboScript" Type="SCRIPT">
       <ActualParameters>
        <ActualParameter>//Pas de script 
//Envoie un mail sur l&apos;&#233;venement de la t&#226;ches.</ActualParameter>
       </ActualParameters>
      </Tool>
     </Implementation>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Automatic</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="XOR"/>
       <Split Type="AND">
        <TransitionRefs>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="Notifications Alerte Arrivee"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="1360"/>
      <ExtendedAttribute Name="YOffset" Value="700"/>
      <ExtendedAttribute Name="Width" Value="201"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
      <ExtendedAttribute Name="Handlers" Value="HandlerList" >
<plugin en="Detect events" fr="D&#233;tection d&apos;&#233;v&#233;nements">
  <entries>
    <activity.state.Executing>
      <action>1401955422257</action>
    </activity.state.Executing>
  </entries>
</plugin>

      </ExtendedAttribute>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1397228435504" Name="">
     <Description></Description>
     <Implementation>
      <No/>
     </Implementation>
     <Performer>Studio</Performer>
     <Priority>1</Priority>
      <Deadline Execution="SYNCHR">
       <DeadlineCondition>VARIABLE dateAttenteArrivee</DeadlineCondition>
       <ExceptionName>AttenteArrivee</ExceptionName>
      </Deadline>
     <StartMode>Manual</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="XOR"/>
       <Split Type="AND">
        <TransitionRefs>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="Pause Date Arrivee"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="1092"/>
      <ExtendedAttribute Name="YOffset" Value="700"/>
      <ExtendedAttribute Name="Width" Value="189"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1397228477718" Name="">
     <Description></Description>
     <Implementation>
      <Tool Id="MeiboScript" Type="SCRIPT">
       <ActualParameters>
        <ActualParameter>//Pas de script 
//Envoie un mail sur l&apos;&#233;venement de la t&#226;ches.</ActualParameter>
       </ActualParameters>
      </Tool>
     </Implementation>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Automatic</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="XOR"/>
       <Split Type="AND">
        <TransitionRefs>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="Notifications Arrivee"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="760"/>
      <ExtendedAttribute Name="YOffset" Value="700"/>
      <ExtendedAttribute Name="Width" Value="177"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
      <ExtendedAttribute Name="Handlers" Value="HandlerList" >
<plugin en="Detect events" fr="D&#233;tection d&apos;&#233;v&#233;nements">
  <entries>
    <activity.state.Executing>
      <action>1401956012478</action>
    </activity.state.Executing>
  </entries>
</plugin>

      </ExtendedAttribute>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1397228525855" Name="">
     <Description></Description>
     <Implementation>
      <Tool Id="MeiboScript" Type="SCRIPT">
       <ActualParameters>
        <ActualParameter>//$debug
/**/
/* Script workflow - Provisioning AD (GGRs) */
/**/
/**/
/* Script modifi&#233; par akerva le 16/04
/**/ 
/////////////////////
// Debut du script //
/////////////////////  

/*R&#233;cup&#233;ration des variables workflow de la personne*/
var habilitationFonctionnelle = returnEmpty(meibo.getWorkflowVariable(&quot;habilitationFonctionnelle&quot;));
var habilitationOperationnelle = returnEmpty(meibo.getWorkflowVariable(&quot;habilitationOperationnelle&quot;));
var GGU_PersonList = returnEmpty(meibo.getWorkflowVariable(&quot;GGU_PersonList&quot;));
var grp_contrat = returnEmpty(meibo.getWorkflowVariable(&quot;grp_contrat&quot;));
var idAD = returnEmpty(meibo.getWorkflowVariable(&quot;idAD&quot;));
var civilite = returnEmpty(meibo.getWorkflowVariable(&quot;civilite&quot;));
var sn = returnEmpty(meibo.getWorkflowVariable(&quot;sn&quot;));
var givenName = returnEmpty(meibo.getWorkflowVariable(&quot;givenName&quot;));
var dateArrivee = returnEmpty(meibo.getWorkflowVariable(&quot;dateArrivee&quot;));
var pourcentagePresence = returnEmpty(meibo.getWorkflowVariable(&quot;pourcentagePresence&quot;));
var dateFinContrat = returnEmpty(meibo.getWorkflowVariable(&quot;dateFinContrat&quot;));
var manager = returnEmpty(meibo.getWorkflowVariable(&quot;manager&quot;));
var company = returnEmpty(meibo.getWorkflowVariable(&quot;company&quot;));
var dnPers = returnEmpty(meibo.getWorkflowVariable(&quot;dnPers&quot;));

////////////////////////////////////////////////////////////////////////////////////////
//                          Active Directory
////////////////////////////////////////////////////////////////////////////////////////


/*R&#233;cup&#233;ration de l&apos;ou des personne de l&apos;AD*/
var parameters = getProvisioningParameters_General();
var BCOM_AD_OU_PEOPLE = parameters.get(&quot;BCOM_AD_OU_PEOPLE&quot;); 

/*Cr&#233;ation d&apos;un resultset*/
var resultset = new ResultSet();
var entry = new Entry();

entry.baseDN=BCOM_AD_OU_PEOPLE;
entry.idAD=idAD;
entry.habilitationFonctionnelle=habilitationFonctionnelle;
entry.habilitationOperationnelle=habilitationOperationnelle;
entry.GGU_PersonList=GGU_PersonList;
entry.grp_contrat=grp_contrat;
entry.dnPers=dnPers;

resultset.addEntry(entry);

/*Provisioning AD*/

var provisioningStatus = meibo.executeProvisioning(&quot;Provisioning_AD_UPDATE_GGR_UNIX&quot;,resultset,parameters);
if ( provisioningStatus.getExitCode() != 0 ){
  var parametersMail = getProvisioningParameters_Mails();
  var parametersDroit = getProvisioningParameters_Droit();
  var messageError = provisioningStatus.getErrorMsg();//-- r&#233;cup&#233;ration du message d&apos;erreur
  var grp_adminMeibo = parametersDroit.get(&quot;BCOM_PROFIL_AdminMeibo&quot;); 
  var sendMailAdminMeibo = getAdressMailByRole(grp_adminMeibo);
  //plugin de mail d&apos;erreur
  parametersMail.add(&quot;messageError&quot;,messageError+&quot;&lt;/br&gt;&lt;/br&gt;&quot;);
  parametersMail.add(&quot;sendMailAdminMeibo&quot;,sendMailAdminMeibo);
  parametersMail.add(&quot;action&quot;,&quot;Processus d&apos;arriv&#233;e, Provisioning Groupe GGR et attribut unix&quot;);
  meibo.executePlugin(&quot;Notification_ERREUR_PROVISIONING&quot;,parametersMail);
}</ActualParameter>
       </ActualParameters>
      </Tool>
     </Implementation>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Automatic</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="XOR"/>
       <Split Type="AND">
        <TransitionRefs>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="Provisioning AD (GGRs)"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="496"/>
      <ExtendedAttribute Name="YOffset" Value="700"/>
      <ExtendedAttribute Name="Width" Value="205"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1397814240165" Name="">
     <Description></Description>
     <Route/>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Manual</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="XOR"/>
       <Split Type="AND">
        <TransitionRefs>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="route"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="532"/>
      <ExtendedAttribute Name="YOffset" Value="144"/>
      <ExtendedAttribute Name="Width" Value="120"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1397814279190" Name="">
     <Description></Description>
     <Route/>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Manual</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="XOR"/>
       <Split Type="AND">
        <TransitionRefs>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="route"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="784"/>
      <ExtendedAttribute Name="YOffset" Value="36"/>
      <ExtendedAttribute Name="Width" Value="120"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1398174486397" Name="">
     <Description></Description>
     <Implementation>
      <Tool Id="MeiboScript" Type="SCRIPT">
       <ActualParameters>
        <ActualParameter>initializeResource();</ActualParameter>
       </ActualParameters>
      </Tool>
     </Implementation>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Automatic</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="XOR"/>
       <Split Type="AND">
        <TransitionRefs>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="Initialisation des ressources"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="160"/>
      <ExtendedAttribute Name="YOffset" Value="120"/>
      <ExtendedAttribute Name="Width" Value="233"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1398861605500" Name="">
     <Description></Description>
     <Implementation>
      <Tool Id="MeiboScript" Type="SCRIPT">
       <ActualParameters>
        <ActualParameter>//Pas de script 
//Envoie un mail sur l&apos;&#233;venement de la t&#226;ches.</ActualParameter>
       </ActualParameters>
      </Tool>
     </Implementation>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Automatic</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="XOR"/>
       <Split Type="AND">
        <TransitionRefs>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="Notification Helpdesk"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="500"/>
      <ExtendedAttribute Name="YOffset" Value="544"/>
      <ExtendedAttribute Name="Width" Value="197"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
      <ExtendedAttribute Name="Handlers" Value="HandlerList" >
<plugin en="Detect events" fr="D&#233;tection d&apos;&#233;v&#233;nements">
  <entries>
    <activity.state.Executing>
      <action>1401956266341</action>
    </activity.state.Executing>
  </entries>
</plugin>

      </ExtendedAttribute>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1398861815098" Name="">
     <Description></Description>
     <Implementation>
      <Tool Id="MeiboScript" Type="SCRIPT">
       <ActualParameters>
        <ActualParameter>/**/
/* Script workflow - Pr&#233;paration mail helpdesk */
/**/
/**/
/* Script modifi&#233; par akerva le 16/04
/**/ 
/////////////////////
// Debut du script //
/////////////////////  

/*R&#233;cup&#233;ration des variables workflow de la personne*/
var BCOM_ARRIVEE_AD_MDP_USER = returnEmpty(meibo.getWorkflowVariable(&quot;BCOM_ARRIVEE_AD_MDP_USER&quot;));
var idAD = returnEmpty(meibo.getWorkflowVariable(&quot;idAD&quot;));
var dnPers = returnEmpty(meibo.getWorkflowVariable(&quot;dnPers&quot;));
var civilite = returnEmpty(meibo.getWorkflowVariable(&quot;civilite&quot;));
var sn = returnEmpty(meibo.getWorkflowVariable(&quot;sn&quot;));
var givenName = returnEmpty(meibo.getWorkflowVariable(&quot;givenName&quot;));

// fichier de propri&#233;t&#233;s des mails
var parametersMails = getProvisioningParameters_Mails();

/*variable utilis&#233; pour le nom du processus et du message d&apos;avertissement lors de la fin du formulaire*/
  /* info sur la cible */
  var titrePersCible = &quot;&quot; ;
  if ( civilite != &quot;&quot; ){
    titrePersCible = miseEnForme(civilite) + &quot; &quot; + miseEnForme(sn) + &quot; &quot; + miseEnForme(givenName);
  }
  else{
    titrePersCible = miseEnForme(sn) + &quot; &quot; + miseEnForme(givenName);
  }


/*Message 09*/
var ARR09_OBJET = parametersMails.get(&quot;ARR-09_OBJET&quot;);
ARR09_OBJET = ARR09_OBJET.replace(&quot;@@@displayName_Cible@@@&quot;,titrePersCible);
var ARR09_MESSAGE = parametersMails.get(&quot;ARR-09_MESSAGE&quot;);
ARR09_MESSAGE = ARR09_MESSAGE.replace(&quot;@@@displayName_Cible@@@&quot;,titrePersCible);
ARR09_MESSAGE = ARR09_MESSAGE.replace(&quot;@@@loginAD_Cible@@@&quot;,idAD);
ARR09_MESSAGE = ARR09_MESSAGE.replace(&quot;@@@MDP_Cible@@@&quot;,BCOM_ARRIVEE_AD_MDP_USER);

meibo.setWorkflowVariable(&quot;ARR09_OBJET&quot;,ARR09_OBJET);
meibo.setWorkflowVariable(&quot;ARR09_MESSAGE&quot;,ARR09_MESSAGE);

var sendMailHelpdesk= parametersMails.get(&quot;MAIL_HELPDESK&quot;);
meibo.setWorkflowVariable(&quot;sendMailHelpdesk&quot;,sendMailHelpdesk);</ActualParameter>
       </ActualParameters>
      </Tool>
     </Implementation>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Automatic</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="XOR"/>
       <Split Type="AND">
        <TransitionRefs>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="Preparation mail helpdesk"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="500"/>
      <ExtendedAttribute Name="YOffset" Value="612"/>
      <ExtendedAttribute Name="Width" Value="197"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1399381931683" Name="">
     <Description></Description>
     <Route/>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Manual</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="XOR"/>
       <Split Type="AND">
        <TransitionRefs>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="route"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="164"/>
      <ExtendedAttribute Name="YOffset" Value="304"/>
      <ExtendedAttribute Name="Width" Value="120"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1399382329211" Name="">
     <Description></Description>
     <Route/>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Manual</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="XOR"/>
       <Split Type="AND">
        <TransitionRefs>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="route"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="264"/>
      <ExtendedAttribute Name="YOffset" Value="204"/>
      <ExtendedAttribute Name="Width" Value="120"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1399382365699" Name="">
     <Description></Description>
     <Route/>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Manual</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="AND"/>
       <Split Type="AND">
        <TransitionRefs>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="route"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="264"/>
      <ExtendedAttribute Name="YOffset" Value="368"/>
      <ExtendedAttribute Name="Width" Value="120"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
   </Activities>
   <Transitions>
    <Transition Id="T1397227313339" Name="T1397227313339" From="A1397227289783" To="A1397226634794">
     <Condition Type="CONDITION">TestMobile==&quot;true&quot;</Condition>
    </Transition>
    <Transition Id="T1397227424129" Name="T1397227424129" From="A1397227376432" To="A1397226734467">
     <Condition Type="CONDITION">TestExterne==&quot;false&quot;</Condition>
    </Transition>
    <Transition Id="T1397227488254" Name="T1397227488254" From="A1397226341874" To="A1397226380413">
     <Condition Type="CONDITION">boiteMail==&quot;TRUE&quot;</Condition>
    </Transition>
    <Transition Id="T1397227549346" Name="T1397227549346" From="A1397227514376" To="A1397226413463">
     <Condition Type="CONDITION">TestTelephone==&quot;true&quot;</Condition>
    </Transition>
    <Transition Id="T1397227849259" Name="T1397227849259" From="A1397227514376" To="A1397227557940">
     <Condition Type="OTHERWISE"></Condition>
    </Transition>
    <Transition Id="T1397227871322" Name="T1397227871322" From="A1397226573706" To="A1397226594896"/>
    <Transition Id="T1397227892910" Name="T1397227892910" From="A1397227557940" To="A1397226328326"/>
    <Transition Id="T1397228039737" Name="T1397228039737" From="A1397227924968" To="A1397228010237"/>
    <Transition Id="T1397228115188" Name="T1397228115188" From="A1397226594896" To="A1397228066077"/>
    <Transition Id="T1397228118300" Name="T1397228118300" From="A1397228066077" To="A1397226328326"/>
    <Transition Id="T1397228161147" Name="T1397228161147" From="A1397226594896" To="A1397228128939"/>
    <Transition Id="T1397228242926" Name="T1397228242926" From="A1397228188288" To="A1397228225745"/>
    <Transition Id="T1397228246294" Name="T1397228246294" From="A1397228225745" To="A1397226328326"/>
    <Transition Id="T1397228255899" Name="T1397228255899" From="A1397228128939" To="A1397228188288"/>
    <Transition Id="T1397228371977" Name="T1397228371977" From="A1397228128939" To="A1397228269714"/>
    <Transition Id="T1397814265861" Name="T1397814265861" From="A1397226341874" To="A1397814240165">
     <Condition Type="OTHERWISE"></Condition>
    </Transition>
    <Transition Id="T1397814320188" Name="T1397814320188" From="A1397814279190" To="A1397227514376"/>
    <Transition Id="T1397814322669" Name="T1397814322669" From="A1397814279190" To="A1397226573706"/>
    <Transition Id="T1398174524817" Name="T1398174524817" From="A1397226310200" To="A1398174486397"/>
    <Transition Id="T1398174526320" Name="T1398174526320" From="A1398174486397" To="A1397226341874"/>
    <Transition Id="T1398174527976" Name="T1398174527976" From="A1398174486397" To="A1397227376432"/>
    <Transition Id="T1398174530008" Name="T1398174530008" From="A1398174486397" To="A1397227289783"/>
    <Transition Id="T1398861641095" Name="T1398861641095" From="A1398861605500" To="A1397226328326"/>
    <Transition Id="T1398861851876" Name="T1398861851876" From="A1397228525855" To="A1398861815098"/>
    <Transition Id="T1398861853244" Name="T1398861853244" From="A1398861815098" To="A1398861605500"/>
    <Transition Id="T1399381950981" Name="T1399381950981" From="A1397227289783" To="A1399381931683">
     <Condition Type="OTHERWISE"></Condition>
    </Transition>
    <Transition Id="T1399381993482" Name="T1399381993482" From="A1397226634794" To="A1399381931683"/>
    <Transition Id="T1399382043371" Name="T1399382043371" From="A1397226413463" To="A1397227571065"/>
    <Transition Id="T1399382056319" Name="T1399382056319" From="A1397227571065" To="A1397227924968"/>
    <Transition Id="T1399382058472" Name="T1399382058472" From="A1397228010237" To="A1397227557940"/>
    <Transition Id="T1399382184005" Name="T1399382184005" From="A1397228477718" To="A1397228525855"/>
    <Transition Id="T1399382192383" Name="T1399382192383" From="A1397228435504" To="A1397228477718">
     <Condition Type="EXCEPTION">AttenteArrivee</Condition>
    </Transition>
    <Transition Id="T1399382204551" Name="T1399382204551" From="A1397228390007" To="A1397228435504"/>
    <Transition Id="T1399382345341" Name="T1399382345341" From="A1397227376432" To="A1399382329211">
     <Condition Type="OTHERWISE"></Condition>
    </Transition>
    <Transition Id="T1399382357197" Name="T1399382357197" From="A1397226734467" To="A1399382329211"/>
    <Transition Id="T1399382378117" Name="T1399382378117" From="A1399381931683" To="A1399382365699"/>
    <Transition Id="T1399382380301" Name="T1399382380301" From="A1399382329211" To="A1399382365699"/>
    <Transition Id="T1399382382547" Name="T1399382382547" From="A1399382365699" To="A1397226328326"/>
    <Transition Id="T1399994739441" Name="T1399994739441" From="A1397814240165" To="A1397814279190"/>
    <Transition Id="T1399994741656" Name="T1399994741656" From="A1397226380413" To="A1397814279190"/>
    <Transition Id="T1402585814332" Name="T1402585814332" From="A1397228269714" To="A1397228390007">
     <Condition Type="EXCEPTION">AttenteAriveeJM14</Condition>
    </Transition>
   </Transitions>
  </WorkflowProcess>
  <WorkflowProcess AccessLevel="PUBLIC" Id="1448472291649" Name="Mission">
   <ProcessHeader DurationUnit="D">
    <Description>Processus Meibo</Description>
   </ProcessHeader>
   <RedefinableHeader PublicationStatus="RELEASED">
    <Author>Meibo</Author>
    <Version>3</Version>
   </RedefinableHeader>
   <ExtendedAttributes>
    <ExtendedAttribute Name="scale"  Value="100%"/>
    <ExtendedAttribute Name="role"  Value="AdminMeibo"/>
    <ExtendedAttribute Name="role"  Value="InitiateurDeplacement"/>
    <ExtendedAttribute Name="role"  Value="Studio"/>
    <ExtendedAttribute Name="role"  Value="Utilisateur"/>
    <ExtendedAttribute Name="fr_name"  Value="Mission"/>
    <ExtendedAttribute Name="fr_description"  Value=""/>
    <ExtendedAttribute Name="actionsList" Value="">
      <Action Name="Initialisation" Type="workflowScriptImplementation" ID="1448472454995">
      </Action>
      <Action Name="Notifier" Type="pluginMail-1" ID="1448472764360">
      </Action>
      <Action Name="acceptationEligible" Type="workflowScriptImplementation" ID="1452270989283">
// affectation du role
var participantDn = meibo.getWorkflowVariable(&quot;participantDN&quot;);
var /*String*/ missionID = meibo.getWorkflowVariable(&quot;missionID&quot;); 
meibo.setWorkflowVariable(&quot;ROLE-Participant&quot;, participantDn); 

var /*WapiWorkItem*/ wapiworkitem = meibo.getCurrentWorkflowTask();
meibo.logInfo(&quot;Affectation de la tache (&quot; + wapiworkitem.getId() + &quot;) d&apos;acceptation de mission &quot; + missionID + &quot; &#224; &quot; + participantDn);

// notification
var email = meibo.getWorkflowVariable(&quot;participantEmail&quot;);
if(email==null){
  meibo.logWarn(&quot;Impossible de notifier &quot; + participantDn + &quot; car il n&apos;a pas d&apos;email&quot;);
}else{
  var /*Parameters*/ params = new Parameters();
  params.add(&quot;MAIL_HEADER&quot;, returnEmpty(getMailParameter(&quot;MAIL_HEADER&quot;)));
  params.add(&quot;MAIL_FOOTER&quot;, returnEmpty(getMailParameter(&quot;MAIL_FOOTER&quot;)));
  params.add(&quot;MAIL_LINKNAME&quot;, returnEmpty(getMailParameter(&quot;MAIL_LINKNAME&quot;)));
  params.add(&quot;MAIL_SENDER&quot;, getMailParameter(&quot;MAIL_SENDER&quot;));
  //params.add(&quot;participantDN&quot;, meibo.getWorkflowVariable(&quot;participantDN&quot;));
  params.add(&quot;recipient&quot;, email);
  meibo.executePlugin(&quot;NotifyParticipantForAcceptation&quot;,params);
}
      </Action>
      <Action Name="managerValidationEligible" Type="workflowScriptImplementation" ID="1452522071084">
///$debug
var /*String*/ participantDn = meibo.getWorkflowVariable(&quot;participantDN&quot;);
var /*String*/ missionID = meibo.getWorkflowVariable(&quot;missionID&quot;); 
var /*String*/ user = meibo.getWorkflowVariable(&quot;participantDisplayName&quot;);

var /*ResultSet*/ managerRs = getManager(participantDn);
var /*WapiWorkItem*/ wapiworkitem = meibo.getCurrentWorkflowTask();
meibo.logDebug(&quot;getCurrentWorkflowTask : &quot; + wapiworkitem);
var /*UserTask*/ userTask = meibo.getWorkflowUserTask()
meibo.logDebug(&quot;getWorkflowUserTask : &quot; + userTask);

if(managerRs.getEntryCount()&gt;0){
  // affectation du role
  var /*Entry*/ managerEntry = managerRs.getEntry();
  meibo.setWorkflowVariable(&quot;ROLE-Manager&quot;, managerEntry.dn[0]); 
  meibo.logInfo(&quot;Affectation de la tache (&quot; + wapiworkitem.getId() + &quot;) de validation de la mission &quot; + missionID + &quot; &#224; &quot; + managerEntry.dn[0] + &quot; pour &quot; + participantDn);

  // notification
  var email = meibo.getWorkflowVariable(&quot;participantEmail&quot;);
  if(email==null){
    meibo.logWarn(&quot;Impossible de notifier &quot; + participantDn + &quot; car il n&apos;a pas d&apos;email&quot;);
  }else{
    var /*Parameters*/ params = new Parameters();
    params.add(&quot;MAIL_HEADER&quot;, returnEmpty(getMailParameter(&quot;MAIL_HEADER&quot;)));
    params.add(&quot;MAIL_FOOTER&quot;, returnEmpty(getMailParameter(&quot;MAIL_FOOTER&quot;)));
    params.add(&quot;MAIL_LINKNAME&quot;, returnEmpty(getMailParameter(&quot;MAIL_LINKNAME&quot;)));
    params.add(&quot;MAIL_SENDER&quot;, getMailParameter(&quot;MAIL_SENDER&quot;));
    params.add(&quot;user&quot;, user);
    params.add(&quot;missionID&quot;, missionID);
    params.add(&quot;recipient&quot;, email);
    params.add(&quot;participantDN&quot;, participantDn);
    
    meibo.executePlugin(&quot;NotifyForValidation&quot;,params);
  }
}else{
  meibo.logWarn(&quot;Pas de manager trouv&#233; pour &quot; + participantDn);
  //TODO : voire comment traiter; par d&#233;faut le workflow resterait bloqu&#233;
  wapiworkitem.complete();
}
      </Action>
      <Action Name="modificationEligible" Type="workflowScriptImplementation" ID="1452524978986">
// affectation du role
var participantDn = meibo.getWorkflowVariable(&quot;participantDN&quot;);
var /*String*/ missionID = meibo.getWorkflowVariable(&quot;missionID&quot;); 
var /*String*/ reason = meibo.getWorkflowVariable(&quot;comment&quot;); 
meibo.setWorkflowVariable(&quot;ROLE-Participant&quot;, participantDn); 

var /*WapiWorkItem*/ wapiworkitem = meibo.getCurrentWorkflowTask();
meibo.logInfo(&quot;Affectation de la tache (&quot; + wapiworkitem.getId() + &quot;) de modification de mission &quot; + missionID + &quot; &#224; &quot; + participantDn);

// notification
var email = meibo.getWorkflowVariable(&quot;participantEmail&quot;);
if(email==null){
  meibo.logWarn(&quot;Impossible de notifier &quot; + participantDn + &quot; car il n&apos;a pas d&apos;email&quot;);
}else{
  var /*Parameters*/ params = new Parameters();
  params.add(&quot;MAIL_HEADER&quot;, returnEmpty(getMailParameter(&quot;MAIL_HEADER&quot;)));
  params.add(&quot;MAIL_FOOTER&quot;, returnEmpty(getMailParameter(&quot;MAIL_FOOTER&quot;)));
  params.add(&quot;MAIL_LINKNAME&quot;, returnEmpty(getMailParameter(&quot;MAIL_LINKNAME&quot;)));
  params.add(&quot;MAIL_SENDER&quot;, getMailParameter(&quot;MAIL_SENDER&quot;));
  params.add(&quot;recipient&quot;, email);
  params.add(&quot;reason&quot;, reason);
  meibo.executePlugin(&quot;NotifyRejection&quot;,params);
}
      </Action>
      <Action Name="secondLevelValidationEligible" Type="workflowScriptImplementation" ID="1452593973817">
var /*Set*/ validationRoleSet = meibo.setWorkflowVariable(&quot;secondValidationRoles&quot;); 
var /*Array*/ validationRoleArray = new Array(validationRoleSet.toArray());
meibo.setWorkflowVariable(&quot;ROLE_SecondLevelValidation&quot;, validationRoleArray);

var /*WapiWorkItem*/ wapiworkitem = meibo.getCurrentWorkflowTask();
meibo.logDebug(&quot;getCurrentWorkflowTask : &quot; + wapiworkitem);
var /*UserTask*/ userTask = meibo.getWorkflowUserTask()
meibo.logDebug(&quot;getWorkflowUserTask : &quot; + userTask);

meibo.logInfo(&quot;Affectation de la tache (&quot; + wapiworkitem.getId() + &quot;) de validation de la mission &quot; + missionID + &quot; &#224; &quot; + validationRoleArray + &quot; pour &quot; + participantDn);

if(!validationRoleSet.isEmpty()){

  // notification
  var email = meibo.getWorkflowVariable(&quot;participantEmail&quot;);
  //TODO recherche emails correspondant aux roles
  var targetUsers = getRecursiveGroupMembersFromGroupNames(validationRoleArray);
  if(targetUsers.isEmpty()){
    meibo.logWarn(&quot;Aucun utilisateur trouv&#233; avec les roles &quot; + validationRoleArray + &quot; pour validation de second niveau&quot;);
  }else{
    var secondLevelValidationPeople = new Array(targetUsers.toArray());
    meibo.setWorkflowVariable(&quot;secondLevelValidationPeople&quot;, secondLevelValidationPeople);

    var /*Parameters*/ params = new Parameters();
    params.add(&quot;MAIL_HEADER&quot;, returnEmpty(getMailParameter(&quot;MAIL_HEADER&quot;)));
    params.add(&quot;MAIL_FOOTER&quot;, returnEmpty(getMailParameter(&quot;MAIL_FOOTER&quot;)));
    params.add(&quot;MAIL_LINKNAME&quot;, returnEmpty(getMailParameter(&quot;MAIL_LINKNAME&quot;)));
    params.add(&quot;MAIL_SENDER&quot;, getMailParameter(&quot;MAIL_SENDER&quot;));
    params.add(&quot;user&quot;, user);
    params.add(&quot;missionID&quot;, missionID);
    params.add(&quot;recipient&quot;, email);
    params.add(&quot;participantDN&quot;, participantDn);
    
    meibo.executePlugin(&quot;NotifyForSecondLevelValidation&quot;,params);
  }
}else{
  // normalement &#231;a ne devrait pas arriver quand on passe par ici
  meibo.logDebug(&quot;Pas de role d&#233;fini pour validation de 2nd niveau&quot;);
  wapiworkitem.complete();
}
      </Action>
    </ExtendedAttribute>
   </ExtendedAttributes>
   <DataFields>
    <DataField Id="ROLE-Manager" IsArray="FALSE">
     <DataType>
      <BasicType Type="PERFORMER"/>
     </DataType>
     <InitialValue>0</InitialValue>
    </DataField>
    <DataField Id="ROLE-Initiateur" IsArray="FALSE">
     <DataType>
      <BasicType Type="PERFORMER"/>
     </DataType>
     <InitialValue>0</InitialValue>
    </DataField>
    <DataField Id="ROLE-Participant" IsArray="FALSE">
     <DataType>
      <BasicType Type="PERFORMER"/>
     </DataType>
     <InitialValue>0</InitialValue>
    </DataField>
    <DataField Id="missionDN" IsArray="FALSE">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </DataField>
    <DataField Id="accepted" IsArray="FALSE">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
     <InitialValue>false</InitialValue>
    </DataField>
    <DataField Id="costDefined" IsArray="FALSE">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
     <InitialValue>false</InitialValue>
    </DataField>
    <DataField Id="firstEventStartDate" IsArray="FALSE">
     <DataType>
      <BasicType Type="DEADLINE"/>
     </DataType>
     <InitialValue>01/01/16 10:24</InitialValue>
    </DataField>
    <DataField Id="MAIL_HEADER" IsArray="FALSE">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </DataField>
    <DataField Id="MAIL_FOOTER" IsArray="FALSE">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </DataField>
    <DataField Id="MAIL_SENDER" IsArray="FALSE">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </DataField>
    <DataField Id="participantCn" IsArray="FALSE">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </DataField>
    <DataField Id="participantEmail" IsArray="FALSE">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </DataField>
    <DataField Id="isDG" IsArray="FALSE">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
     <InitialValue>false</InitialValue>
    </DataField>
    <DataField Id="managerValidated" IsArray="FALSE">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
     <InitialValue>false</InitialValue>
    </DataField>
    <DataField Id="DDIvalidationRequired" IsArray="FALSE">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
     <InitialValue>true</InitialValue>
    </DataField>
    <DataField Id="notificationRoles" IsArray="FALSE">
     <DataType>
      <BasicType Type="OBJECT"/>
     </DataType>
    </DataField>
    <DataField Id="secondValidationRoles" IsArray="FALSE">
     <DataType>
      <BasicType Type="OBJECT"/>
     </DataType>
    </DataField>
    <DataField Id="finalConfirmation" IsArray="FALSE">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
     <InitialValue>false</InitialValue>
    </DataField>
    <DataField Id="completedForOrganisation" IsArray="FALSE">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
     <InitialValue>false</InitialValue>
    </DataField>
    <DataField Id="secondLevelValidated" IsArray="FALSE">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
     <InitialValue>false</InitialValue>
    </DataField>
    <DataField Id="missionModified" IsArray="FALSE">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
     <InitialValue>false</InitialValue>
    </DataField>
    <DataField Id="ROLE_SecondLevelValidation" IsArray="FALSE">
     <DataType>
      <BasicType Type="PERFORMER"/>
     </DataType>
    </DataField>
    <DataField Id="secondLevelValidationPeople" IsArray="TRUE">
     <DataType>
      <BasicType Type="OBJECT"/>
     </DataType>
    </DataField>
   </DataFields>
   <FormalParameters>
    <FormalParameter Id="participantDN" Index="23" Mode="IN">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="missionID" Index="24" Mode="IN">
     <DataType>
      <BasicType Type="INTEGER"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="initiatorDN" Index="25" Mode="IN">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="initiatorID" Index="26" Mode="IN">
     <DataType>
      <BasicType Type="INTEGER"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="participantID" Index="27" Mode="IN">
     <DataType>
      <BasicType Type="INTEGER"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="baseURL" Index="28" Mode="IN">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="comment" Index="29" Mode="INOUT">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </FormalParameter>
   </FormalParameters>
   <Participants>
    <Participant Id="AdminMeibo" Name="AdminMeibo">
     <ParticipantType Type="ROLE"/>
    </Participant>
    <Participant Id="AnalyseurDeplacement" Name="AnalyseurDeplacement">
     <ParticipantType Type="ROLE"/>
    </Participant>
    <Participant Id="DDI" Name="DDI">
     <ParticipantType Type="ROLE"/>
    </Participant>
    <Participant Id="InitiateurDeplacement" Name="InitiateurDeplacement">
     <ParticipantType Type="ROLE"/>
    </Participant>
    <Participant Id="OrganisateurVoyage" Name="OrganisateurVoyage">
     <ParticipantType Type="ROLE"/>
    </Participant>
    <Participant Id="Studio" Name="Studio">
     <ParticipantType Type="ROLE"/>
    </Participant>
    <Participant Id="Utilisateur" Name="Utilisateur">
     <ParticipantType Type="ROLE"/>
    </Participant>
   </Participants>
   <Activities>
    <Activity Id="A1448472295866" Name="">
     <Description></Description>
     <Route/>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Manual</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="AND"/>
       <Split Type="XOR">
        <TransitionRefs>
         <TransitionRef Id="T1448472522446"/>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="D&#233;but"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="96"/>
      <ExtendedAttribute Name="YOffset" Value="4"/>
      <ExtendedAttribute Name="Width" Value="120"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1448472343512" Name="">
     <Description></Description>
     <Route/>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Manual</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="XOR"/>
       <Split Type="AND">
        <TransitionRefs>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="Fin"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="992"/>
      <ExtendedAttribute Name="YOffset" Value="1024"/>
      <ExtendedAttribute Name="Width" Value="120"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1448472369326" Name="">
     <Description></Description>
     <Implementation>
      <Tool Id="MeiboScript" Type="SCRIPT">
       <ActualParameters>
        <ActualParameter>//$debug
var /*String*/ missionID = meibo.getWorkflowVariable(&quot;missionID&quot;); 
var /*String*/ missionDN = &quot;T_MISSION_TMN,TMN_ID,&quot; + missionID; 
meibo.setWorkflowVariable(&quot;missionDN&quot;, missionDN);
var /*String*/ ownerID = meibo.getWorkflowVariable(&quot;participantID&quot;);

meibo.setWorkflowVariable(&quot;MAIL_HEADER&quot;, returnEmpty(getMailParameter(&quot;MAIL_HEADER&quot;)));
meibo.setWorkflowVariable(&quot;MAIL_FOOTER&quot;, returnEmpty(getMailParameter(&quot;MAIL_FOOTER&quot;)));
meibo.setWorkflowVariable(&quot;MAIL_LINKNAME&quot;, returnEmpty(getMailParameter(&quot;MAIL_LINKNAME&quot;)));
meibo.setWorkflowVariable(&quot;MAIL_SENDER&quot;, getMailParameter(&quot;MAIL_SENDER&quot;));

var /*String*/ particpantLdapDN = null;
var /*Entry*/ personEntry = meibo.getDnEntry(&quot;TravelPeople&quot;,&quot;T_PERSON_PRS,PRS_ID,&quot; + ownerID, &quot;mail,ldapDn,PRS_LOGIN,displayName&quot;);
var participantEmail = personEntry.mail[0];
if((participantEmail==null) || (participantEmail==&quot;&quot;)){
  meibo.logWarn(&quot;Le participant &quot; + ownerID + &quot; n&apos;a pas d&apos;adresse email&quot;);
}else{
  meibo.setWorkflowVariable(&quot;participantEmail&quot;, participantEmail);
}
meibo.setWorkflowVariable(&quot;participantDN&quot;, personEntry.ldapDn[0]);
meibo.setWorkflowVariable(&quot;participantCn&quot;, personEntry.PRS_LOGIN[0]);
meibo.setWorkflowVariable(&quot;participantDisplayName&quot;, personEntry.displayName[0]);

var wfVariables = meibo.getWorkflowVariables(); // utile seulement en debug

meibo.logDebug(&quot;Initialisation workflow mission &quot; + missionID + &quot; pour &quot; + ownerID);

var /*Entry*/ missionEntry = meibo.getDnEntry(&quot;Mission&quot;, missionDN);

// recherche les caract&#233;ristiques des participications aux &#233;v&#232;nements :
// - 1ere date de d&#233;but de participation &#224; un &#233;venement (pour constituer l&apos;&#233;ch&#233;ance du workflow)
// - roles pour les validations et notifications en fonction de ces &#233;venements et participations
var /*ResultSet*/ missionEventRS = meibo.executeLink(&quot;MissionEvent&quot;, missionDN,&quot;fkTCT_ID,fkTES_ID,fkTTY_ID&quot;);
var /*ResultSet*/ eventAttendeesRS = null;
var /*Entry*/ eventAttendeesEntry = null;
var missionId=null;
var /*Date*/ eventStartDate = null;
var /*Date*/ overallStartDate = null;
var scopeID = null;
var evtTypeID = null;
var purposeID = null;
var involvementID = null;
var /*ResultSet*/ validationRoleRS = null;
var /*Entry*/ validationRoleEntry = null;
var /*Set*/ validationRoleSet = new java.util.HashSet();
var /*ResultSet*/ notificationRoleRS = null;
var /*Entry*/ notificationRoleEntry = null;
var /*Set*/ notificationRoleSet = new java.util.HashSet();

for each(var missionEvent in missionEventRS){
  missionId = missionEvent.fkTCT_ID[0] 
  eventAttendeesRS = meibo.executeResource(&quot;R_Attendees&quot;,&quot;PRS_ID=&quot;+ ownerID + &quot; AND TCT_ID=&quot;+missionId ,1,&quot;RAS_START_DATE,TPE_ID,TIN_ID&quot;);
  eventAttendeesEntry = eventAttendeesRS.getEntry();
  
  scopeID = missionEvent.fkTES_ID[0];
  evtTypeID = missionEvent.fkTTY_ID[0];
  purposeID = eventAttendeesEntry.TPE_ID[0];
  involvementID = eventAttendeesEntry.TIN_ID[0];

  // recherche des roles pour la 2eme validation (validation &quot;DDI&quot;)  
  validationRoleRS = meibo.executeSqlRequest(&quot;TRAVEL_BCOM&quot;,&quot;call get_travel_validation_roles(&apos;&quot;+ scopeID + &quot;&apos;,&apos;&quot; + evtTypeID + &quot;&apos;,&apos;&quot; + purposeID + &quot;&apos;,&apos;&quot; + involvementID + &quot;&apos;)&quot;,0); 
  for each(var validationRoleEntry in validationRoleRS){
    meibo.logDebug(&quot;ValidationRole : &quot; + validationRoleEntry);
    validationRoleSet.add(validationRoleEntry.ValidationRoles[0]);
  }
  meibo.setWorkflowVariable(&quot;secondValidationRoles&quot;, validationRoleSet);
  
  // recherche des roles pour la natification sans validation (notification &quot;DDI&quot;)  
  notificationRoleRS = meibo.executeSqlRequest(&quot;TRAVEL_BCOM&quot;,&quot;call get_travel_notified_roles(&apos;&quot;+ scopeID + &quot;&apos;,&apos;&quot; + evtTypeID + &quot;&apos;,&apos;&quot; + purposeID + &quot;&apos;,&apos;&quot; + involvementID + &quot;&apos;)&quot;,0); 
  for each(var notificationRoleEntry in notificationRoleRS){
    meibo.logDebug(&quot;ValidationRole : &quot; + notificationRoleEntry);   
    notificationRoleSet.add(notificationRoleEntry.ValidationRoles[0]); 
  }
  meibo.setWorkflowVariable(&quot;notificationRoles&quot;, notificationRoleSet);
  
  //1ere date de d&#233;but de participation &#224; un &#233;venement (pour constituer l&apos;&#233;ch&#233;ance du workflow)    
  eventStartDate = new Date(SQL_DATE_FORMAT.parse(eventAttendeesEntry.RAS_START_DATE[0]));
  if((overallStartDate==null) || (eventStartDate &lt; overallStartDate)){
    overallStartDate = eventStartDate;
  }
}
meibo.logDebug(&quot;Date d&apos;&#233;cheance workflow mission &quot; + missionID + &quot; : &quot; + overallStartDate.toLocaleString());
meibo.setWorkflowVariable(&quot;firstEventStartDate&quot;, new WAPIDeadline(overallStartDate));

// v&#233;rifie si le participant est Directeur G&#233;n&#233;ral
var parameters_groupsMapping = getProvisioningParameters_Droit();
var /*boolean*/isDG = userHasRole(personEntry.ldapDn[0], &quot;DG&quot;, parameters_groupsMapping);
meibo.setWorkflowVariable(&quot;isDG&quot;, &quot;&quot;+ isDG);</ActualParameter>
       </ActualParameters>
      </Tool>
     </Implementation>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Automatic</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="XOR"/>
       <Split Type="XOR">
        <TransitionRefs>
         <TransitionRef Id="T1452072000756"/>
         <TransitionRef Id="T1452245070560"/>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="Initialisation"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="288"/>
      <ExtendedAttribute Name="YOffset" Value="4"/>
      <ExtendedAttribute Name="Width" Value="145"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1448472568550" Name="">
     <Description></Description>
     <Implementation>
      <Tool Id="MeiboView" Type="APPLICATION">
       <ActualParameters>
        <ActualParameter>Mission</ActualParameter>
        <ActualParameter>MissionValidate</ActualParameter>
        <ActualParameter>missionDN</ActualParameter>
       </ActualParameters>
      </Tool>
     </Implementation>
     <Performer>PROCESS.ROLE-Manager</Performer>
     <Priority>1</Priority>
      <Deadline Execution="SYNCHR">
       <DeadlineCondition>VARIABLE firstEventStartDate</DeadlineCondition>
       <ExceptionName>horsD&#233;lai1</ExceptionName>
      </Deadline>
      <Deadline Execution="ASYNCHR">
       <DeadlineCondition>DELAY 2 day</DeadlineCondition>
       <ExceptionName>rappel1</ExceptionName>
      </Deadline>
      <Deadline Execution="SYNCHR">
       <DeadlineCondition></DeadlineCondition>
       <ExceptionName>escaladeDDI</ExceptionName>
      </Deadline>
     <StartMode>Manual</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="XOR"/>
       <Split Type="XOR">
        <TransitionRefs>
         <TransitionRef Id="T1452078466709"/>
         <TransitionRef Id="T1448473268060"/>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="Validation Manager"/>
      <ExtendedAttribute Name="fr_description"  Value="Valider une mission"/>
      <ExtendedAttribute Name="XOffset" Value="332"/>
      <ExtendedAttribute Name="YOffset" Value="340"/>
      <ExtendedAttribute Name="Width" Value="185"/>
      <ExtendedAttribute Name="Height" Value="41"/>
      <ExtendedAttribute Name="State" Value="0"/>
      <ExtendedAttribute Name="Handlers" Value="HandlerList" >
<plugin en="Detect events" fr="D&#233;tection d&apos;&#233;v&#233;nements">
  <entries>
    <activity.state.Eligible>
      <action>1452522071084</action>
    </activity.state.Eligible>
  </entries>
</plugin>

      </ExtendedAttribute>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1448472625633" Name="">
     <Description></Description>
     <Implementation>
      <Tool Id="MeiboView" Type="APPLICATION">
       <ActualParameters>
        <ActualParameter>Mission</ActualParameter>
        <ActualParameter>MissionValidate</ActualParameter>
        <ActualParameter>missionDN</ActualParameter>
       </ActualParameters>
      </Tool>
     </Implementation>
     <Performer>PROCESS.ROLE_SecondLevelValidation</Performer>
     <Priority>1</Priority>
      <Deadline Execution="ASYNCHR">
       <DeadlineCondition>DELAY 2 day</DeadlineCondition>
       <ExceptionName>rappel1</ExceptionName>
      </Deadline>
     <StartMode>Manual</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="XOR"/>
       <Split Type="XOR">
        <TransitionRefs>
         <TransitionRef Id="T1448473765695"/>
         <TransitionRef Id="T1448473752360"/>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="Validation DDI"/>
      <ExtendedAttribute Name="fr_description"  Value="Valider une mission"/>
      <ExtendedAttribute Name="XOffset" Value="0"/>
      <ExtendedAttribute Name="YOffset" Value="556"/>
      <ExtendedAttribute Name="Width" Value="269"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1448472836106" Name="">
     <Description></Description>
     <Route/>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Manual</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="XOR"/>
       <Split Type="XOR">
        <TransitionRefs>
         <TransitionRef Id="T1448473616152"/>
         <TransitionRef Id="T1448472950998"/>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="route"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="320"/>
      <ExtendedAttribute Name="YOffset" Value="460"/>
      <ExtendedAttribute Name="Width" Value="120"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1448473028474" Name="">
     <Description></Description>
     <Implementation>
      <No/>
     </Implementation>
     <Performer>PROCESS.ROLE-Participant</Performer>
     <Priority>1</Priority>
      <Deadline Execution="SYNCHR">
       <DeadlineCondition>VARIABLE firstEventStartDate</DeadlineCondition>
       <ExceptionName>horsD&#233;lai</ExceptionName>
      </Deadline>
     <StartMode>Manual</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="XOR"/>
       <Split Type="XOR">
        <TransitionRefs>
         <TransitionRef Id="T1448527696302"/>
         <TransitionRef Id="T1452079411023"/>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="Compl&#232;te demande"/>
      <ExtendedAttribute Name="fr_description"  Value="Compl&#233;ter une demande de mission pour son organisation"/>
      <ExtendedAttribute Name="XOffset" Value="344"/>
      <ExtendedAttribute Name="YOffset" Value="672"/>
      <ExtendedAttribute Name="Width" Value="201"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1448473223019" Name="">
     <Description></Description>
     <Implementation>
      <Tool Id="MeiboView" Type="APPLICATION">
       <ActualParameters>
        <ActualParameter>Mission</ActualParameter>
        <ActualParameter>MissionCreate</ActualParameter>
        <ActualParameter>missionDN</ActualParameter>
       </ActualParameters>
      </Tool>
     </Implementation>
     <Performer>PROCESS.ROLE-Participant</Performer>
     <Priority>1</Priority>
      <Deadline Execution="SYNCHR">
       <DeadlineCondition>VARIABLE firstEventStartDate</DeadlineCondition>
       <ExceptionName>horsD&#233;lai</ExceptionName>
      </Deadline>
     <StartMode>Manual</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="XOR"/>
       <Split Type="XOR">
        <TransitionRefs>
         <TransitionRef Id="T1448473468781"/>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="Modifie demande"/>
      <ExtendedAttribute Name="fr_description"  Value="Modifier une demande de mission"/>
      <ExtendedAttribute Name="XOffset" Value="484"/>
      <ExtendedAttribute Name="YOffset" Value="556"/>
      <ExtendedAttribute Name="Width" Value="189"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
      <ExtendedAttribute Name="Handlers" Value="HandlerList" >
<plugin en="Detect events" fr="D&#233;tection d&apos;&#233;v&#233;nements">
  <entries>
    <activity.state.Eligible>
      <action>1452524978986</action>
    </activity.state.Eligible>
  </entries>
</plugin>

      </ExtendedAttribute>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1448473316383" Name="">
     <Description></Description>
     <Route/>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Manual</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="XOR"/>
       <Split Type="XOR">
        <TransitionRefs>
         <TransitionRef Id="T1448473472486"/>
         <TransitionRef Id="T1452260326665"/>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="d&#233;cision demandeur"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="728"/>
      <ExtendedAttribute Name="YOffset" Value="636"/>
      <ExtendedAttribute Name="Width" Value="205"/>
      <ExtendedAttribute Name="Height" Value="45"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1448527318016" Name="">
     <Description></Description>
     <Implementation>
      <SubFlow>
       <Id>1449063509239</Id>
       <Execution>SYNCHR</Execution>
       <ActualParameters>
        <ActualParameter>userDN</ActualParameter>
        <ActualParameter>isMission</ActualParameter>
       </ActualParameters>
      </SubFlow>
     </Implementation>
     <Performer></Performer>
     <Priority>1</Priority>
      <Deadline Execution="SYNCHR">
       <DeadlineCondition></DeadlineCondition>
       <ExceptionName>horsD&#233;lai</ExceptionName>
      </Deadline>
     <StartMode>Automatic</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="XOR"/>
       <Split Type="XOR">
        <TransitionRefs>
         <TransitionRef Id="T1449065800871"/>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="OrganiseDeplacement"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="652"/>
      <ExtendedAttribute Name="YOffset" Value="756"/>
      <ExtendedAttribute Name="Width" Value="205"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
      <ExtendedAttribute Name="numberSubflowToLaunch" Value="1"/>
      <ExtendedAttribute Name="fr_titleParameter"  Value="Organisation D&#233;placement mission {userDn}"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1448527724520" Name="">
     <Description></Description>
     <Implementation>
      <Tool Id="MeiboScript" Type="SCRIPT">
       <ActualParameters>
        <ActualParameter>var /*String*/ missionID = meibo.getWorkflowVariable(&quot;missionID&quot;); 
var /*String*/ ownerID = meibo.getWorkflowVariable(&quot;participantID&quot;);
var /*String*/ ownerDN = meibo.getWorkflowVariable(&quot;participantDN&quot;);

meibo.logDebug(&quot;Abandon automatique de la mission &quot; + missionID + &quot; pour &quot; + ownerDN + &quot;; le d&#233;lai est expir&#233;&quot;); 
updateMissionStatus(missionID, ownerID, &quot;CAN&quot;, &quot;Abandon automatique, d&#233;lai expir&#233;&quot;);</ActualParameter>
       </ActualParameters>
      </Tool>
     </Implementation>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Automatic</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="XOR"/>
       <Split Type="XOR">
        <TransitionRefs>
         <TransitionRef Id="T1449141870986"/>
         <TransitionRef Id="T1449136047940"/>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="Abandon Automatique"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="1644"/>
      <ExtendedAttribute Name="YOffset" Value="704"/>
      <ExtendedAttribute Name="Width" Value="189"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1448527961473" Name="">
     <Description></Description>
     <Implementation>
      <No/>
     </Implementation>
     <Performer>PROCESS.ROLE-Participant</Performer>
     <Priority>2</Priority>
      <Deadline Execution="SYNCHR">
       <DeadlineCondition></DeadlineCondition>
       <ExceptionName>horsD&#233;lai</ExceptionName>
      </Deadline>
      <Deadline Execution="ASYNCHR">
       <DeadlineCondition>VARIABLE </DeadlineCondition>
       <ExceptionName>d&#233;partProche</ExceptionName>
      </Deadline>
     <StartMode>Manual</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="XOR"/>
       <Split Type="XOR">
        <TransitionRefs>
         <TransitionRef Id="T1452592386838"/>
         <TransitionRef Id="T1448531893154"/>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="EditeOrdreDeMission"/>
      <ExtendedAttribute Name="fr_description"  Value="Editer un ordre de mission"/>
      <ExtendedAttribute Name="XOffset" Value="456"/>
      <ExtendedAttribute Name="YOffset" Value="836"/>
      <ExtendedAttribute Name="Width" Value="217"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1448531734892" Name="">
     <Description></Description>
     <Implementation>
      <No/>
     </Implementation>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Automatic</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="AND"/>
       <Split Type="AND">
        <TransitionRefs>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="notif pour annulation organisation"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="864"/>
      <ExtendedAttribute Name="YOffset" Value="916"/>
      <ExtendedAttribute Name="Width" Value="253"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1448531857602" Name="">
     <Description></Description>
     <Route/>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Manual</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="AND"/>
       <Split Type="AND">
        <TransitionRefs>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value=""/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="832"/>
      <ExtendedAttribute Name="YOffset" Value="860"/>
      <ExtendedAttribute Name="Width" Value="120"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1448536722066" Name="">
     <Description></Description>
     <Implementation>
      <No/>
     </Implementation>
     <Performer>OrganisateurVoyage</Performer>
     <Priority>1</Priority>
      <Deadline Execution="ASYNCHR">
       <DeadlineCondition>DELAY 2 day</DeadlineCondition>
       <ExceptionName>rappel1</ExceptionName>
      </Deadline>
      <Deadline Execution="ASYNCHR">
       <DeadlineCondition></DeadlineCondition>
       <ExceptionName>escalade</ExceptionName>
      </Deadline>
      <Deadline Execution="SYNCHR">
       <DeadlineCondition>VARIABLE firstEventStartDate</DeadlineCondition>
       <ExceptionName>horsDelai</ExceptionName>
      </Deadline>
     <StartMode>Manual</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="AND"/>
       <Split Type="AND">
        <TransitionRefs>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="EstimationCout"/>
      <ExtendedAttribute Name="fr_description"  Value="Estimer le co&#251;t d&apos;une mission"/>
      <ExtendedAttribute Name="XOffset" Value="824"/>
      <ExtendedAttribute Name="YOffset" Value="208"/>
      <ExtendedAttribute Name="Width" Value="161"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1448545744181" Name="">
     <Description></Description>
     <Implementation>
      <No/>
     </Implementation>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Automatic</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="AND"/>
       <Split Type="AND">
        <TransitionRefs>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="Relance"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="32"/>
      <ExtendedAttribute Name="YOffset" Value="640"/>
      <ExtendedAttribute Name="Width" Value="120"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1448545874035" Name="">
     <Description></Description>
     <Implementation>
      <No/>
     </Implementation>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Manual</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="AND"/>
       <Split Type="AND">
        <TransitionRefs>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="Relance"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="588"/>
      <ExtendedAttribute Name="YOffset" Value="348"/>
      <ExtendedAttribute Name="Width" Value="120"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1448546285917" Name="">
     <Description></Description>
     <Implementation>
      <No/>
     </Implementation>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Automatic</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="AND"/>
       <Split Type="AND">
        <TransitionRefs>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="Relance"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="1056"/>
      <ExtendedAttribute Name="YOffset" Value="208"/>
      <ExtendedAttribute Name="Width" Value="120"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1448546524800" Name="">
     <Description></Description>
     <Route/>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Manual</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="AND"/>
       <Split Type="AND">
        <TransitionRefs>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value=""/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="428"/>
      <ExtendedAttribute Name="YOffset" Value="280"/>
      <ExtendedAttribute Name="Width" Value="101"/>
      <ExtendedAttribute Name="Height" Value="37"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1448557363960" Name="">
     <Description></Description>
     <Implementation>
      <Tool Id="MeiboScript" Type="SCRIPT">
       <ActualParameters>
        <ActualParameter></ActualParameter>
       </ActualParameters>
      </Tool>
     </Implementation>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Automatic</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="AND"/>
       <Split Type="AND">
        <TransitionRefs>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="rappel D&#233;part"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="416"/>
      <ExtendedAttribute Name="YOffset" Value="924"/>
      <ExtendedAttribute Name="Width" Value="120"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1449135987735" Name="">
     <Description></Description>
     <Implementation>
      <Tool Id="MeiboScript" Type="SCRIPT">
       <ActualParameters>
        <ActualParameter>var participantDn = meibo.getWorkflowVariable(&quot;participantDN&quot;);
var missionID = meibo.getWorkflowVariable(&quot;missionID&quot;);
var user = meibo.getWorkflowVariable(&quot;participantDisplayName&quot;);

// notification
var email = meibo.getWorkflowVariable(&quot;participantEmail&quot;);
if(email==null){
  meibo.logWarn(&quot;Impossible de notifier &quot; + participantDn + &quot; car il n&apos;a pas d&apos;email&quot;);
}else{
  var /*Parameters*/ params = new Parameters();
  params.add(&quot;MAIL_HEADER&quot;, returnEmpty(getMailParameter(&quot;MAIL_HEADER&quot;)));
  params.add(&quot;MAIL_FOOTER&quot;, returnEmpty(getMailParameter(&quot;MAIL_FOOTER&quot;)));
  params.add(&quot;MAIL_LINKNAME&quot;, returnEmpty(getMailParameter(&quot;MAIL_LINKNAME&quot;)));
  params.add(&quot;MAIL_SENDER&quot;, getMailParameter(&quot;MAIL_SENDER&quot;));
  params.add(&quot;user&quot;, user);
  params.add(&quot;missionID&quot;, missionID);
  params.add(&quot;recipient&quot;, email);  
  params.add(&quot;participantDN&quot;, participantDn);  
  meibo.executePlugin(&quot;NotifyMissionCanceled&quot;,params);
}</ActualParameter>
       </ActualParameters>
      </Tool>
     </Implementation>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Automatic</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="XOR"/>
       <Split Type="XOR">
        <TransitionRefs>
         <TransitionRef Id="T1449136074946"/>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="notification"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="1248"/>
      <ExtendedAttribute Name="YOffset" Value="852"/>
      <ExtendedAttribute Name="Width" Value="133"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1449139919375" Name="">
     <Description></Description>
     <Route/>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Manual</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="XOR"/>
       <Split Type="XOR">
        <TransitionRefs>
         <TransitionRef Id="T1452078449254"/>
         <TransitionRef Id="T1449140025000"/>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value=""/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="132"/>
      <ExtendedAttribute Name="YOffset" Value="280"/>
      <ExtendedAttribute Name="Width" Value="120"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1449244633439" Name="">
     <Description></Description>
     <Implementation>
      <Tool Id="MeiboView" Type="APPLICATION">
       <ActualParameters>
        <ActualParameter>Mission</ActualParameter>
        <ActualParameter>MissionAccept</ActualParameter>
        <ActualParameter>missionDN</ActualParameter>
       </ActualParameters>
      </Tool>
     </Implementation>
     <Performer>PROCESS.ROLE-Participant</Performer>
     <Priority>1</Priority>
      <Deadline Execution="SYNCHR">
       <DeadlineCondition>VARIABLE </DeadlineCondition>
       <ExceptionName>horsD&#233;lai</ExceptionName>
      </Deadline>
      <Deadline Execution="ASYNCHR">
       <DeadlineCondition>CALENDAR_DELAY 2 day</DeadlineCondition>
       <ExceptionName>relance</ExceptionName>
      </Deadline>
     <StartMode>Manual</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="AND"/>
       <Split Type="XOR">
        <TransitionRefs>
         <TransitionRef Id="T1452072030730"/>
         <TransitionRef Id="T1452014277554"/>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="Accepter mission"/>
      <ExtendedAttribute Name="fr_description"  Value="Accepter une mission"/>
      <ExtendedAttribute Name="XOffset" Value="420"/>
      <ExtendedAttribute Name="YOffset" Value="104"/>
      <ExtendedAttribute Name="Width" Value="201"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
      <ExtendedAttribute Name="Handlers" Value="HandlerList" >
<plugin en="Detect events" fr="D&#233;tection d&apos;&#233;v&#233;nements">
  <entries>
    <activity.state.Eligible>
      <action>1452270989283</action>
    </activity.state.Eligible>
  </entries>
</plugin>

      </ExtendedAttribute>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1449244931030" Name="">
     <Description></Description>
     <Implementation>
      <No/>
     </Implementation>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Automatic</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="AND"/>
       <Split Type="AND">
        <TransitionRefs>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="Relance"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="680"/>
      <ExtendedAttribute Name="YOffset" Value="132"/>
      <ExtendedAttribute Name="Width" Value="120"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1449245333752" Name="">
     <Description></Description>
     <Implementation>
      <Tool Id="MeiboScript" Type="SCRIPT">
       <ActualParameters>
        <ActualParameter>var /*Set*/ notificationRoleSet = meibo.setWorkflowVariable(&quot;notificationRoles&quot;);
if(!notificationRoleSet.isEmpty()){
//TODO notifications DDI ou autre en fonction de notificationRoleSet
}</ActualParameter>
       </ActualParameters>
      </Tool>
     </Implementation>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Automatic</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="AND"/>
       <Split Type="AND">
        <TransitionRefs>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="Notifications"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="676"/>
      <ExtendedAttribute Name="YOffset" Value="972"/>
      <ExtendedAttribute Name="Width" Value="125"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1452014265043" Name="">
     <Description></Description>
     <Route/>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Manual</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="AND"/>
       <Split Type="AND">
        <TransitionRefs>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value=""/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="808"/>
      <ExtendedAttribute Name="YOffset" Value="328"/>
      <ExtendedAttribute Name="Width" Value="120"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1452071850125" Name="">
     <Description></Description>
     <Implementation>
      <Tool Id="MeiboScript" Type="SCRIPT">
       <ActualParameters>
        <ActualParameter>var /*String*/ missionDN = meibo.getWorkflowVariable(&quot;missionDN&quot;); 
var /*Entry*/ missionEntry = meibo.getDnEntry(&quot;Mission&quot;, missionDN);
if((missionEntry.TMN_ESTIMATED_COST[0]!=null) &amp;&amp; (missionEntry.TMN_ESTIMATED_COST[0]!=&quot;&quot;)){
  meibo.setWorkflowVariable(&quot;costDefined&quot;,&quot;true&quot;); 
}else{
  meibo.setWorkflowVariable(&quot;costDefined&quot;,&quot;false&quot;);
}</ActualParameter>
       </ActualParameters>
      </Tool>
     </Implementation>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Automatic</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="XOR"/>
       <Split Type="XOR">
        <TransitionRefs>
         <TransitionRef Id="T1452071956127"/>
         <TransitionRef Id="T1452071980389"/>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="verifieCout"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="288"/>
      <ExtendedAttribute Name="YOffset" Value="196"/>
      <ExtendedAttribute Name="Width" Value="120"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1452078418181" Name="">
     <Description></Description>
     <Route/>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Manual</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="XOR"/>
       <Split Type="AND">
        <TransitionRefs>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value=""/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="96"/>
      <ExtendedAttribute Name="YOffset" Value="400"/>
      <ExtendedAttribute Name="Width" Value="120"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1452260216937" Name="">
     <Description></Description>
     <Implementation>
      <Tool Id="MeiboScript" Type="SCRIPT">
       <ActualParameters>
        <ActualParameter>var /*String*/ missionID = meibo.getWorkflowVariable(&quot;missionID&quot;); 
var /*String*/ ownerID = meibo.getWorkflowVariable(&quot;participantID&quot;);
var /*String*/ ownerDN = meibo.getWorkflowVariable(&quot;participantDN&quot;);

meibo.logDebug(&quot;Abandon explicite de la mission &quot; + missionID + &quot; pour &quot; + ownerDN); 
updateMissionStatus(missionID, ownerID, &quot;CAN&quot;, &quot;&quot;);</ActualParameter>
       </ActualParameters>
      </Tool>
     </Implementation>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Automatic</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="XOR"/>
       <Split Type="XOR">
        <TransitionRefs>
         <TransitionRef Id="T1452260261334"/>
         <TransitionRef Id="T1452260241541"/>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="Abandon"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="1204"/>
      <ExtendedAttribute Name="YOffset" Value="788"/>
      <ExtendedAttribute Name="Width" Value="120"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
   </Activities>
   <Transitions>
    <Transition Id="T1448472522446" Name="T1448472522446" From="A1448472295866" To="A1448472369326"/>
    <Transition Id="T1448472950998" Name="T1448472950998" From="A1448472836106" To="A1448472625633">
     <Condition Type="OTHERWISE"></Condition>
    </Transition>
    <Transition Id="T1448473268060" Name="T1448473268060" From="A1448472568550" To="A1448473223019">
     <Condition Type="OTHERWISE"></Condition>
    </Transition>
    <Transition Id="T1448473468781" Name="T1448473468781" From="A1448473223019" To="A1448473316383"/>
    <Transition Id="T1448473472486" Name="T1448473472486" From="A1448473316383" To="A1448472568550">
     <Condition Type="CONDITION">missionModified==&quot;true&quot;</Condition>
    </Transition>
    <Transition Id="T1448473616152" Name="T1448473616152" From="A1448472836106" To="A1448473028474">
     <Condition Type="CONDITION">secondValidationRoles.isEmpty()</Condition>
    </Transition>
    <Transition Id="T1448473752360" Name="T1448473752360" From="A1448472625633" To="A1448473223019">
     <Condition Type="OTHERWISE"></Condition>
    </Transition>
    <Transition Id="T1448473765695" Name="T1448473765695" From="A1448472625633" To="A1448473028474">
     <Condition Type="CONDITION">secondLevelValidated==&quot;true&quot;</Condition>
    </Transition>
    <Transition Id="T1448527696302" Name="T1448527696302" From="A1448473028474" To="A1448527318016">
     <Condition Type="CONDITION">completedForOrganisation==&quot;true&quot;</Condition>
    </Transition>
    <Transition Id="T1448531893154" Name="T1448531893154" From="A1448527961473" To="A1448531857602">
     <Condition Type="OTHERWISE"></Condition>
    </Transition>
    <Transition Id="T1448531937565" Name="T1448531937565" From="A1448531857602" To="A1448531734892"/>
    <Transition Id="T1448545497555" Name="T1448545497555" From="A1448527961473" To="A1448527724520">
     <Condition Type="EXCEPTION">horsD&#233;lai</Condition>
    </Transition>
    <Transition Id="T1448545610687" Name="T1448545610687" From="A1448527318016" To="A1448527724520">
     <Condition Type="EXCEPTION">horsD&#233;lai</Condition>
    </Transition>
    <Transition Id="T1448545750717" Name="T1448545750717" From="A1448472625633" To="A1448545744181">
     <Condition Type="EXCEPTION">rappel1</Condition>
    </Transition>
    <Transition Id="T1448545879483" Name="T1448545879483" From="A1448472568550" To="A1448545874035">
     <Condition Type="EXCEPTION">rappel1</Condition>
    </Transition>
    <Transition Id="T1448546325583" Name="T1448546325583" From="A1448536722066" To="A1448546285917">
     <Condition Type="EXCEPTION">rappel1</Condition>
    </Transition>
    <Transition Id="T1448546538767" Name="T1448546538767" From="A1448536722066" To="A1448546524800">
     <Condition Type="EXCEPTION">escalade</Condition>
    </Transition>
    <Transition Id="T1449065723371" Name="T1449065723371" From="A1448527961473" To="A1448557363960">
     <Condition Type="EXCEPTION">d&#233;partProche</Condition>
    </Transition>
    <Transition Id="T1449065800871" Name="T1449065800871" From="A1448527318016" To="A1448527961473"/>
    <Transition Id="T1449136047940" Name="T1449136047940" From="A1448527724520" To="A1449135987735">
     <Condition Type="OTHERWISE"></Condition>
    </Transition>
    <Transition Id="T1449136074946" Name="T1449136074946" From="A1449135987735" To="A1448472343512"/>
    <Transition Id="T1449140025000" Name="T1449140025000" From="A1449139919375" To="A1448472568550">
     <Condition Type="OTHERWISE"></Condition>
    </Transition>
    <Transition Id="T1449140155934" Name="T1449140155934" From="A1448536722066" To="A1449139919375"/>
    <Transition Id="T1449140168470" Name="T1449140168470" From="A1448546524800" To="A1449139919375"/>
    <Transition Id="T1449141870986" Name="T1449141870986" From="A1448527724520" To="A1448472343512">
     <Condition Type="CONDITION">isDG==&quot;true&quot;</Condition>
    </Transition>
    <Transition Id="T1449244728738" Name="T1449244728738" From="A1449244633439" To="A1448527724520">
     <Condition Type="EXCEPTION">horsD&#233;lai</Condition>
    </Transition>
    <Transition Id="T1449244943062" Name="T1449244943062" From="A1449244633439" To="A1449244931030">
     <Condition Type="EXCEPTION">relance</Condition>
    </Transition>
    <Transition Id="T1452014277554" Name="T1452014277554" From="A1449244633439" To="A1452014265043">
     <Condition Type="OTHERWISE"></Condition>
    </Transition>
    <Transition Id="T1452071956127" Name="T1452071956127" From="A1452071850125" To="A1449139919375">
     <Condition Type="CONDITION">costDefined==&quot;true&quot;</Condition>
    </Transition>
    <Transition Id="T1452071980389" Name="T1452071980389" From="A1452071850125" To="A1448536722066">
     <Condition Type="OTHERWISE"></Condition>
    </Transition>
    <Transition Id="T1452072000756" Name="T1452072000756" From="A1448472369326" To="A1452071850125">
     <Condition Type="CONDITION">participantID==initiatorID</Condition>
    </Transition>
    <Transition Id="T1452072030730" Name="T1452072030730" From="A1449244633439" To="A1452071850125">
     <Condition Type="CONDITION">accepted==&quot;true&quot;</Condition>
    </Transition>
    <Transition Id="T1452078449254" Name="T1452078449254" From="A1449139919375" To="A1452078418181">
     <Condition Type="CONDITION">isDG==&quot;true&quot;</Condition>
    </Transition>
    <Transition Id="T1452078466709" Name="T1452078466709" From="A1448472568550" To="A1452078418181">
     <Condition Type="CONDITION">managerValidated==&quot;true&quot;</Condition>
    </Transition>
    <Transition Id="T1452078534818" Name="T1452078534818" From="A1452078418181" To="A1448472836106"/>
    <Transition Id="T1452079024406" Name="T1452079024406" From="A1448536722066" To="A1448527724520">
     <Condition Type="EXCEPTION">horsDelai</Condition>
    </Transition>
    <Transition Id="T1452079250689" Name="T1452079250689" From="A1448472568550" To="A1448527724520">
     <Condition Type="EXCEPTION">horsD&#233;lai1</Condition>
    </Transition>
    <Transition Id="T1452079411023" Name="T1452079411023" From="A1448473028474" To="A1448473316383">
     <Condition Type="OTHERWISE"></Condition>
    </Transition>
    <Transition Id="T1452079443088" Name="T1452079443088" From="A1448473028474" To="A1448527724520">
     <Condition Type="EXCEPTION">horsD&#233;lai</Condition>
    </Transition>
    <Transition Id="T1452079538108" Name="T1452079538108" From="A1448473223019" To="A1448527724520">
     <Condition Type="EXCEPTION">horsD&#233;lai</Condition>
    </Transition>
    <Transition Id="T1452245070560" Name="T1452245070560" From="A1448472369326" To="A1449244633439">
     <Condition Type="OTHERWISE"></Condition>
    </Transition>
    <Transition Id="T1452260241541" Name="T1452260241541" From="A1452260216937" To="A1449135987735">
     <Condition Type="OTHERWISE"></Condition>
    </Transition>
    <Transition Id="T1452260261334" Name="T1452260261334" From="A1452260216937" To="A1448472343512">
     <Condition Type="CONDITION">isDG==&quot;true&quot;</Condition>
    </Transition>
    <Transition Id="T1452260301879" Name="T1452260301879" From="A1452014265043" To="A1452260216937"/>
    <Transition Id="T1452260326665" Name="T1452260326665" From="A1448473316383" To="A1452260216937">
     <Condition Type="OTHERWISE"></Condition>
    </Transition>
    <Transition Id="T1452260346922" Name="T1452260346922" From="A1448531857602" To="A1452260216937"/>
    <Transition Id="T1452592386838" Name="T1452592386838" From="A1448527961473" To="A1449245333752">
     <Condition Type="CONDITION">finalConfirmation==&quot;true&quot;</Condition>
    </Transition>
    <Transition Id="T1452592394901" Name="T1452592394901" From="A1449245333752" To="A1448472343512"/>
    <Transition Id="T1452592675661" Name="T1452592675661" From="A1448472568550" To="A1448472836106">
     <Condition Type="EXCEPTION">escaladeDDI</Condition>
    </Transition>
   </Transitions>
  </WorkflowProcess>
  <WorkflowProcess AccessLevel="PUBLIC" Id="1448472291649" Name="Mission">
   <ProcessHeader DurationUnit="D">
    <Description>Processus Meibo</Description>
   </ProcessHeader>
   <RedefinableHeader PublicationStatus="RELEASED">
    <Author>Meibo</Author>
    <Version>3</Version>
   </RedefinableHeader>
   <ExtendedAttributes>
    <ExtendedAttribute Name="scale"  Value="100%"/>
    <ExtendedAttribute Name="role"  Value="AdminMeibo"/>
    <ExtendedAttribute Name="role"  Value="InitiateurDeplacement"/>
    <ExtendedAttribute Name="role"  Value="Studio"/>
    <ExtendedAttribute Name="role"  Value="Utilisateur"/>
    <ExtendedAttribute Name="fr_name"  Value="Mission"/>
    <ExtendedAttribute Name="fr_description"  Value=""/>
    <ExtendedAttribute Name="actionsList" Value="">
      <Action Name="Initialisation" Type="workflowScriptImplementation" ID="1448472454995">
      </Action>
      <Action Name="Notifier" Type="pluginMail-1" ID="1448472764360">
      </Action>
      <Action Name="acceptationEligible" Type="workflowScriptImplementation" ID="1452270989283">
// affectation du role
var participantDn = meibo.getWorkflowVariable(&quot;participantDN&quot;);
var /*String*/ missionID = meibo.getWorkflowVariable(&quot;missionID&quot;); 
meibo.setWorkflowVariable(&quot;ROLE-Participant&quot;, participantDn); 

var /*WapiWorkItem*/ wapiworkitem = meibo.getCurrentWorkflowTask();
meibo.logInfo(&quot;Affectation de la tache (&quot; + wapiworkitem.getId() + &quot;) d&apos;acceptation de mission &quot; + missionID + &quot; &#224; &quot; + participantDn);

// notification
var email = meibo.getWorkflowVariable(&quot;participantEmail&quot;);
if(email==null){
  meibo.logWarn(&quot;Impossible de notifier &quot; + participantDn + &quot; car il n&apos;a pas d&apos;email&quot;);
}else{
  var /*Parameters*/ params = new Parameters();
  params.add(&quot;MAIL_HEADER&quot;, returnEmpty(getMailParameter(&quot;MAIL_HEADER&quot;)));
  params.add(&quot;MAIL_FOOTER&quot;, returnEmpty(getMailParameter(&quot;MAIL_FOOTER&quot;)));
  params.add(&quot;MAIL_LINKNAME&quot;, returnEmpty(getMailParameter(&quot;MAIL_LINKNAME&quot;)));
  params.add(&quot;MAIL_SENDER&quot;, getMailParameter(&quot;MAIL_SENDER&quot;));
  //params.add(&quot;participantDN&quot;, meibo.getWorkflowVariable(&quot;participantDN&quot;));
  params.add(&quot;recipient&quot;, email);
  meibo.executePlugin(&quot;NotifyParticipantForAcceptation&quot;,params);
}
      </Action>
      <Action Name="managerValidationEligible" Type="workflowScriptImplementation" ID="1452522071084">
///$debug
var /*String*/ participantDn = meibo.getWorkflowVariable(&quot;participantDN&quot;);
var /*String*/ missionID = meibo.getWorkflowVariable(&quot;missionID&quot;); 
var /*String*/ user = meibo.getWorkflowVariable(&quot;participantDisplayName&quot;);

var /*ResultSet*/ managerRs = getManager(participantDn);
var /*WapiWorkItem*/ wapiworkitem = meibo.getCurrentWorkflowTask();
meibo.logDebug(&quot;getCurrentWorkflowTask : &quot; + wapiworkitem);
var /*UserTask*/ userTask = meibo.getWorkflowUserTask()
meibo.logDebug(&quot;getWorkflowUserTask : &quot; + userTask);

if(managerRs.getEntryCount()&gt;0){
  // affectation du role
  var /*Entry*/ managerEntry = managerRs.getEntry();
  meibo.setWorkflowVariable(&quot;ROLE-Manager&quot;, managerEntry.dn[0]); 
  meibo.logInfo(&quot;Affectation de la tache (&quot; + wapiworkitem.getId() + &quot;) de validation de la mission &quot; + missionID + &quot; &#224; &quot; + managerEntry.dn[0] + &quot; pour &quot; + participantDn);

  // notification
  var email = meibo.getWorkflowVariable(&quot;participantEmail&quot;);
  if(email==null){
    meibo.logWarn(&quot;Impossible de notifier &quot; + participantDn + &quot; car il n&apos;a pas d&apos;email&quot;);
  }else{
    var /*Parameters*/ params = new Parameters();
    params.add(&quot;MAIL_HEADER&quot;, returnEmpty(getMailParameter(&quot;MAIL_HEADER&quot;)));
    params.add(&quot;MAIL_FOOTER&quot;, returnEmpty(getMailParameter(&quot;MAIL_FOOTER&quot;)));
    params.add(&quot;MAIL_LINKNAME&quot;, returnEmpty(getMailParameter(&quot;MAIL_LINKNAME&quot;)));
    params.add(&quot;MAIL_SENDER&quot;, getMailParameter(&quot;MAIL_SENDER&quot;));
    params.add(&quot;user&quot;, user);
    params.add(&quot;missionID&quot;, missionID);
    params.add(&quot;recipient&quot;, email);
    params.add(&quot;participantDN&quot;, participantDn);
    
    meibo.executePlugin(&quot;NotifyForValidation&quot;,params);
  }
}else{
  meibo.logWarn(&quot;Pas de manager trouv&#233; pour &quot; + participantDn);
  //TODO : voire comment traiter; par d&#233;faut le workflow resterait bloqu&#233;
  wapiworkitem.complete();
}
      </Action>
      <Action Name="modificationEligible" Type="workflowScriptImplementation" ID="1452524978986">
// affectation du role
var participantDn = meibo.getWorkflowVariable(&quot;participantDN&quot;);
var /*String*/ missionID = meibo.getWorkflowVariable(&quot;missionID&quot;); 
var /*String*/ reason = meibo.getWorkflowVariable(&quot;comment&quot;); 
meibo.setWorkflowVariable(&quot;ROLE-Participant&quot;, participantDn); 

var /*WapiWorkItem*/ wapiworkitem = meibo.getCurrentWorkflowTask();
meibo.logInfo(&quot;Affectation de la tache (&quot; + wapiworkitem.getId() + &quot;) de modification de mission &quot; + missionID + &quot; &#224; &quot; + participantDn);

// notification
var email = meibo.getWorkflowVariable(&quot;participantEmail&quot;);
if(email==null){
  meibo.logWarn(&quot;Impossible de notifier &quot; + participantDn + &quot; car il n&apos;a pas d&apos;email&quot;);
}else{
  var /*Parameters*/ params = new Parameters();
  params.add(&quot;MAIL_HEADER&quot;, returnEmpty(getMailParameter(&quot;MAIL_HEADER&quot;)));
  params.add(&quot;MAIL_FOOTER&quot;, returnEmpty(getMailParameter(&quot;MAIL_FOOTER&quot;)));
  params.add(&quot;MAIL_LINKNAME&quot;, returnEmpty(getMailParameter(&quot;MAIL_LINKNAME&quot;)));
  params.add(&quot;MAIL_SENDER&quot;, getMailParameter(&quot;MAIL_SENDER&quot;));
  params.add(&quot;recipient&quot;, email);
  params.add(&quot;reason&quot;, reason);
  meibo.executePlugin(&quot;NotifyRejection&quot;,params);
}
      </Action>
      <Action Name="secondLevelValidationEligible" Type="workflowScriptImplementation" ID="1452593973817">
var /*Set*/ validationRoleSet = meibo.setWorkflowVariable(&quot;secondValidationRoles&quot;); 
var /*Array*/ validationRoleArray = new Array(validationRoleSet.toArray());
meibo.setWorkflowVariable(&quot;ROLE_SecondLevelValidation&quot;, validationRoleArray);

var /*WapiWorkItem*/ wapiworkitem = meibo.getCurrentWorkflowTask();
meibo.logDebug(&quot;getCurrentWorkflowTask : &quot; + wapiworkitem);
var /*UserTask*/ userTask = meibo.getWorkflowUserTask()
meibo.logDebug(&quot;getWorkflowUserTask : &quot; + userTask);

meibo.logInfo(&quot;Affectation de la tache (&quot; + wapiworkitem.getId() + &quot;) de validation de la mission &quot; + missionID + &quot; &#224; &quot; + validationRoleArray + &quot; pour &quot; + participantDn);

if(!validationRoleSet.isEmpty()){

  // notification
  var email = meibo.getWorkflowVariable(&quot;participantEmail&quot;);
  //TODO recherche emails correspondant aux roles
  var targetUsers = getRecursiveGroupMembersFromGroupNames(validationRoleArray);
  if(targetUsers.isEmpty()){
    meibo.logWarn(&quot;Aucun utilisateur trouv&#233; avec les roles &quot; + validationRoleArray + &quot; pour validation de second niveau&quot;);
  }else{
    var secondLevelValidationPeople = new Array(targetUsers.toArray());
    meibo.setWorkflowVariable(&quot;secondLevelValidationPeople&quot;, secondLevelValidationPeople);

    var /*Parameters*/ params = new Parameters();
    params.add(&quot;MAIL_HEADER&quot;, returnEmpty(getMailParameter(&quot;MAIL_HEADER&quot;)));
    params.add(&quot;MAIL_FOOTER&quot;, returnEmpty(getMailParameter(&quot;MAIL_FOOTER&quot;)));
    params.add(&quot;MAIL_LINKNAME&quot;, returnEmpty(getMailParameter(&quot;MAIL_LINKNAME&quot;)));
    params.add(&quot;MAIL_SENDER&quot;, getMailParameter(&quot;MAIL_SENDER&quot;));
    params.add(&quot;user&quot;, user);
    params.add(&quot;missionID&quot;, missionID);
    params.add(&quot;recipient&quot;, email);
    params.add(&quot;participantDN&quot;, participantDn);
    
    meibo.executePlugin(&quot;NotifyForSecondLevelValidation&quot;,params);
  }
}else{
  // normalement &#231;a ne devrait pas arriver quand on passe par ici
  meibo.logDebug(&quot;Pas de role d&#233;fini pour validation de 2nd niveau&quot;);
  wapiworkitem.complete();
}
      </Action>
    </ExtendedAttribute>
   </ExtendedAttributes>
   <DataFields>
    <DataField Id="ROLE-Manager" IsArray="FALSE">
     <DataType>
      <BasicType Type="PERFORMER"/>
     </DataType>
     <InitialValue>0</InitialValue>
    </DataField>
    <DataField Id="ROLE-Initiateur" IsArray="FALSE">
     <DataType>
      <BasicType Type="PERFORMER"/>
     </DataType>
     <InitialValue>0</InitialValue>
    </DataField>
    <DataField Id="ROLE-Participant" IsArray="FALSE">
     <DataType>
      <BasicType Type="PERFORMER"/>
     </DataType>
     <InitialValue>0</InitialValue>
    </DataField>
    <DataField Id="missionDN" IsArray="FALSE">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </DataField>
    <DataField Id="accepted" IsArray="FALSE">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
     <InitialValue>false</InitialValue>
    </DataField>
    <DataField Id="costDefined" IsArray="FALSE">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
     <InitialValue>false</InitialValue>
    </DataField>
    <DataField Id="firstEventStartDate" IsArray="FALSE">
     <DataType>
      <BasicType Type="DEADLINE"/>
     </DataType>
     <InitialValue>01/01/16 10:24</InitialValue>
    </DataField>
    <DataField Id="MAIL_HEADER" IsArray="FALSE">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </DataField>
    <DataField Id="MAIL_FOOTER" IsArray="FALSE">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </DataField>
    <DataField Id="MAIL_SENDER" IsArray="FALSE">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </DataField>
    <DataField Id="participantCn" IsArray="FALSE">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </DataField>
    <DataField Id="participantEmail" IsArray="FALSE">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </DataField>
    <DataField Id="isDG" IsArray="FALSE">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
     <InitialValue>false</InitialValue>
    </DataField>
    <DataField Id="managerValidated" IsArray="FALSE">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
     <InitialValue>false</InitialValue>
    </DataField>
    <DataField Id="DDIvalidationRequired" IsArray="FALSE">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
     <InitialValue>true</InitialValue>
    </DataField>
    <DataField Id="notificationRoles" IsArray="FALSE">
     <DataType>
      <BasicType Type="OBJECT"/>
     </DataType>
    </DataField>
    <DataField Id="secondValidationRoles" IsArray="FALSE">
     <DataType>
      <BasicType Type="OBJECT"/>
     </DataType>
    </DataField>
    <DataField Id="finalConfirmation" IsArray="FALSE">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
     <InitialValue>false</InitialValue>
    </DataField>
    <DataField Id="completedForOrganisation" IsArray="FALSE">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
     <InitialValue>false</InitialValue>
    </DataField>
    <DataField Id="secondLevelValidated" IsArray="FALSE">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
     <InitialValue>false</InitialValue>
    </DataField>
    <DataField Id="missionModified" IsArray="FALSE">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
     <InitialValue>false</InitialValue>
    </DataField>
    <DataField Id="ROLE_SecondLevelValidation" IsArray="FALSE">
     <DataType>
      <BasicType Type="PERFORMER"/>
     </DataType>
    </DataField>
    <DataField Id="secondLevelValidationPeople" IsArray="TRUE">
     <DataType>
      <BasicType Type="OBJECT"/>
     </DataType>
    </DataField>
   </DataFields>
   <FormalParameters>
    <FormalParameter Id="participantDN" Index="23" Mode="IN">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="missionID" Index="24" Mode="IN">
     <DataType>
      <BasicType Type="INTEGER"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="initiatorDN" Index="25" Mode="IN">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="initiatorID" Index="26" Mode="IN">
     <DataType>
      <BasicType Type="INTEGER"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="participantID" Index="27" Mode="IN">
     <DataType>
      <BasicType Type="INTEGER"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="baseURL" Index="28" Mode="IN">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="comment" Index="29" Mode="INOUT">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </FormalParameter>
   </FormalParameters>
   <Participants>
    <Participant Id="AdminMeibo" Name="AdminMeibo">
     <ParticipantType Type="ROLE"/>
    </Participant>
    <Participant Id="AnalyseurDeplacement" Name="AnalyseurDeplacement">
     <ParticipantType Type="ROLE"/>
    </Participant>
    <Participant Id="DDI" Name="DDI">
     <ParticipantType Type="ROLE"/>
    </Participant>
    <Participant Id="InitiateurDeplacement" Name="InitiateurDeplacement">
     <ParticipantType Type="ROLE"/>
    </Participant>
    <Participant Id="OrganisateurVoyage" Name="OrganisateurVoyage">
     <ParticipantType Type="ROLE"/>
    </Participant>
    <Participant Id="Studio" Name="Studio">
     <ParticipantType Type="ROLE"/>
    </Participant>
    <Participant Id="Utilisateur" Name="Utilisateur">
     <ParticipantType Type="ROLE"/>
    </Participant>
   </Participants>
   <Activities>
    <Activity Id="A1448472295866" Name="">
     <Description></Description>
     <Route/>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Manual</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="AND"/>
       <Split Type="XOR">
        <TransitionRefs>
         <TransitionRef Id="T1448472522446"/>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="D&#233;but"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="96"/>
      <ExtendedAttribute Name="YOffset" Value="4"/>
      <ExtendedAttribute Name="Width" Value="120"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1448472343512" Name="">
     <Description></Description>
     <Route/>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Manual</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="XOR"/>
       <Split Type="AND">
        <TransitionRefs>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="Fin"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="992"/>
      <ExtendedAttribute Name="YOffset" Value="1024"/>
      <ExtendedAttribute Name="Width" Value="120"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1448472369326" Name="">
     <Description></Description>
     <Implementation>
      <Tool Id="MeiboScript" Type="SCRIPT">
       <ActualParameters>
        <ActualParameter>//$debug
var /*String*/ missionID = meibo.getWorkflowVariable(&quot;missionID&quot;); 
var /*String*/ missionDN = &quot;T_MISSION_TMN,TMN_ID,&quot; + missionID; 
meibo.setWorkflowVariable(&quot;missionDN&quot;, missionDN);
var /*String*/ ownerID = meibo.getWorkflowVariable(&quot;participantID&quot;);

meibo.setWorkflowVariable(&quot;MAIL_HEADER&quot;, returnEmpty(getMailParameter(&quot;MAIL_HEADER&quot;)));
meibo.setWorkflowVariable(&quot;MAIL_FOOTER&quot;, returnEmpty(getMailParameter(&quot;MAIL_FOOTER&quot;)));
meibo.setWorkflowVariable(&quot;MAIL_LINKNAME&quot;, returnEmpty(getMailParameter(&quot;MAIL_LINKNAME&quot;)));
meibo.setWorkflowVariable(&quot;MAIL_SENDER&quot;, getMailParameter(&quot;MAIL_SENDER&quot;));

var /*String*/ particpantLdapDN = null;
var /*Entry*/ personEntry = meibo.getDnEntry(&quot;TravelPeople&quot;,&quot;T_PERSON_PRS,PRS_ID,&quot; + ownerID, &quot;mail,ldapDn,PRS_LOGIN,displayName&quot;);
var participantEmail = personEntry.mail[0];
if((participantEmail==null) || (participantEmail==&quot;&quot;)){
  meibo.logWarn(&quot;Le participant &quot; + ownerID + &quot; n&apos;a pas d&apos;adresse email&quot;);
}else{
  meibo.setWorkflowVariable(&quot;participantEmail&quot;, participantEmail);
}
meibo.setWorkflowVariable(&quot;participantDN&quot;, personEntry.ldapDn[0]);
meibo.setWorkflowVariable(&quot;participantCn&quot;, personEntry.PRS_LOGIN[0]);
meibo.setWorkflowVariable(&quot;participantDisplayName&quot;, personEntry.displayName[0]);

var wfVariables = meibo.getWorkflowVariables(); // utile seulement en debug

meibo.logDebug(&quot;Initialisation workflow mission &quot; + missionID + &quot; pour &quot; + ownerID);

var /*Entry*/ missionEntry = meibo.getDnEntry(&quot;Mission&quot;, missionDN);

// recherche les caract&#233;ristiques des participications aux &#233;v&#232;nements :
// - 1ere date de d&#233;but de participation &#224; un &#233;venement (pour constituer l&apos;&#233;ch&#233;ance du workflow)
// - roles pour les validations et notifications en fonction de ces &#233;venements et participations
var /*ResultSet*/ missionEventRS = meibo.executeLink(&quot;MissionEvent&quot;, missionDN,&quot;fkTCT_ID,fkTES_ID,fkTTY_ID&quot;);
var /*ResultSet*/ eventAttendeesRS = null;
var /*Entry*/ eventAttendeesEntry = null;
var missionId=null;
var /*Date*/ eventStartDate = null;
var /*Date*/ overallStartDate = null;
var scopeID = null;
var evtTypeID = null;
var purposeID = null;
var involvementID = null;
var /*ResultSet*/ validationRoleRS = null;
var /*Entry*/ validationRoleEntry = null;
var /*Set*/ validationRoleSet = new java.util.HashSet();
var /*ResultSet*/ notificationRoleRS = null;
var /*Entry*/ notificationRoleEntry = null;
var /*Set*/ notificationRoleSet = new java.util.HashSet();

for each(var missionEvent in missionEventRS){
  missionId = missionEvent.fkTCT_ID[0] 
  eventAttendeesRS = meibo.executeResource(&quot;R_Attendees&quot;,&quot;PRS_ID=&quot;+ ownerID + &quot; AND TCT_ID=&quot;+missionId ,1,&quot;RAS_START_DATE,TPE_ID,TIN_ID&quot;);
  eventAttendeesEntry = eventAttendeesRS.getEntry();
  
  scopeID = missionEvent.fkTES_ID[0];
  evtTypeID = missionEvent.fkTTY_ID[0];
  purposeID = eventAttendeesEntry.TPE_ID[0];
  involvementID = eventAttendeesEntry.TIN_ID[0];

  // recherche des roles pour la 2eme validation (validation &quot;DDI&quot;)  
  validationRoleRS = meibo.executeSqlRequest(&quot;TRAVEL_BCOM&quot;,&quot;call get_travel_validation_roles(&apos;&quot;+ scopeID + &quot;&apos;,&apos;&quot; + evtTypeID + &quot;&apos;,&apos;&quot; + purposeID + &quot;&apos;,&apos;&quot; + involvementID + &quot;&apos;)&quot;,0); 
  for each(var validationRoleEntry in validationRoleRS){
    meibo.logDebug(&quot;ValidationRole : &quot; + validationRoleEntry);
    validationRoleSet.add(validationRoleEntry.ValidationRoles[0]);
  }
  meibo.setWorkflowVariable(&quot;secondValidationRoles&quot;, validationRoleSet);
  
  // recherche des roles pour la natification sans validation (notification &quot;DDI&quot;)  
  notificationRoleRS = meibo.executeSqlRequest(&quot;TRAVEL_BCOM&quot;,&quot;call get_travel_notified_roles(&apos;&quot;+ scopeID + &quot;&apos;,&apos;&quot; + evtTypeID + &quot;&apos;,&apos;&quot; + purposeID + &quot;&apos;,&apos;&quot; + involvementID + &quot;&apos;)&quot;,0); 
  for each(var notificationRoleEntry in notificationRoleRS){
    meibo.logDebug(&quot;ValidationRole : &quot; + notificationRoleEntry);   
    notificationRoleSet.add(notificationRoleEntry.ValidationRoles[0]); 
  }
  meibo.setWorkflowVariable(&quot;notificationRoles&quot;, notificationRoleSet);
  
  //1ere date de d&#233;but de participation &#224; un &#233;venement (pour constituer l&apos;&#233;ch&#233;ance du workflow)    
  eventStartDate = new Date(SQL_DATE_FORMAT.parse(eventAttendeesEntry.RAS_START_DATE[0]));
  if((overallStartDate==null) || (eventStartDate &lt; overallStartDate)){
    overallStartDate = eventStartDate;
  }
}
meibo.logDebug(&quot;Date d&apos;&#233;cheance workflow mission &quot; + missionID + &quot; : &quot; + overallStartDate.toLocaleString());
meibo.setWorkflowVariable(&quot;firstEventStartDate&quot;, new WAPIDeadline(overallStartDate));

// v&#233;rifie si le participant est Directeur G&#233;n&#233;ral
var parameters_groupsMapping = getProvisioningParameters_Droit();
var /*boolean*/isDG = userHasRole(personEntry.ldapDn[0], &quot;DG&quot;, parameters_groupsMapping);
meibo.setWorkflowVariable(&quot;isDG&quot;, &quot;&quot;+ isDG);</ActualParameter>
       </ActualParameters>
      </Tool>
     </Implementation>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Automatic</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="XOR"/>
       <Split Type="XOR">
        <TransitionRefs>
         <TransitionRef Id="T1452072000756"/>
         <TransitionRef Id="T1452245070560"/>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="Initialisation"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="288"/>
      <ExtendedAttribute Name="YOffset" Value="4"/>
      <ExtendedAttribute Name="Width" Value="145"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1448472568550" Name="">
     <Description></Description>
     <Implementation>
      <Tool Id="MeiboView" Type="APPLICATION">
       <ActualParameters>
        <ActualParameter>Mission</ActualParameter>
        <ActualParameter>MissionValidate</ActualParameter>
        <ActualParameter>missionDN</ActualParameter>
       </ActualParameters>
      </Tool>
     </Implementation>
     <Performer>PROCESS.ROLE-Manager</Performer>
     <Priority>1</Priority>
      <Deadline Execution="SYNCHR">
       <DeadlineCondition>VARIABLE firstEventStartDate</DeadlineCondition>
       <ExceptionName>horsD&#233;lai1</ExceptionName>
      </Deadline>
      <Deadline Execution="ASYNCHR">
       <DeadlineCondition>DELAY 2 day</DeadlineCondition>
       <ExceptionName>rappel1</ExceptionName>
      </Deadline>
      <Deadline Execution="SYNCHR">
       <DeadlineCondition></DeadlineCondition>
       <ExceptionName>escaladeDDI</ExceptionName>
      </Deadline>
     <StartMode>Manual</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="XOR"/>
       <Split Type="XOR">
        <TransitionRefs>
         <TransitionRef Id="T1452078466709"/>
         <TransitionRef Id="T1448473268060"/>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="Validation Manager"/>
      <ExtendedAttribute Name="fr_description"  Value="Valider une mission"/>
      <ExtendedAttribute Name="XOffset" Value="332"/>
      <ExtendedAttribute Name="YOffset" Value="340"/>
      <ExtendedAttribute Name="Width" Value="185"/>
      <ExtendedAttribute Name="Height" Value="41"/>
      <ExtendedAttribute Name="State" Value="0"/>
      <ExtendedAttribute Name="Handlers" Value="HandlerList" >
<plugin en="Detect events" fr="D&#233;tection d&apos;&#233;v&#233;nements">
  <entries>
    <activity.state.Eligible>
      <action>1452522071084</action>
    </activity.state.Eligible>
  </entries>
</plugin>

      </ExtendedAttribute>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1448472625633" Name="">
     <Description></Description>
     <Implementation>
      <Tool Id="MeiboView" Type="APPLICATION">
       <ActualParameters>
        <ActualParameter>Mission</ActualParameter>
        <ActualParameter>MissionValidate</ActualParameter>
        <ActualParameter>missionDN</ActualParameter>
       </ActualParameters>
      </Tool>
     </Implementation>
     <Performer>PROCESS.ROLE_SecondLevelValidation</Performer>
     <Priority>1</Priority>
      <Deadline Execution="ASYNCHR">
       <DeadlineCondition>DELAY 2 day</DeadlineCondition>
       <ExceptionName>rappel1</ExceptionName>
      </Deadline>
     <StartMode>Manual</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="XOR"/>
       <Split Type="XOR">
        <TransitionRefs>
         <TransitionRef Id="T1448473765695"/>
         <TransitionRef Id="T1448473752360"/>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="Validation DDI"/>
      <ExtendedAttribute Name="fr_description"  Value="Valider une mission"/>
      <ExtendedAttribute Name="XOffset" Value="0"/>
      <ExtendedAttribute Name="YOffset" Value="556"/>
      <ExtendedAttribute Name="Width" Value="269"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1448472836106" Name="">
     <Description></Description>
     <Route/>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Manual</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="XOR"/>
       <Split Type="XOR">
        <TransitionRefs>
         <TransitionRef Id="T1448473616152"/>
         <TransitionRef Id="T1448472950998"/>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="route"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="320"/>
      <ExtendedAttribute Name="YOffset" Value="460"/>
      <ExtendedAttribute Name="Width" Value="120"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1448473028474" Name="">
     <Description></Description>
     <Implementation>
      <No/>
     </Implementation>
     <Performer>PROCESS.ROLE-Participant</Performer>
     <Priority>1</Priority>
      <Deadline Execution="SYNCHR">
       <DeadlineCondition>VARIABLE firstEventStartDate</DeadlineCondition>
       <ExceptionName>horsD&#233;lai</ExceptionName>
      </Deadline>
     <StartMode>Manual</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="XOR"/>
       <Split Type="XOR">
        <TransitionRefs>
         <TransitionRef Id="T1448527696302"/>
         <TransitionRef Id="T1452079411023"/>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="Compl&#232;te demande"/>
      <ExtendedAttribute Name="fr_description"  Value="Compl&#233;ter une demande de mission pour son organisation"/>
      <ExtendedAttribute Name="XOffset" Value="344"/>
      <ExtendedAttribute Name="YOffset" Value="672"/>
      <ExtendedAttribute Name="Width" Value="201"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1448473223019" Name="">
     <Description></Description>
     <Implementation>
      <Tool Id="MeiboView" Type="APPLICATION">
       <ActualParameters>
        <ActualParameter>Mission</ActualParameter>
        <ActualParameter>MissionCreate</ActualParameter>
        <ActualParameter>missionDN</ActualParameter>
       </ActualParameters>
      </Tool>
     </Implementation>
     <Performer>PROCESS.ROLE-Participant</Performer>
     <Priority>1</Priority>
      <Deadline Execution="SYNCHR">
       <DeadlineCondition>VARIABLE firstEventStartDate</DeadlineCondition>
       <ExceptionName>horsD&#233;lai</ExceptionName>
      </Deadline>
     <StartMode>Manual</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="XOR"/>
       <Split Type="XOR">
        <TransitionRefs>
         <TransitionRef Id="T1448473468781"/>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="Modifie demande"/>
      <ExtendedAttribute Name="fr_description"  Value="Modifier une demande de mission"/>
      <ExtendedAttribute Name="XOffset" Value="484"/>
      <ExtendedAttribute Name="YOffset" Value="556"/>
      <ExtendedAttribute Name="Width" Value="189"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
      <ExtendedAttribute Name="Handlers" Value="HandlerList" >
<plugin en="Detect events" fr="D&#233;tection d&apos;&#233;v&#233;nements">
  <entries>
    <activity.state.Eligible>
      <action>1452524978986</action>
    </activity.state.Eligible>
  </entries>
</plugin>

      </ExtendedAttribute>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1448473316383" Name="">
     <Description></Description>
     <Route/>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Manual</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="XOR"/>
       <Split Type="XOR">
        <TransitionRefs>
         <TransitionRef Id="T1448473472486"/>
         <TransitionRef Id="T1452260326665"/>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="d&#233;cision demandeur"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="728"/>
      <ExtendedAttribute Name="YOffset" Value="636"/>
      <ExtendedAttribute Name="Width" Value="205"/>
      <ExtendedAttribute Name="Height" Value="45"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1448527318016" Name="">
     <Description></Description>
     <Implementation>
      <SubFlow>
       <Id>1449063509239</Id>
       <Execution>SYNCHR</Execution>
       <ActualParameters>
        <ActualParameter>userDN</ActualParameter>
        <ActualParameter>isMission</ActualParameter>
       </ActualParameters>
      </SubFlow>
     </Implementation>
     <Performer></Performer>
     <Priority>1</Priority>
      <Deadline Execution="SYNCHR">
       <DeadlineCondition></DeadlineCondition>
       <ExceptionName>horsD&#233;lai</ExceptionName>
      </Deadline>
     <StartMode>Automatic</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="XOR"/>
       <Split Type="XOR">
        <TransitionRefs>
         <TransitionRef Id="T1449065800871"/>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="OrganiseDeplacement"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="652"/>
      <ExtendedAttribute Name="YOffset" Value="756"/>
      <ExtendedAttribute Name="Width" Value="205"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
      <ExtendedAttribute Name="numberSubflowToLaunch" Value="1"/>
      <ExtendedAttribute Name="fr_titleParameter"  Value="Organisation D&#233;placement mission {userDn}"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1448527724520" Name="">
     <Description></Description>
     <Implementation>
      <Tool Id="MeiboScript" Type="SCRIPT">
       <ActualParameters>
        <ActualParameter>var /*String*/ missionID = meibo.getWorkflowVariable(&quot;missionID&quot;); 
var /*String*/ ownerID = meibo.getWorkflowVariable(&quot;participantID&quot;);
var /*String*/ ownerDN = meibo.getWorkflowVariable(&quot;participantDN&quot;);

meibo.logDebug(&quot;Abandon automatique de la mission &quot; + missionID + &quot; pour &quot; + ownerDN + &quot;; le d&#233;lai est expir&#233;&quot;); 
updateMissionStatus(missionID, ownerID, &quot;CAN&quot;, &quot;Abandon automatique, d&#233;lai expir&#233;&quot;);</ActualParameter>
       </ActualParameters>
      </Tool>
     </Implementation>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Automatic</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="XOR"/>
       <Split Type="XOR">
        <TransitionRefs>
         <TransitionRef Id="T1449141870986"/>
         <TransitionRef Id="T1449136047940"/>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="Abandon Automatique"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="1644"/>
      <ExtendedAttribute Name="YOffset" Value="704"/>
      <ExtendedAttribute Name="Width" Value="189"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1448527961473" Name="">
     <Description></Description>
     <Implementation>
      <No/>
     </Implementation>
     <Performer>PROCESS.ROLE-Participant</Performer>
     <Priority>2</Priority>
      <Deadline Execution="SYNCHR">
       <DeadlineCondition></DeadlineCondition>
       <ExceptionName>horsD&#233;lai</ExceptionName>
      </Deadline>
      <Deadline Execution="ASYNCHR">
       <DeadlineCondition>VARIABLE </DeadlineCondition>
       <ExceptionName>d&#233;partProche</ExceptionName>
      </Deadline>
     <StartMode>Manual</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="XOR"/>
       <Split Type="XOR">
        <TransitionRefs>
         <TransitionRef Id="T1452592386838"/>
         <TransitionRef Id="T1448531893154"/>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="EditeOrdreDeMission"/>
      <ExtendedAttribute Name="fr_description"  Value="Editer un ordre de mission"/>
      <ExtendedAttribute Name="XOffset" Value="456"/>
      <ExtendedAttribute Name="YOffset" Value="836"/>
      <ExtendedAttribute Name="Width" Value="217"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1448531734892" Name="">
     <Description></Description>
     <Implementation>
      <No/>
     </Implementation>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Automatic</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="AND"/>
       <Split Type="AND">
        <TransitionRefs>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="notif pour annulation organisation"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="864"/>
      <ExtendedAttribute Name="YOffset" Value="916"/>
      <ExtendedAttribute Name="Width" Value="253"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1448531857602" Name="">
     <Description></Description>
     <Route/>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Manual</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="AND"/>
       <Split Type="AND">
        <TransitionRefs>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value=""/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="832"/>
      <ExtendedAttribute Name="YOffset" Value="860"/>
      <ExtendedAttribute Name="Width" Value="120"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1448536722066" Name="">
     <Description></Description>
     <Implementation>
      <No/>
     </Implementation>
     <Performer>OrganisateurVoyage</Performer>
     <Priority>1</Priority>
      <Deadline Execution="ASYNCHR">
       <DeadlineCondition>DELAY 2 day</DeadlineCondition>
       <ExceptionName>rappel1</ExceptionName>
      </Deadline>
      <Deadline Execution="ASYNCHR">
       <DeadlineCondition></DeadlineCondition>
       <ExceptionName>escalade</ExceptionName>
      </Deadline>
      <Deadline Execution="SYNCHR">
       <DeadlineCondition>VARIABLE firstEventStartDate</DeadlineCondition>
       <ExceptionName>horsDelai</ExceptionName>
      </Deadline>
     <StartMode>Manual</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="AND"/>
       <Split Type="AND">
        <TransitionRefs>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="EstimationCout"/>
      <ExtendedAttribute Name="fr_description"  Value="Estimer le co&#251;t d&apos;une mission"/>
      <ExtendedAttribute Name="XOffset" Value="824"/>
      <ExtendedAttribute Name="YOffset" Value="208"/>
      <ExtendedAttribute Name="Width" Value="161"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1448545744181" Name="">
     <Description></Description>
     <Implementation>
      <No/>
     </Implementation>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Automatic</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="AND"/>
       <Split Type="AND">
        <TransitionRefs>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="Relance"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="32"/>
      <ExtendedAttribute Name="YOffset" Value="640"/>
      <ExtendedAttribute Name="Width" Value="120"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1448545874035" Name="">
     <Description></Description>
     <Implementation>
      <No/>
     </Implementation>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Manual</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="AND"/>
       <Split Type="AND">
        <TransitionRefs>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="Relance"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="588"/>
      <ExtendedAttribute Name="YOffset" Value="348"/>
      <ExtendedAttribute Name="Width" Value="120"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1448546285917" Name="">
     <Description></Description>
     <Implementation>
      <No/>
     </Implementation>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Automatic</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="AND"/>
       <Split Type="AND">
        <TransitionRefs>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="Relance"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="1056"/>
      <ExtendedAttribute Name="YOffset" Value="208"/>
      <ExtendedAttribute Name="Width" Value="120"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1448546524800" Name="">
     <Description></Description>
     <Route/>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Manual</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="AND"/>
       <Split Type="AND">
        <TransitionRefs>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value=""/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="428"/>
      <ExtendedAttribute Name="YOffset" Value="280"/>
      <ExtendedAttribute Name="Width" Value="101"/>
      <ExtendedAttribute Name="Height" Value="37"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1448557363960" Name="">
     <Description></Description>
     <Implementation>
      <Tool Id="MeiboScript" Type="SCRIPT">
       <ActualParameters>
        <ActualParameter></ActualParameter>
       </ActualParameters>
      </Tool>
     </Implementation>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Automatic</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="AND"/>
       <Split Type="AND">
        <TransitionRefs>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="rappel D&#233;part"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="416"/>
      <ExtendedAttribute Name="YOffset" Value="924"/>
      <ExtendedAttribute Name="Width" Value="120"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1449135987735" Name="">
     <Description></Description>
     <Implementation>
      <Tool Id="MeiboScript" Type="SCRIPT">
       <ActualParameters>
        <ActualParameter>var participantDn = meibo.getWorkflowVariable(&quot;participantDN&quot;);
var missionID = meibo.getWorkflowVariable(&quot;missionID&quot;);
var user = meibo.getWorkflowVariable(&quot;participantDisplayName&quot;);

// notification
var email = meibo.getWorkflowVariable(&quot;participantEmail&quot;);
if(email==null){
  meibo.logWarn(&quot;Impossible de notifier &quot; + participantDn + &quot; car il n&apos;a pas d&apos;email&quot;);
}else{
  var /*Parameters*/ params = new Parameters();
  params.add(&quot;MAIL_HEADER&quot;, returnEmpty(getMailParameter(&quot;MAIL_HEADER&quot;)));
  params.add(&quot;MAIL_FOOTER&quot;, returnEmpty(getMailParameter(&quot;MAIL_FOOTER&quot;)));
  params.add(&quot;MAIL_LINKNAME&quot;, returnEmpty(getMailParameter(&quot;MAIL_LINKNAME&quot;)));
  params.add(&quot;MAIL_SENDER&quot;, getMailParameter(&quot;MAIL_SENDER&quot;));
  params.add(&quot;user&quot;, user);
  params.add(&quot;missionID&quot;, missionID);
  params.add(&quot;recipient&quot;, email);  
  params.add(&quot;participantDN&quot;, participantDn);  
  meibo.executePlugin(&quot;NotifyMissionCanceled&quot;,params);
}</ActualParameter>
       </ActualParameters>
      </Tool>
     </Implementation>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Automatic</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="XOR"/>
       <Split Type="XOR">
        <TransitionRefs>
         <TransitionRef Id="T1449136074946"/>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="notification"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="1248"/>
      <ExtendedAttribute Name="YOffset" Value="852"/>
      <ExtendedAttribute Name="Width" Value="133"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1449139919375" Name="">
     <Description></Description>
     <Route/>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Manual</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="XOR"/>
       <Split Type="XOR">
        <TransitionRefs>
         <TransitionRef Id="T1452078449254"/>
         <TransitionRef Id="T1449140025000"/>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value=""/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="132"/>
      <ExtendedAttribute Name="YOffset" Value="280"/>
      <ExtendedAttribute Name="Width" Value="120"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1449244633439" Name="">
     <Description></Description>
     <Implementation>
      <Tool Id="MeiboView" Type="APPLICATION">
       <ActualParameters>
        <ActualParameter>Mission</ActualParameter>
        <ActualParameter>MissionAccept</ActualParameter>
        <ActualParameter>missionDN</ActualParameter>
       </ActualParameters>
      </Tool>
     </Implementation>
     <Performer>PROCESS.ROLE-Participant</Performer>
     <Priority>1</Priority>
      <Deadline Execution="SYNCHR">
       <DeadlineCondition>VARIABLE </DeadlineCondition>
       <ExceptionName>horsD&#233;lai</ExceptionName>
      </Deadline>
      <Deadline Execution="ASYNCHR">
       <DeadlineCondition>CALENDAR_DELAY 2 day</DeadlineCondition>
       <ExceptionName>relance</ExceptionName>
      </Deadline>
     <StartMode>Manual</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="AND"/>
       <Split Type="XOR">
        <TransitionRefs>
         <TransitionRef Id="T1452072030730"/>
         <TransitionRef Id="T1452014277554"/>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="Accepter mission"/>
      <ExtendedAttribute Name="fr_description"  Value="Accepter une mission"/>
      <ExtendedAttribute Name="XOffset" Value="420"/>
      <ExtendedAttribute Name="YOffset" Value="104"/>
      <ExtendedAttribute Name="Width" Value="201"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
      <ExtendedAttribute Name="Handlers" Value="HandlerList" >
<plugin en="Detect events" fr="D&#233;tection d&apos;&#233;v&#233;nements">
  <entries>
    <activity.state.Eligible>
      <action>1452270989283</action>
    </activity.state.Eligible>
  </entries>
</plugin>

      </ExtendedAttribute>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1449244931030" Name="">
     <Description></Description>
     <Implementation>
      <No/>
     </Implementation>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Automatic</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="AND"/>
       <Split Type="AND">
        <TransitionRefs>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="Relance"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="680"/>
      <ExtendedAttribute Name="YOffset" Value="132"/>
      <ExtendedAttribute Name="Width" Value="120"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1449245333752" Name="">
     <Description></Description>
     <Implementation>
      <Tool Id="MeiboScript" Type="SCRIPT">
       <ActualParameters>
        <ActualParameter>var /*Set*/ notificationRoleSet = meibo.setWorkflowVariable(&quot;notificationRoles&quot;);
if(!notificationRoleSet.isEmpty()){
//TODO notifications DDI ou autre en fonction de notificationRoleSet
}</ActualParameter>
       </ActualParameters>
      </Tool>
     </Implementation>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Automatic</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="AND"/>
       <Split Type="AND">
        <TransitionRefs>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="Notifications"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="676"/>
      <ExtendedAttribute Name="YOffset" Value="972"/>
      <ExtendedAttribute Name="Width" Value="125"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1452014265043" Name="">
     <Description></Description>
     <Route/>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Manual</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="AND"/>
       <Split Type="AND">
        <TransitionRefs>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value=""/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="808"/>
      <ExtendedAttribute Name="YOffset" Value="328"/>
      <ExtendedAttribute Name="Width" Value="120"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1452071850125" Name="">
     <Description></Description>
     <Implementation>
      <Tool Id="MeiboScript" Type="SCRIPT">
       <ActualParameters>
        <ActualParameter>var /*String*/ missionDN = meibo.getWorkflowVariable(&quot;missionDN&quot;); 
var /*Entry*/ missionEntry = meibo.getDnEntry(&quot;Mission&quot;, missionDN);
if((missionEntry.TMN_ESTIMATED_COST[0]!=null) &amp;&amp; (missionEntry.TMN_ESTIMATED_COST[0]!=&quot;&quot;)){
  meibo.setWorkflowVariable(&quot;costDefined&quot;,&quot;true&quot;); 
}else{
  meibo.setWorkflowVariable(&quot;costDefined&quot;,&quot;false&quot;);
}</ActualParameter>
       </ActualParameters>
      </Tool>
     </Implementation>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Automatic</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="XOR"/>
       <Split Type="XOR">
        <TransitionRefs>
         <TransitionRef Id="T1452071956127"/>
         <TransitionRef Id="T1452071980389"/>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="verifieCout"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="288"/>
      <ExtendedAttribute Name="YOffset" Value="196"/>
      <ExtendedAttribute Name="Width" Value="120"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1452078418181" Name="">
     <Description></Description>
     <Route/>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Manual</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="XOR"/>
       <Split Type="AND">
        <TransitionRefs>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value=""/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="96"/>
      <ExtendedAttribute Name="YOffset" Value="400"/>
      <ExtendedAttribute Name="Width" Value="120"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1452260216937" Name="">
     <Description></Description>
     <Implementation>
      <Tool Id="MeiboScript" Type="SCRIPT">
       <ActualParameters>
        <ActualParameter>var /*String*/ missionID = meibo.getWorkflowVariable(&quot;missionID&quot;); 
var /*String*/ ownerID = meibo.getWorkflowVariable(&quot;participantID&quot;);
var /*String*/ ownerDN = meibo.getWorkflowVariable(&quot;participantDN&quot;);

meibo.logDebug(&quot;Abandon explicite de la mission &quot; + missionID + &quot; pour &quot; + ownerDN); 
updateMissionStatus(missionID, ownerID, &quot;CAN&quot;, &quot;&quot;);</ActualParameter>
       </ActualParameters>
      </Tool>
     </Implementation>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Automatic</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="XOR"/>
       <Split Type="XOR">
        <TransitionRefs>
         <TransitionRef Id="T1452260261334"/>
         <TransitionRef Id="T1452260241541"/>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="Abandon"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="1204"/>
      <ExtendedAttribute Name="YOffset" Value="788"/>
      <ExtendedAttribute Name="Width" Value="120"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
   </Activities>
   <Transitions>
    <Transition Id="T1448472522446" Name="T1448472522446" From="A1448472295866" To="A1448472369326"/>
    <Transition Id="T1448472950998" Name="T1448472950998" From="A1448472836106" To="A1448472625633">
     <Condition Type="OTHERWISE"></Condition>
    </Transition>
    <Transition Id="T1448473268060" Name="T1448473268060" From="A1448472568550" To="A1448473223019">
     <Condition Type="OTHERWISE"></Condition>
    </Transition>
    <Transition Id="T1448473468781" Name="T1448473468781" From="A1448473223019" To="A1448473316383"/>
    <Transition Id="T1448473472486" Name="T1448473472486" From="A1448473316383" To="A1448472568550">
     <Condition Type="CONDITION">missionModified==&quot;true&quot;</Condition>
    </Transition>
    <Transition Id="T1448473616152" Name="T1448473616152" From="A1448472836106" To="A1448473028474">
     <Condition Type="CONDITION">secondValidationRoles.isEmpty()</Condition>
    </Transition>
    <Transition Id="T1448473752360" Name="T1448473752360" From="A1448472625633" To="A1448473223019">
     <Condition Type="OTHERWISE"></Condition>
    </Transition>
    <Transition Id="T1448473765695" Name="T1448473765695" From="A1448472625633" To="A1448473028474">
     <Condition Type="CONDITION">secondLevelValidated==&quot;true&quot;</Condition>
    </Transition>
    <Transition Id="T1448527696302" Name="T1448527696302" From="A1448473028474" To="A1448527318016">
     <Condition Type="CONDITION">completedForOrganisation==&quot;true&quot;</Condition>
    </Transition>
    <Transition Id="T1448531893154" Name="T1448531893154" From="A1448527961473" To="A1448531857602">
     <Condition Type="OTHERWISE"></Condition>
    </Transition>
    <Transition Id="T1448531937565" Name="T1448531937565" From="A1448531857602" To="A1448531734892"/>
    <Transition Id="T1448545497555" Name="T1448545497555" From="A1448527961473" To="A1448527724520">
     <Condition Type="EXCEPTION">horsD&#233;lai</Condition>
    </Transition>
    <Transition Id="T1448545610687" Name="T1448545610687" From="A1448527318016" To="A1448527724520">
     <Condition Type="EXCEPTION">horsD&#233;lai</Condition>
    </Transition>
    <Transition Id="T1448545750717" Name="T1448545750717" From="A1448472625633" To="A1448545744181">
     <Condition Type="EXCEPTION">rappel1</Condition>
    </Transition>
    <Transition Id="T1448545879483" Name="T1448545879483" From="A1448472568550" To="A1448545874035">
     <Condition Type="EXCEPTION">rappel1</Condition>
    </Transition>
    <Transition Id="T1448546325583" Name="T1448546325583" From="A1448536722066" To="A1448546285917">
     <Condition Type="EXCEPTION">rappel1</Condition>
    </Transition>
    <Transition Id="T1448546538767" Name="T1448546538767" From="A1448536722066" To="A1448546524800">
     <Condition Type="EXCEPTION">escalade</Condition>
    </Transition>
    <Transition Id="T1449065723371" Name="T1449065723371" From="A1448527961473" To="A1448557363960">
     <Condition Type="EXCEPTION">d&#233;partProche</Condition>
    </Transition>
    <Transition Id="T1449065800871" Name="T1449065800871" From="A1448527318016" To="A1448527961473"/>
    <Transition Id="T1449136047940" Name="T1449136047940" From="A1448527724520" To="A1449135987735">
     <Condition Type="OTHERWISE"></Condition>
    </Transition>
    <Transition Id="T1449136074946" Name="T1449136074946" From="A1449135987735" To="A1448472343512"/>
    <Transition Id="T1449140025000" Name="T1449140025000" From="A1449139919375" To="A1448472568550">
     <Condition Type="OTHERWISE"></Condition>
    </Transition>
    <Transition Id="T1449140155934" Name="T1449140155934" From="A1448536722066" To="A1449139919375"/>
    <Transition Id="T1449140168470" Name="T1449140168470" From="A1448546524800" To="A1449139919375"/>
    <Transition Id="T1449141870986" Name="T1449141870986" From="A1448527724520" To="A1448472343512">
     <Condition Type="CONDITION">isDG==&quot;true&quot;</Condition>
    </Transition>
    <Transition Id="T1449244728738" Name="T1449244728738" From="A1449244633439" To="A1448527724520">
     <Condition Type="EXCEPTION">horsD&#233;lai</Condition>
    </Transition>
    <Transition Id="T1449244943062" Name="T1449244943062" From="A1449244633439" To="A1449244931030">
     <Condition Type="EXCEPTION">relance</Condition>
    </Transition>
    <Transition Id="T1452014277554" Name="T1452014277554" From="A1449244633439" To="A1452014265043">
     <Condition Type="OTHERWISE"></Condition>
    </Transition>
    <Transition Id="T1452071956127" Name="T1452071956127" From="A1452071850125" To="A1449139919375">
     <Condition Type="CONDITION">costDefined==&quot;true&quot;</Condition>
    </Transition>
    <Transition Id="T1452071980389" Name="T1452071980389" From="A1452071850125" To="A1448536722066">
     <Condition Type="OTHERWISE"></Condition>
    </Transition>
    <Transition Id="T1452072000756" Name="T1452072000756" From="A1448472369326" To="A1452071850125">
     <Condition Type="CONDITION">participantID==initiatorID</Condition>
    </Transition>
    <Transition Id="T1452072030730" Name="T1452072030730" From="A1449244633439" To="A1452071850125">
     <Condition Type="CONDITION">accepted==&quot;true&quot;</Condition>
    </Transition>
    <Transition Id="T1452078449254" Name="T1452078449254" From="A1449139919375" To="A1452078418181">
     <Condition Type="CONDITION">isDG==&quot;true&quot;</Condition>
    </Transition>
    <Transition Id="T1452078466709" Name="T1452078466709" From="A1448472568550" To="A1452078418181">
     <Condition Type="CONDITION">managerValidated==&quot;true&quot;</Condition>
    </Transition>
    <Transition Id="T1452078534818" Name="T1452078534818" From="A1452078418181" To="A1448472836106"/>
    <Transition Id="T1452079024406" Name="T1452079024406" From="A1448536722066" To="A1448527724520">
     <Condition Type="EXCEPTION">horsDelai</Condition>
    </Transition>
    <Transition Id="T1452079250689" Name="T1452079250689" From="A1448472568550" To="A1448527724520">
     <Condition Type="EXCEPTION">horsD&#233;lai1</Condition>
    </Transition>
    <Transition Id="T1452079411023" Name="T1452079411023" From="A1448473028474" To="A1448473316383">
     <Condition Type="OTHERWISE"></Condition>
    </Transition>
    <Transition Id="T1452079443088" Name="T1452079443088" From="A1448473028474" To="A1448527724520">
     <Condition Type="EXCEPTION">horsD&#233;lai</Condition>
    </Transition>
    <Transition Id="T1452079538108" Name="T1452079538108" From="A1448473223019" To="A1448527724520">
     <Condition Type="EXCEPTION">horsD&#233;lai</Condition>
    </Transition>
    <Transition Id="T1452245070560" Name="T1452245070560" From="A1448472369326" To="A1449244633439">
     <Condition Type="OTHERWISE"></Condition>
    </Transition>
    <Transition Id="T1452260241541" Name="T1452260241541" From="A1452260216937" To="A1449135987735">
     <Condition Type="OTHERWISE"></Condition>
    </Transition>
    <Transition Id="T1452260261334" Name="T1452260261334" From="A1452260216937" To="A1448472343512">
     <Condition Type="CONDITION">isDG==&quot;true&quot;</Condition>
    </Transition>
    <Transition Id="T1452260301879" Name="T1452260301879" From="A1452014265043" To="A1452260216937"/>
    <Transition Id="T1452260326665" Name="T1452260326665" From="A1448473316383" To="A1452260216937">
     <Condition Type="OTHERWISE"></Condition>
    </Transition>
    <Transition Id="T1452260346922" Name="T1452260346922" From="A1448531857602" To="A1452260216937"/>
    <Transition Id="T1452592386838" Name="T1452592386838" From="A1448527961473" To="A1449245333752">
     <Condition Type="CONDITION">finalConfirmation==&quot;true&quot;</Condition>
    </Transition>
    <Transition Id="T1452592394901" Name="T1452592394901" From="A1449245333752" To="A1448472343512"/>
    <Transition Id="T1452592675661" Name="T1452592675661" From="A1448472568550" To="A1448472836106">
     <Condition Type="EXCEPTION">escaladeDDI</Condition>
    </Transition>
   </Transitions>
  </WorkflowProcess>
  <WorkflowProcess AccessLevel="PUBLIC" Id="1449063341651" Name="CompteRendu">
   <ProcessHeader DurationUnit="D">
    <Description>Processus Meibo</Description>
   </ProcessHeader>
   <RedefinableHeader PublicationStatus="RELEASED">
    <Author>Meibo</Author>
    <Version>3</Version>
   </RedefinableHeader>
   <ExtendedAttributes>
    <ExtendedAttribute Name="scale"  Value="100%"/>
    <ExtendedAttribute Name="role"  Value="AdminMeibo"/>
    <ExtendedAttribute Name="role"  Value="InitiateurDeplacement"/>
    <ExtendedAttribute Name="role"  Value="Studio"/>
    <ExtendedAttribute Name="role"  Value="Utilisateur"/>
    <ExtendedAttribute Name="fr_name"  Value="Mission"/>
    <ExtendedAttribute Name="fr_description"  Value=""/>
    <ExtendedAttribute Name="actionsList" Value="">
      <Action Name="Initialisation" Type="workflowScriptImplementation" ID="1448472454995">
      </Action>
      <Action Name="Notifier" Type="pluginMail-1" ID="1448472764360">
      </Action>
    </ExtendedAttribute>
   </ExtendedAttributes>
   <DataFields>
    <DataField Id="ROLE-Manager" IsArray="FALSE">
     <DataType>
      <BasicType Type="PERFORMER"/>
     </DataType>
     <InitialValue>0</InitialValue>
    </DataField>
    <DataField Id="ROLE-Initiateur" IsArray="FALSE">
     <DataType>
      <BasicType Type="PERFORMER"/>
     </DataType>
     <InitialValue>0</InitialValue>
    </DataField>
    <DataField Id="ROLE-ParticipantEvt" IsArray="FALSE">
     <DataType>
      <BasicType Type="PERFORMER"/>
     </DataType>
     <InitialValue>0</InitialValue>
    </DataField>
   </DataFields>
   <FormalParameters>
    <FormalParameter Id="idEvt" Index="3" Mode="IN">
     <DataType>
      <BasicType Type="INTEGER"/>
     </DataType>
    </FormalParameter>
   </FormalParameters>
   <Participants>
    <Participant Id="AdminMeibo" Name="AdminMeibo">
     <ParticipantType Type="ROLE"/>
    </Participant>
    <Participant Id="AnalyseurDeplacement" Name="AnalyseurDeplacement">
     <ParticipantType Type="ROLE"/>
    </Participant>
    <Participant Id="DDI" Name="DDI">
     <ParticipantType Type="ROLE"/>
    </Participant>
    <Participant Id="InitiateurDeplacement" Name="InitiateurDeplacement">
     <ParticipantType Type="ROLE"/>
    </Participant>
    <Participant Id="OrganisateurVoyage" Name="OrganisateurVoyage">
     <ParticipantType Type="ROLE"/>
    </Participant>
    <Participant Id="Studio" Name="Studio">
     <ParticipantType Type="ROLE"/>
    </Participant>
    <Participant Id="Utilisateur" Name="Utilisateur">
     <ParticipantType Type="ROLE"/>
    </Participant>
   </Participants>
   <Activities>
    <Activity Id="A1448472295866" Name="">
     <Description></Description>
     <Route/>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Manual</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="AND"/>
       <Split Type="XOR">
        <TransitionRefs>
         <TransitionRef Id="T1448472522446"/>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="D&#233;but"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="308"/>
      <ExtendedAttribute Name="YOffset" Value="12"/>
      <ExtendedAttribute Name="Width" Value="120"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1448472343512" Name="">
     <Description></Description>
     <Route/>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Manual</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="XOR"/>
       <Split Type="AND">
        <TransitionRefs>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="Fin"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="308"/>
      <ExtendedAttribute Name="YOffset" Value="324"/>
      <ExtendedAttribute Name="Width" Value="120"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1448472369326" Name="">
     <Description></Description>
     <Implementation>
      <Tool Id="MeiboScript" Type="SCRIPT">
       <ActualParameters>
        <ActualParameter></ActualParameter>
       </ActualParameters>
      </Tool>
     </Implementation>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Automatic</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="AND"/>
       <Split Type="AND">
        <TransitionRefs>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="Initialisation"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="500"/>
      <ExtendedAttribute Name="YOffset" Value="16"/>
      <ExtendedAttribute Name="Width" Value="120"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1448528684451" Name="">
     <Description></Description>
     <Implementation>
      <No/>
     </Implementation>
     <Performer>PROCESS.ROLE-ParticipantEvt</Performer>
     <Priority>1</Priority>
      <Deadline Execution="ASYNCHR">
       <DeadlineCondition></DeadlineCondition>
       <ExceptionName>rappel1</ExceptionName>
      </Deadline>
      <Deadline Execution="ASYNCHR">
       <DeadlineCondition>CALENDAR_DELAY 2 week</DeadlineCondition>
       <ExceptionName>rappel2</ExceptionName>
      </Deadline>
     <StartMode>Manual</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="AND"/>
       <Split Type="XOR">
        <TransitionRefs>
         <TransitionRef Id="T1448529319111"/>
         <TransitionRef Id="T1449070395553"/>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="ContributionCompteRendu"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="452"/>
      <ExtendedAttribute Name="YOffset" Value="88"/>
      <ExtendedAttribute Name="Width" Value="221"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1448529288334" Name="">
     <Description></Description>
     <Implementation>
      <No/>
     </Implementation>
     <Performer>AnalyseurDeplacement</Performer>
     <Priority>1</Priority>
     <StartMode>Manual</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="XOR"/>
       <Split Type="XOR">
        <TransitionRefs>
         <TransitionRef Id="T1448554557405"/>
         <TransitionRef Id="T1448529461380"/>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="Verifie CR"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="4"/>
      <ExtendedAttribute Name="YOffset" Value="128"/>
      <ExtendedAttribute Name="Width" Value="188"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1448529423187" Name="">
     <Description></Description>
     <Implementation>
      <No/>
     </Implementation>
     <Performer>PROCESS.ROLE-ParticipantEvt</Performer>
     <Priority>1</Priority>
     <StartMode>Manual</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="AND"/>
       <Split Type="AND">
        <TransitionRefs>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="ModifieCR"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="468"/>
      <ExtendedAttribute Name="YOffset" Value="216"/>
      <ExtendedAttribute Name="Width" Value="209"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1448529486134" Name="">
     <Description></Description>
     <Route/>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Manual</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="AND"/>
       <Split Type="AND">
        <TransitionRefs>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value=""/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="352"/>
      <ExtendedAttribute Name="YOffset" Value="156"/>
      <ExtendedAttribute Name="Width" Value="84"/>
      <ExtendedAttribute Name="Height" Value="32"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1448529961347" Name="">
     <Description></Description>
     <Implementation>
      <No/>
     </Implementation>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Automatic</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="AND"/>
       <Split Type="AND">
        <TransitionRefs>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="Rappel"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="748"/>
      <ExtendedAttribute Name="YOffset" Value="88"/>
      <ExtendedAttribute Name="Width" Value="120"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1448554523343" Name="">
     <Description></Description>
     <Implementation>
      <Tool Id="MeiboScript" Type="SCRIPT">
       <ActualParameters>
        <ActualParameter></ActualParameter>
       </ActualParameters>
      </Tool>
     </Implementation>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Automatic</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="AND"/>
       <Split Type="AND">
        <TransitionRefs>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="Envoi CR"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="308"/>
      <ExtendedAttribute Name="YOffset" Value="248"/>
      <ExtendedAttribute Name="Width" Value="120"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1449070349726" Name="">
     <Description></Description>
     <Route/>
     <Performer></Performer>
     <Priority>2</Priority>
     <StartMode>Manual</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="AND"/>
       <Split Type="AND">
        <TransitionRefs>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="Demande contributions"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="668"/>
      <ExtendedAttribute Name="YOffset" Value="172"/>
      <ExtendedAttribute Name="Width" Value="192"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
   </Activities>
   <Transitions>
    <Transition Id="T1448472522446" Name="T1448472522446" From="A1448472295866" To="A1448472369326"/>
    <Transition Id="T1448529319111" Name="T1448529319111" From="A1448528684451" To="A1448529288334">
     <Condition Type="CONDITION">soumissionCR</Condition>
    </Transition>
    <Transition Id="T1448529461380" Name="T1448529461380" From="A1448529288334" To="A1448529423187">
     <Condition Type="CONDITION">KO</Condition>
    </Transition>
    <Transition Id="T1448529513943" Name="T1448529513943" From="A1448529423187" To="A1448529486134"/>
    <Transition Id="T1448529515759" Name="T1448529515759" From="A1448529486134" To="A1448529288334"/>
    <Transition Id="T1448530018565" Name="T1448530018565" From="A1448528684451" To="A1448529961347">
     <Condition Type="EXCEPTION">rappel1</Condition>
    </Transition>
    <Transition Id="T1448554549702" Name="T1448554549702" From="A1448554523343" To="A1448472343512"/>
    <Transition Id="T1448554557405" Name="T1448554557405" From="A1448529288334" To="A1448554523343">
     <Condition Type="CONDITION">OK</Condition>
    </Transition>
    <Transition Id="T1449068270576" Name="T1449068270576" From="A1448472369326" To="A1448528684451"/>
    <Transition Id="T1449070395553" Name="T1449070395553" From="A1448528684451" To="A1449070349726">
     <Condition Type="CONDITION">demandeContributions</Condition>
    </Transition>
    <Transition Id="T1449070652939" Name="T1449070652939" From="A1449070349726" To="A1448528684451"/>
   </Transitions>
  </WorkflowProcess>
  <WorkflowProcess AccessLevel="PUBLIC" Id="1449063509239" Name="OrganisationDeplacement">
   <ProcessHeader DurationUnit="D">
    <Description>Processus Meibo</Description>
   </ProcessHeader>
   <RedefinableHeader PublicationStatus="RELEASED">
    <Author>Meibo</Author>
    <Version>3</Version>
   </RedefinableHeader>
   <ExtendedAttributes>
    <ExtendedAttribute Name="scale"  Value="100%"/>
    <ExtendedAttribute Name="role"  Value="AdminMeibo"/>
    <ExtendedAttribute Name="role"  Value="InitiateurDeplacement"/>
    <ExtendedAttribute Name="role"  Value="Studio"/>
    <ExtendedAttribute Name="role"  Value="Utilisateur"/>
    <ExtendedAttribute Name="fr_name"  Value="Mission"/>
    <ExtendedAttribute Name="fr_description"  Value=""/>
    <ExtendedAttribute Name="actionsList" Value="">
      <Action Name="Initialisation" Type="workflowScriptImplementation" ID="1448472454995">
      </Action>
      <Action Name="Notifier" Type="pluginMail-1" ID="1448472764360">
      </Action>
    </ExtendedAttribute>
   </ExtendedAttributes>
   <DataFields>
    <DataField Id="ROLE-Manager" IsArray="FALSE">
     <DataType>
      <BasicType Type="PERFORMER"/>
     </DataType>
     <InitialValue>0</InitialValue>
    </DataField>
    <DataField Id="ROLE-Initiateur" IsArray="FALSE">
     <DataType>
      <BasicType Type="PERFORMER"/>
     </DataType>
     <InitialValue>0</InitialValue>
    </DataField>
    <DataField Id="ROLE-Participant" IsArray="FALSE">
     <DataType>
      <BasicType Type="PERFORMER"/>
     </DataType>
     <InitialValue>0</InitialValue>
    </DataField>
   </DataFields>
   <FormalParameters>
    <FormalParameter Id="userDn" Index="3" Mode="IN">
     <DataType>
      <BasicType Type="OBJECT"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="idMission" Index="4" Mode="IN">
     <DataType>
      <BasicType Type="INTEGER"/>
     </DataType>
    </FormalParameter>
   </FormalParameters>
   <Participants>
    <Participant Id="AdminMeibo" Name="AdminMeibo">
     <ParticipantType Type="ROLE"/>
    </Participant>
    <Participant Id="AnalyseurDeplacement" Name="AnalyseurDeplacement">
     <ParticipantType Type="ROLE"/>
    </Participant>
    <Participant Id="DDI" Name="DDI">
     <ParticipantType Type="ROLE"/>
    </Participant>
    <Participant Id="InitiateurDeplacement" Name="InitiateurDeplacement">
     <ParticipantType Type="ROLE"/>
    </Participant>
    <Participant Id="OrganisateurVoyage" Name="OrganisateurVoyage">
     <ParticipantType Type="ROLE"/>
    </Participant>
    <Participant Id="Studio" Name="Studio">
     <ParticipantType Type="ROLE"/>
    </Participant>
    <Participant Id="Utilisateur" Name="Utilisateur">
     <ParticipantType Type="ROLE"/>
    </Participant>
   </Participants>
   <Activities>
    <Activity Id="A1448472295866" Name="">
     <Description></Description>
     <Route/>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Manual</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="AND"/>
       <Split Type="XOR">
        <TransitionRefs>
         <TransitionRef Id="T1449063538696"/>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="D&#233;but"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="96"/>
      <ExtendedAttribute Name="YOffset" Value="4"/>
      <ExtendedAttribute Name="Width" Value="120"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1448527318016" Name="">
     <Description></Description>
     <Implementation>
      <No/>
     </Implementation>
     <Performer>OrganisateurVoyage</Performer>
     <Priority>1</Priority>
      <Deadline Execution="SYNCHR">
       <DeadlineCondition></DeadlineCondition>
       <ExceptionName>horsD&#233;lai</ExceptionName>
      </Deadline>
     <StartMode>Manual</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="XOR"/>
       <Split Type="XOR">
        <TransitionRefs>
         <TransitionRef Id="T1449063562953"/>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="Organise"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="68"/>
      <ExtendedAttribute Name="YOffset" Value="96"/>
      <ExtendedAttribute Name="Width" Value="169"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1449063543648" Name="">
     <Description></Description>
     <Route/>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Manual</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="AND"/>
       <Split Type="AND">
        <TransitionRefs>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="Fin"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="92"/>
      <ExtendedAttribute Name="YOffset" Value="172"/>
      <ExtendedAttribute Name="Width" Value="120"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
   </Activities>
   <Transitions>
    <Transition Id="T1449063538696" Name="T1449063538696" From="A1448472295866" To="A1448527318016"/>
    <Transition Id="T1449063562953" Name="T1449063562953" From="A1448527318016" To="A1449063543648"/>
   </Transitions>
  </WorkflowProcess>
  <WorkflowProcess AccessLevel="PUBLIC" Id="1448472291649" Name="Mission">
   <ProcessHeader DurationUnit="D">
    <Description>Processus Meibo</Description>
   </ProcessHeader>
   <RedefinableHeader PublicationStatus="RELEASED">
    <Author>Meibo</Author>
    <Version>3</Version>
   </RedefinableHeader>
   <ExtendedAttributes>
    <ExtendedAttribute Name="scale"  Value="100%"/>
    <ExtendedAttribute Name="role"  Value="AdminMeibo"/>
    <ExtendedAttribute Name="role"  Value="InitiateurDeplacement"/>
    <ExtendedAttribute Name="role"  Value="Studio"/>
    <ExtendedAttribute Name="role"  Value="Utilisateur"/>
    <ExtendedAttribute Name="fr_name"  Value="Mission"/>
    <ExtendedAttribute Name="fr_description"  Value=""/>
    <ExtendedAttribute Name="actionsList" Value="">
      <Action Name="Initialisation" Type="workflowScriptImplementation" ID="1448472454995">
      </Action>
      <Action Name="Notifier" Type="pluginMail-1" ID="1448472764360">
      </Action>
      <Action Name="acceptationEligible" Type="workflowScriptImplementation" ID="1452270989283">
// affectation du role
var participantDn = meibo.getWorkflowVariable(&quot;participantDN&quot;);
var /*String*/ missionID = meibo.getWorkflowVariable(&quot;missionID&quot;); 
meibo.setWorkflowVariable(&quot;ROLE-Participant&quot;, participantDn); 

var /*WapiWorkItem*/ wapiworkitem = meibo.getCurrentWorkflowTask();
meibo.logInfo(&quot;Affectation de la tache (&quot; + wapiworkitem.getId() + &quot;) d&apos;acceptation de mission &quot; + missionID + &quot; &#224; &quot; + participantDn);

// notification
var email = meibo.getWorkflowVariable(&quot;participantEmail&quot;);
if(email==null){
  meibo.logWarn(&quot;Impossible de notifier &quot; + participantDn + &quot; car il n&apos;a pas d&apos;email&quot;);
}else{
  var /*Parameters*/ params = new Parameters();
  params.add(&quot;MAIL_HEADER&quot;, returnEmpty(getMailParameter(&quot;MAIL_HEADER&quot;)));
  params.add(&quot;MAIL_FOOTER&quot;, returnEmpty(getMailParameter(&quot;MAIL_FOOTER&quot;)));
  params.add(&quot;MAIL_LINKNAME&quot;, returnEmpty(getMailParameter(&quot;MAIL_LINKNAME&quot;)));
  params.add(&quot;MAIL_SENDER&quot;, getMailParameter(&quot;MAIL_SENDER&quot;));
  //params.add(&quot;participantDN&quot;, meibo.getWorkflowVariable(&quot;participantDN&quot;));
  params.add(&quot;recipient&quot;, email);
  meibo.executePlugin(&quot;NotifyParticipantForAcceptation&quot;,params);
}
      </Action>
      <Action Name="managerValidationEligible" Type="workflowScriptImplementation" ID="1452522071084">
///$debug
var /*String*/ participantDn = meibo.getWorkflowVariable(&quot;participantDN&quot;);
var /*String*/ missionID = meibo.getWorkflowVariable(&quot;missionID&quot;); 
var /*String*/ user = meibo.getWorkflowVariable(&quot;participantDisplayName&quot;);

var /*ResultSet*/ managerRs = getManager(participantDn);
var /*WapiWorkItem*/ wapiworkitem = meibo.getCurrentWorkflowTask();
meibo.logDebug(&quot;getCurrentWorkflowTask : &quot; + wapiworkitem);
var /*UserTask*/ userTask = meibo.getWorkflowUserTask()
meibo.logDebug(&quot;getWorkflowUserTask : &quot; + userTask);

if(managerRs.getEntryCount()&gt;0){
  // affectation du role
  var /*Entry*/ managerEntry = managerRs.getEntry();
  meibo.setWorkflowVariable(&quot;ROLE-Manager&quot;, managerEntry.dn[0]); 
  meibo.logInfo(&quot;Affectation de la tache (&quot; + wapiworkitem.getId() + &quot;) de validation de la mission &quot; + missionID + &quot; &#224; &quot; + managerEntry.dn[0] + &quot; pour &quot; + participantDn);

  // notification
  var email = meibo.getWorkflowVariable(&quot;participantEmail&quot;);
  if(email==null){
    meibo.logWarn(&quot;Impossible de notifier &quot; + participantDn + &quot; car il n&apos;a pas d&apos;email&quot;);
  }else{
    var /*Parameters*/ params = new Parameters();
    params.add(&quot;MAIL_HEADER&quot;, returnEmpty(getMailParameter(&quot;MAIL_HEADER&quot;)));
    params.add(&quot;MAIL_FOOTER&quot;, returnEmpty(getMailParameter(&quot;MAIL_FOOTER&quot;)));
    params.add(&quot;MAIL_LINKNAME&quot;, returnEmpty(getMailParameter(&quot;MAIL_LINKNAME&quot;)));
    params.add(&quot;MAIL_SENDER&quot;, getMailParameter(&quot;MAIL_SENDER&quot;));
    params.add(&quot;user&quot;, user);
    params.add(&quot;missionID&quot;, missionID);
    params.add(&quot;recipient&quot;, email);
    params.add(&quot;participantDN&quot;, participantDn);
    
    meibo.executePlugin(&quot;NotifyForValidation&quot;,params);
  }
}else{
  meibo.logWarn(&quot;Pas de manager trouv&#233; pour &quot; + participantDn);
  //TODO : voire comment traiter; par d&#233;faut le workflow resterait bloqu&#233;
  wapiworkitem.complete();
}
      </Action>
      <Action Name="modificationEligible" Type="workflowScriptImplementation" ID="1452524978986">
// affectation du role
var participantDn = meibo.getWorkflowVariable(&quot;participantDN&quot;);
var /*String*/ missionID = meibo.getWorkflowVariable(&quot;missionID&quot;); 
var /*String*/ reason = meibo.getWorkflowVariable(&quot;comment&quot;); 
meibo.setWorkflowVariable(&quot;ROLE-Participant&quot;, participantDn); 

var /*WapiWorkItem*/ wapiworkitem = meibo.getCurrentWorkflowTask();
meibo.logInfo(&quot;Affectation de la tache (&quot; + wapiworkitem.getId() + &quot;) de modification de mission &quot; + missionID + &quot; &#224; &quot; + participantDn);

// notification
var email = meibo.getWorkflowVariable(&quot;participantEmail&quot;);
if(email==null){
  meibo.logWarn(&quot;Impossible de notifier &quot; + participantDn + &quot; car il n&apos;a pas d&apos;email&quot;);
}else{
  var /*Parameters*/ params = new Parameters();
  params.add(&quot;MAIL_HEADER&quot;, returnEmpty(getMailParameter(&quot;MAIL_HEADER&quot;)));
  params.add(&quot;MAIL_FOOTER&quot;, returnEmpty(getMailParameter(&quot;MAIL_FOOTER&quot;)));
  params.add(&quot;MAIL_LINKNAME&quot;, returnEmpty(getMailParameter(&quot;MAIL_LINKNAME&quot;)));
  params.add(&quot;MAIL_SENDER&quot;, getMailParameter(&quot;MAIL_SENDER&quot;));
  params.add(&quot;recipient&quot;, email);
  params.add(&quot;reason&quot;, reason);
  meibo.executePlugin(&quot;NotifyRejection&quot;,params);
}
      </Action>
      <Action Name="secondLevelValidationEligible" Type="workflowScriptImplementation" ID="1452593973817">
var /*Set*/ validationRoleSet = meibo.setWorkflowVariable(&quot;secondValidationRoles&quot;); 
var /*Array*/ validationRoleArray = new Array(validationRoleSet.toArray());
meibo.setWorkflowVariable(&quot;ROLE_SecondLevelValidation&quot;, validationRoleArray);

var /*WapiWorkItem*/ wapiworkitem = meibo.getCurrentWorkflowTask();
meibo.logDebug(&quot;getCurrentWorkflowTask : &quot; + wapiworkitem);
var /*UserTask*/ userTask = meibo.getWorkflowUserTask()
meibo.logDebug(&quot;getWorkflowUserTask : &quot; + userTask);

meibo.logInfo(&quot;Affectation de la tache (&quot; + wapiworkitem.getId() + &quot;) de validation de la mission &quot; + missionID + &quot; &#224; &quot; + validationRoleArray + &quot; pour &quot; + participantDn);

if(!validationRoleSet.isEmpty()){

  // notification
  var email = meibo.getWorkflowVariable(&quot;participantEmail&quot;);
  //TODO recherche emails correspondant aux roles
  var targetUsers = getRecursiveGroupMembersFromGroupNames(validationRoleArray);
  if(targetUsers.isEmpty()){
    meibo.logWarn(&quot;Aucun utilisateur trouv&#233; avec les roles &quot; + validationRoleArray + &quot; pour validation de second niveau&quot;);
  }else{
    var secondLevelValidationPeople = new Array(targetUsers.toArray());
    meibo.setWorkflowVariable(&quot;secondLevelValidationPeople&quot;, secondLevelValidationPeople);

    var /*Parameters*/ params = new Parameters();
    params.add(&quot;MAIL_HEADER&quot;, returnEmpty(getMailParameter(&quot;MAIL_HEADER&quot;)));
    params.add(&quot;MAIL_FOOTER&quot;, returnEmpty(getMailParameter(&quot;MAIL_FOOTER&quot;)));
    params.add(&quot;MAIL_LINKNAME&quot;, returnEmpty(getMailParameter(&quot;MAIL_LINKNAME&quot;)));
    params.add(&quot;MAIL_SENDER&quot;, getMailParameter(&quot;MAIL_SENDER&quot;));
    params.add(&quot;user&quot;, user);
    params.add(&quot;missionID&quot;, missionID);
    params.add(&quot;recipient&quot;, email);
    params.add(&quot;participantDN&quot;, participantDn);
    
    meibo.executePlugin(&quot;NotifyForSecondLevelValidation&quot;,params);
  }
}else{
  // normalement &#231;a ne devrait pas arriver quand on passe par ici
  meibo.logDebug(&quot;Pas de role d&#233;fini pour validation de 2nd niveau&quot;);
  wapiworkitem.complete();
}
      </Action>
    </ExtendedAttribute>
   </ExtendedAttributes>
   <DataFields>
    <DataField Id="ROLE-Manager" IsArray="FALSE">
     <DataType>
      <BasicType Type="PERFORMER"/>
     </DataType>
     <InitialValue>0</InitialValue>
    </DataField>
    <DataField Id="ROLE-Initiateur" IsArray="FALSE">
     <DataType>
      <BasicType Type="PERFORMER"/>
     </DataType>
     <InitialValue>0</InitialValue>
    </DataField>
    <DataField Id="ROLE-Participant" IsArray="FALSE">
     <DataType>
      <BasicType Type="PERFORMER"/>
     </DataType>
     <InitialValue>0</InitialValue>
    </DataField>
    <DataField Id="missionDN" IsArray="FALSE">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </DataField>
    <DataField Id="accepted" IsArray="FALSE">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
     <InitialValue>false</InitialValue>
    </DataField>
    <DataField Id="costDefined" IsArray="FALSE">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
     <InitialValue>false</InitialValue>
    </DataField>
    <DataField Id="firstEventStartDate" IsArray="FALSE">
     <DataType>
      <BasicType Type="DEADLINE"/>
     </DataType>
     <InitialValue>01/01/16 10:24</InitialValue>
    </DataField>
    <DataField Id="MAIL_HEADER" IsArray="FALSE">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </DataField>
    <DataField Id="MAIL_FOOTER" IsArray="FALSE">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </DataField>
    <DataField Id="MAIL_SENDER" IsArray="FALSE">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </DataField>
    <DataField Id="participantCn" IsArray="FALSE">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </DataField>
    <DataField Id="participantEmail" IsArray="FALSE">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </DataField>
    <DataField Id="isDG" IsArray="FALSE">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
     <InitialValue>false</InitialValue>
    </DataField>
    <DataField Id="managerValidated" IsArray="FALSE">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
     <InitialValue>false</InitialValue>
    </DataField>
    <DataField Id="DDIvalidationRequired" IsArray="FALSE">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
     <InitialValue>true</InitialValue>
    </DataField>
    <DataField Id="notificationRoles" IsArray="FALSE">
     <DataType>
      <BasicType Type="OBJECT"/>
     </DataType>
    </DataField>
    <DataField Id="secondValidationRoles" IsArray="FALSE">
     <DataType>
      <BasicType Type="OBJECT"/>
     </DataType>
    </DataField>
    <DataField Id="finalConfirmation" IsArray="FALSE">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
     <InitialValue>false</InitialValue>
    </DataField>
    <DataField Id="completedForOrganisation" IsArray="FALSE">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
     <InitialValue>false</InitialValue>
    </DataField>
    <DataField Id="secondLevelValidated" IsArray="FALSE">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
     <InitialValue>false</InitialValue>
    </DataField>
    <DataField Id="missionModified" IsArray="FALSE">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
     <InitialValue>false</InitialValue>
    </DataField>
    <DataField Id="ROLE_SecondLevelValidation" IsArray="FALSE">
     <DataType>
      <BasicType Type="PERFORMER"/>
     </DataType>
    </DataField>
    <DataField Id="secondLevelValidationPeople" IsArray="TRUE">
     <DataType>
      <BasicType Type="OBJECT"/>
     </DataType>
    </DataField>
   </DataFields>
   <FormalParameters>
    <FormalParameter Id="participantDN" Index="23" Mode="IN">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="missionID" Index="24" Mode="IN">
     <DataType>
      <BasicType Type="INTEGER"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="initiatorDN" Index="25" Mode="IN">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="initiatorID" Index="26" Mode="IN">
     <DataType>
      <BasicType Type="INTEGER"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="participantID" Index="27" Mode="IN">
     <DataType>
      <BasicType Type="INTEGER"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="baseURL" Index="28" Mode="IN">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="comment" Index="29" Mode="INOUT">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </FormalParameter>
   </FormalParameters>
   <Participants>
    <Participant Id="AdminMeibo" Name="AdminMeibo">
     <ParticipantType Type="ROLE"/>
    </Participant>
    <Participant Id="AnalyseurDeplacement" Name="AnalyseurDeplacement">
     <ParticipantType Type="ROLE"/>
    </Participant>
    <Participant Id="DDI" Name="DDI">
     <ParticipantType Type="ROLE"/>
    </Participant>
    <Participant Id="InitiateurDeplacement" Name="InitiateurDeplacement">
     <ParticipantType Type="ROLE"/>
    </Participant>
    <Participant Id="OrganisateurVoyage" Name="OrganisateurVoyage">
     <ParticipantType Type="ROLE"/>
    </Participant>
    <Participant Id="Studio" Name="Studio">
     <ParticipantType Type="ROLE"/>
    </Participant>
    <Participant Id="Utilisateur" Name="Utilisateur">
     <ParticipantType Type="ROLE"/>
    </Participant>
   </Participants>
   <Activities>
    <Activity Id="A1448472295866" Name="">
     <Description></Description>
     <Route/>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Manual</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="AND"/>
       <Split Type="XOR">
        <TransitionRefs>
         <TransitionRef Id="T1448472522446"/>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="D&#233;but"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="96"/>
      <ExtendedAttribute Name="YOffset" Value="4"/>
      <ExtendedAttribute Name="Width" Value="120"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1448472343512" Name="">
     <Description></Description>
     <Route/>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Manual</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="XOR"/>
       <Split Type="AND">
        <TransitionRefs>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="Fin"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="992"/>
      <ExtendedAttribute Name="YOffset" Value="1024"/>
      <ExtendedAttribute Name="Width" Value="120"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1448472369326" Name="">
     <Description></Description>
     <Implementation>
      <Tool Id="MeiboScript" Type="SCRIPT">
       <ActualParameters>
        <ActualParameter>//$debug
var /*String*/ missionID = meibo.getWorkflowVariable(&quot;missionID&quot;); 
var /*String*/ missionDN = &quot;T_MISSION_TMN,TMN_ID,&quot; + missionID; 
meibo.setWorkflowVariable(&quot;missionDN&quot;, missionDN);
var /*String*/ ownerID = meibo.getWorkflowVariable(&quot;participantID&quot;);

meibo.setWorkflowVariable(&quot;MAIL_HEADER&quot;, returnEmpty(getMailParameter(&quot;MAIL_HEADER&quot;)));
meibo.setWorkflowVariable(&quot;MAIL_FOOTER&quot;, returnEmpty(getMailParameter(&quot;MAIL_FOOTER&quot;)));
meibo.setWorkflowVariable(&quot;MAIL_LINKNAME&quot;, returnEmpty(getMailParameter(&quot;MAIL_LINKNAME&quot;)));
meibo.setWorkflowVariable(&quot;MAIL_SENDER&quot;, getMailParameter(&quot;MAIL_SENDER&quot;));

var /*String*/ particpantLdapDN = null;
var /*Entry*/ personEntry = meibo.getDnEntry(&quot;TravelPeople&quot;,&quot;T_PERSON_PRS,PRS_ID,&quot; + ownerID, &quot;mail,ldapDn,PRS_LOGIN,displayName&quot;);
var participantEmail = personEntry.mail[0];
if((participantEmail==null) || (participantEmail==&quot;&quot;)){
  meibo.logWarn(&quot;Le participant &quot; + ownerID + &quot; n&apos;a pas d&apos;adresse email&quot;);
}else{
  meibo.setWorkflowVariable(&quot;participantEmail&quot;, participantEmail);
}
meibo.setWorkflowVariable(&quot;participantDN&quot;, personEntry.ldapDn[0]);
meibo.setWorkflowVariable(&quot;participantCn&quot;, personEntry.PRS_LOGIN[0]);
meibo.setWorkflowVariable(&quot;participantDisplayName&quot;, personEntry.displayName[0]);

var wfVariables = meibo.getWorkflowVariables(); // utile seulement en debug

meibo.logDebug(&quot;Initialisation workflow mission &quot; + missionID + &quot; pour &quot; + ownerID);

var /*Entry*/ missionEntry = meibo.getDnEntry(&quot;Mission&quot;, missionDN);

// recherche les caract&#233;ristiques des participications aux &#233;v&#232;nements :
// - 1ere date de d&#233;but de participation &#224; un &#233;venement (pour constituer l&apos;&#233;ch&#233;ance du workflow)
// - roles pour les validations et notifications en fonction de ces &#233;venements et participations
var /*ResultSet*/ missionEventRS = meibo.executeLink(&quot;MissionEvent&quot;, missionDN,&quot;fkTCT_ID,fkTES_ID,fkTTY_ID&quot;);
var /*ResultSet*/ eventAttendeesRS = null;
var /*Entry*/ eventAttendeesEntry = null;
var missionId=null;
var /*Date*/ eventStartDate = null;
var /*Date*/ overallStartDate = null;
var scopeID = null;
var evtTypeID = null;
var purposeID = null;
var involvementID = null;
var /*ResultSet*/ validationRoleRS = null;
var /*Entry*/ validationRoleEntry = null;
var /*Set*/ validationRoleSet = new java.util.HashSet();
var /*ResultSet*/ notificationRoleRS = null;
var /*Entry*/ notificationRoleEntry = null;
var /*Set*/ notificationRoleSet = new java.util.HashSet();

for each(var missionEvent in missionEventRS){
  missionId = missionEvent.fkTCT_ID[0] 
  eventAttendeesRS = meibo.executeResource(&quot;R_Attendees&quot;,&quot;PRS_ID=&quot;+ ownerID + &quot; AND TCT_ID=&quot;+missionId ,1,&quot;RAS_START_DATE,TPE_ID,TIN_ID&quot;);
  eventAttendeesEntry = eventAttendeesRS.getEntry();
  
  scopeID = missionEvent.fkTES_ID[0];
  evtTypeID = missionEvent.fkTTY_ID[0];
  purposeID = eventAttendeesEntry.TPE_ID[0];
  involvementID = eventAttendeesEntry.TIN_ID[0];

  // recherche des roles pour la 2eme validation (validation &quot;DDI&quot;)  
  validationRoleRS = meibo.executeSqlRequest(&quot;TRAVEL_BCOM&quot;,&quot;call get_travel_validation_roles(&apos;&quot;+ scopeID + &quot;&apos;,&apos;&quot; + evtTypeID + &quot;&apos;,&apos;&quot; + purposeID + &quot;&apos;,&apos;&quot; + involvementID + &quot;&apos;)&quot;,0); 
  for each(var validationRoleEntry in validationRoleRS){
    meibo.logDebug(&quot;ValidationRole : &quot; + validationRoleEntry);
    validationRoleSet.add(validationRoleEntry.ValidationRoles[0]);
  }
  meibo.setWorkflowVariable(&quot;secondValidationRoles&quot;, validationRoleSet);
  
  // recherche des roles pour la natification sans validation (notification &quot;DDI&quot;)  
  notificationRoleRS = meibo.executeSqlRequest(&quot;TRAVEL_BCOM&quot;,&quot;call get_travel_notified_roles(&apos;&quot;+ scopeID + &quot;&apos;,&apos;&quot; + evtTypeID + &quot;&apos;,&apos;&quot; + purposeID + &quot;&apos;,&apos;&quot; + involvementID + &quot;&apos;)&quot;,0); 
  for each(var notificationRoleEntry in notificationRoleRS){
    meibo.logDebug(&quot;ValidationRole : &quot; + notificationRoleEntry);   
    notificationRoleSet.add(notificationRoleEntry.ValidationRoles[0]); 
  }
  meibo.setWorkflowVariable(&quot;notificationRoles&quot;, notificationRoleSet);
  
  //1ere date de d&#233;but de participation &#224; un &#233;venement (pour constituer l&apos;&#233;ch&#233;ance du workflow)    
  eventStartDate = new Date(SQL_DATE_FORMAT.parse(eventAttendeesEntry.RAS_START_DATE[0]));
  if((overallStartDate==null) || (eventStartDate &lt; overallStartDate)){
    overallStartDate = eventStartDate;
  }
}
meibo.logDebug(&quot;Date d&apos;&#233;cheance workflow mission &quot; + missionID + &quot; : &quot; + overallStartDate.toLocaleString());
meibo.setWorkflowVariable(&quot;firstEventStartDate&quot;, new WAPIDeadline(overallStartDate));

// v&#233;rifie si le participant est Directeur G&#233;n&#233;ral
var parameters_groupsMapping = getProvisioningParameters_Droit();
var /*boolean*/isDG = userHasRole(personEntry.ldapDn[0], &quot;DG&quot;, parameters_groupsMapping);
meibo.setWorkflowVariable(&quot;isDG&quot;, &quot;&quot;+ isDG);</ActualParameter>
       </ActualParameters>
      </Tool>
     </Implementation>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Automatic</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="XOR"/>
       <Split Type="XOR">
        <TransitionRefs>
         <TransitionRef Id="T1452072000756"/>
         <TransitionRef Id="T1452245070560"/>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="Initialisation"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="288"/>
      <ExtendedAttribute Name="YOffset" Value="4"/>
      <ExtendedAttribute Name="Width" Value="145"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1448472568550" Name="">
     <Description></Description>
     <Implementation>
      <Tool Id="MeiboView" Type="APPLICATION">
       <ActualParameters>
        <ActualParameter>Mission</ActualParameter>
        <ActualParameter>MissionValidate</ActualParameter>
        <ActualParameter>missionDN</ActualParameter>
       </ActualParameters>
      </Tool>
     </Implementation>
     <Performer>PROCESS.ROLE-Manager</Performer>
     <Priority>1</Priority>
      <Deadline Execution="SYNCHR">
       <DeadlineCondition>VARIABLE firstEventStartDate</DeadlineCondition>
       <ExceptionName>horsD&#233;lai1</ExceptionName>
      </Deadline>
      <Deadline Execution="ASYNCHR">
       <DeadlineCondition>DELAY 2 day</DeadlineCondition>
       <ExceptionName>rappel1</ExceptionName>
      </Deadline>
      <Deadline Execution="SYNCHR">
       <DeadlineCondition></DeadlineCondition>
       <ExceptionName>escaladeDDI</ExceptionName>
      </Deadline>
     <StartMode>Manual</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="XOR"/>
       <Split Type="XOR">
        <TransitionRefs>
         <TransitionRef Id="T1452078466709"/>
         <TransitionRef Id="T1448473268060"/>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="Validation Manager"/>
      <ExtendedAttribute Name="fr_description"  Value="Valider une mission"/>
      <ExtendedAttribute Name="XOffset" Value="332"/>
      <ExtendedAttribute Name="YOffset" Value="340"/>
      <ExtendedAttribute Name="Width" Value="185"/>
      <ExtendedAttribute Name="Height" Value="41"/>
      <ExtendedAttribute Name="State" Value="0"/>
      <ExtendedAttribute Name="Handlers" Value="HandlerList" >
<plugin en="Detect events" fr="D&#233;tection d&apos;&#233;v&#233;nements">
  <entries>
    <activity.state.Eligible>
      <action>1452522071084</action>
    </activity.state.Eligible>
  </entries>
</plugin>

      </ExtendedAttribute>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1448472625633" Name="">
     <Description></Description>
     <Implementation>
      <Tool Id="MeiboView" Type="APPLICATION">
       <ActualParameters>
        <ActualParameter>Mission</ActualParameter>
        <ActualParameter>MissionValidate</ActualParameter>
        <ActualParameter>missionDN</ActualParameter>
       </ActualParameters>
      </Tool>
     </Implementation>
     <Performer>PROCESS.ROLE_SecondLevelValidation</Performer>
     <Priority>1</Priority>
      <Deadline Execution="ASYNCHR">
       <DeadlineCondition>DELAY 2 day</DeadlineCondition>
       <ExceptionName>rappel1</ExceptionName>
      </Deadline>
     <StartMode>Manual</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="XOR"/>
       <Split Type="XOR">
        <TransitionRefs>
         <TransitionRef Id="T1448473765695"/>
         <TransitionRef Id="T1448473752360"/>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="Validation DDI"/>
      <ExtendedAttribute Name="fr_description"  Value="Valider une mission"/>
      <ExtendedAttribute Name="XOffset" Value="0"/>
      <ExtendedAttribute Name="YOffset" Value="556"/>
      <ExtendedAttribute Name="Width" Value="269"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1448472836106" Name="">
     <Description></Description>
     <Route/>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Manual</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="XOR"/>
       <Split Type="XOR">
        <TransitionRefs>
         <TransitionRef Id="T1448473616152"/>
         <TransitionRef Id="T1448472950998"/>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="route"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="320"/>
      <ExtendedAttribute Name="YOffset" Value="460"/>
      <ExtendedAttribute Name="Width" Value="120"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1448473028474" Name="">
     <Description></Description>
     <Implementation>
      <No/>
     </Implementation>
     <Performer>PROCESS.ROLE-Participant</Performer>
     <Priority>1</Priority>
      <Deadline Execution="SYNCHR">
       <DeadlineCondition>VARIABLE firstEventStartDate</DeadlineCondition>
       <ExceptionName>horsD&#233;lai</ExceptionName>
      </Deadline>
     <StartMode>Manual</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="XOR"/>
       <Split Type="XOR">
        <TransitionRefs>
         <TransitionRef Id="T1448527696302"/>
         <TransitionRef Id="T1452079411023"/>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="Compl&#232;te demande"/>
      <ExtendedAttribute Name="fr_description"  Value="Compl&#233;ter une demande de mission pour son organisation"/>
      <ExtendedAttribute Name="XOffset" Value="344"/>
      <ExtendedAttribute Name="YOffset" Value="672"/>
      <ExtendedAttribute Name="Width" Value="201"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1448473223019" Name="">
     <Description></Description>
     <Implementation>
      <Tool Id="MeiboView" Type="APPLICATION">
       <ActualParameters>
        <ActualParameter>Mission</ActualParameter>
        <ActualParameter>MissionCreate</ActualParameter>
        <ActualParameter>missionDN</ActualParameter>
       </ActualParameters>
      </Tool>
     </Implementation>
     <Performer>PROCESS.ROLE-Participant</Performer>
     <Priority>1</Priority>
      <Deadline Execution="SYNCHR">
       <DeadlineCondition>VARIABLE firstEventStartDate</DeadlineCondition>
       <ExceptionName>horsD&#233;lai</ExceptionName>
      </Deadline>
     <StartMode>Manual</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="XOR"/>
       <Split Type="XOR">
        <TransitionRefs>
         <TransitionRef Id="T1448473468781"/>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="Modifie demande"/>
      <ExtendedAttribute Name="fr_description"  Value="Modifier une demande de mission"/>
      <ExtendedAttribute Name="XOffset" Value="484"/>
      <ExtendedAttribute Name="YOffset" Value="556"/>
      <ExtendedAttribute Name="Width" Value="189"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
      <ExtendedAttribute Name="Handlers" Value="HandlerList" >
<plugin en="Detect events" fr="D&#233;tection d&apos;&#233;v&#233;nements">
  <entries>
    <activity.state.Eligible>
      <action>1452524978986</action>
    </activity.state.Eligible>
  </entries>
</plugin>

      </ExtendedAttribute>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1448473316383" Name="">
     <Description></Description>
     <Route/>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Manual</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="XOR"/>
       <Split Type="XOR">
        <TransitionRefs>
         <TransitionRef Id="T1448473472486"/>
         <TransitionRef Id="T1452260326665"/>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="d&#233;cision demandeur"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="728"/>
      <ExtendedAttribute Name="YOffset" Value="636"/>
      <ExtendedAttribute Name="Width" Value="205"/>
      <ExtendedAttribute Name="Height" Value="45"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1448527318016" Name="">
     <Description></Description>
     <Implementation>
      <SubFlow>
       <Id>1449063509239</Id>
       <Execution>SYNCHR</Execution>
       <ActualParameters>
        <ActualParameter>userDN</ActualParameter>
        <ActualParameter>isMission</ActualParameter>
       </ActualParameters>
      </SubFlow>
     </Implementation>
     <Performer></Performer>
     <Priority>1</Priority>
      <Deadline Execution="SYNCHR">
       <DeadlineCondition></DeadlineCondition>
       <ExceptionName>horsD&#233;lai</ExceptionName>
      </Deadline>
     <StartMode>Automatic</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="XOR"/>
       <Split Type="XOR">
        <TransitionRefs>
         <TransitionRef Id="T1449065800871"/>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="OrganiseDeplacement"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="652"/>
      <ExtendedAttribute Name="YOffset" Value="756"/>
      <ExtendedAttribute Name="Width" Value="205"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
      <ExtendedAttribute Name="numberSubflowToLaunch" Value="1"/>
      <ExtendedAttribute Name="fr_titleParameter"  Value="Organisation D&#233;placement mission {userDn}"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1448527724520" Name="">
     <Description></Description>
     <Implementation>
      <Tool Id="MeiboScript" Type="SCRIPT">
       <ActualParameters>
        <ActualParameter>var /*String*/ missionID = meibo.getWorkflowVariable(&quot;missionID&quot;); 
var /*String*/ ownerID = meibo.getWorkflowVariable(&quot;participantID&quot;);
var /*String*/ ownerDN = meibo.getWorkflowVariable(&quot;participantDN&quot;);

meibo.logDebug(&quot;Abandon automatique de la mission &quot; + missionID + &quot; pour &quot; + ownerDN + &quot;; le d&#233;lai est expir&#233;&quot;); 
updateMissionStatus(missionID, ownerID, &quot;CAN&quot;, &quot;Abandon automatique, d&#233;lai expir&#233;&quot;);</ActualParameter>
       </ActualParameters>
      </Tool>
     </Implementation>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Automatic</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="XOR"/>
       <Split Type="XOR">
        <TransitionRefs>
         <TransitionRef Id="T1449141870986"/>
         <TransitionRef Id="T1449136047940"/>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="Abandon Automatique"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="1644"/>
      <ExtendedAttribute Name="YOffset" Value="704"/>
      <ExtendedAttribute Name="Width" Value="189"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1448527961473" Name="">
     <Description></Description>
     <Implementation>
      <No/>
     </Implementation>
     <Performer>PROCESS.ROLE-Participant</Performer>
     <Priority>2</Priority>
      <Deadline Execution="SYNCHR">
       <DeadlineCondition></DeadlineCondition>
       <ExceptionName>horsD&#233;lai</ExceptionName>
      </Deadline>
      <Deadline Execution="ASYNCHR">
       <DeadlineCondition>VARIABLE </DeadlineCondition>
       <ExceptionName>d&#233;partProche</ExceptionName>
      </Deadline>
     <StartMode>Manual</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="XOR"/>
       <Split Type="XOR">
        <TransitionRefs>
         <TransitionRef Id="T1452592386838"/>
         <TransitionRef Id="T1448531893154"/>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="EditeOrdreDeMission"/>
      <ExtendedAttribute Name="fr_description"  Value="Editer un ordre de mission"/>
      <ExtendedAttribute Name="XOffset" Value="456"/>
      <ExtendedAttribute Name="YOffset" Value="836"/>
      <ExtendedAttribute Name="Width" Value="217"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1448531734892" Name="">
     <Description></Description>
     <Implementation>
      <No/>
     </Implementation>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Automatic</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="AND"/>
       <Split Type="AND">
        <TransitionRefs>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="notif pour annulation organisation"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="864"/>
      <ExtendedAttribute Name="YOffset" Value="916"/>
      <ExtendedAttribute Name="Width" Value="253"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1448531857602" Name="">
     <Description></Description>
     <Route/>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Manual</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="AND"/>
       <Split Type="AND">
        <TransitionRefs>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value=""/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="832"/>
      <ExtendedAttribute Name="YOffset" Value="860"/>
      <ExtendedAttribute Name="Width" Value="120"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1448536722066" Name="">
     <Description></Description>
     <Implementation>
      <No/>
     </Implementation>
     <Performer>OrganisateurVoyage</Performer>
     <Priority>1</Priority>
      <Deadline Execution="ASYNCHR">
       <DeadlineCondition>DELAY 2 day</DeadlineCondition>
       <ExceptionName>rappel1</ExceptionName>
      </Deadline>
      <Deadline Execution="ASYNCHR">
       <DeadlineCondition></DeadlineCondition>
       <ExceptionName>escalade</ExceptionName>
      </Deadline>
      <Deadline Execution="SYNCHR">
       <DeadlineCondition>VARIABLE firstEventStartDate</DeadlineCondition>
       <ExceptionName>horsDelai</ExceptionName>
      </Deadline>
     <StartMode>Manual</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="AND"/>
       <Split Type="AND">
        <TransitionRefs>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="EstimationCout"/>
      <ExtendedAttribute Name="fr_description"  Value="Estimer le co&#251;t d&apos;une mission"/>
      <ExtendedAttribute Name="XOffset" Value="824"/>
      <ExtendedAttribute Name="YOffset" Value="208"/>
      <ExtendedAttribute Name="Width" Value="161"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1448545744181" Name="">
     <Description></Description>
     <Implementation>
      <No/>
     </Implementation>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Automatic</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="AND"/>
       <Split Type="AND">
        <TransitionRefs>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="Relance"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="32"/>
      <ExtendedAttribute Name="YOffset" Value="640"/>
      <ExtendedAttribute Name="Width" Value="120"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1448545874035" Name="">
     <Description></Description>
     <Implementation>
      <No/>
     </Implementation>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Manual</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="AND"/>
       <Split Type="AND">
        <TransitionRefs>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="Relance"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="588"/>
      <ExtendedAttribute Name="YOffset" Value="348"/>
      <ExtendedAttribute Name="Width" Value="120"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1448546285917" Name="">
     <Description></Description>
     <Implementation>
      <No/>
     </Implementation>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Automatic</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="AND"/>
       <Split Type="AND">
        <TransitionRefs>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="Relance"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="1056"/>
      <ExtendedAttribute Name="YOffset" Value="208"/>
      <ExtendedAttribute Name="Width" Value="120"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1448546524800" Name="">
     <Description></Description>
     <Route/>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Manual</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="AND"/>
       <Split Type="AND">
        <TransitionRefs>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value=""/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="428"/>
      <ExtendedAttribute Name="YOffset" Value="280"/>
      <ExtendedAttribute Name="Width" Value="101"/>
      <ExtendedAttribute Name="Height" Value="37"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1448557363960" Name="">
     <Description></Description>
     <Implementation>
      <Tool Id="MeiboScript" Type="SCRIPT">
       <ActualParameters>
        <ActualParameter></ActualParameter>
       </ActualParameters>
      </Tool>
     </Implementation>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Automatic</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="AND"/>
       <Split Type="AND">
        <TransitionRefs>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="rappel D&#233;part"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="416"/>
      <ExtendedAttribute Name="YOffset" Value="924"/>
      <ExtendedAttribute Name="Width" Value="120"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1449135987735" Name="">
     <Description></Description>
     <Implementation>
      <Tool Id="MeiboScript" Type="SCRIPT">
       <ActualParameters>
        <ActualParameter>var participantDn = meibo.getWorkflowVariable(&quot;participantDN&quot;);
var missionID = meibo.getWorkflowVariable(&quot;missionID&quot;);
var user = meibo.getWorkflowVariable(&quot;participantDisplayName&quot;);

// notification
var email = meibo.getWorkflowVariable(&quot;participantEmail&quot;);
if(email==null){
  meibo.logWarn(&quot;Impossible de notifier &quot; + participantDn + &quot; car il n&apos;a pas d&apos;email&quot;);
}else{
  var /*Parameters*/ params = new Parameters();
  params.add(&quot;MAIL_HEADER&quot;, returnEmpty(getMailParameter(&quot;MAIL_HEADER&quot;)));
  params.add(&quot;MAIL_FOOTER&quot;, returnEmpty(getMailParameter(&quot;MAIL_FOOTER&quot;)));
  params.add(&quot;MAIL_LINKNAME&quot;, returnEmpty(getMailParameter(&quot;MAIL_LINKNAME&quot;)));
  params.add(&quot;MAIL_SENDER&quot;, getMailParameter(&quot;MAIL_SENDER&quot;));
  params.add(&quot;user&quot;, user);
  params.add(&quot;missionID&quot;, missionID);
  params.add(&quot;recipient&quot;, email);  
  params.add(&quot;participantDN&quot;, participantDn);  
  meibo.executePlugin(&quot;NotifyMissionCanceled&quot;,params);
}</ActualParameter>
       </ActualParameters>
      </Tool>
     </Implementation>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Automatic</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="XOR"/>
       <Split Type="XOR">
        <TransitionRefs>
         <TransitionRef Id="T1449136074946"/>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="notification"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="1248"/>
      <ExtendedAttribute Name="YOffset" Value="852"/>
      <ExtendedAttribute Name="Width" Value="133"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1449139919375" Name="">
     <Description></Description>
     <Route/>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Manual</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="XOR"/>
       <Split Type="XOR">
        <TransitionRefs>
         <TransitionRef Id="T1452078449254"/>
         <TransitionRef Id="T1449140025000"/>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value=""/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="132"/>
      <ExtendedAttribute Name="YOffset" Value="280"/>
      <ExtendedAttribute Name="Width" Value="120"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1449244633439" Name="">
     <Description></Description>
     <Implementation>
      <Tool Id="MeiboView" Type="APPLICATION">
       <ActualParameters>
        <ActualParameter>Mission</ActualParameter>
        <ActualParameter>MissionAccept</ActualParameter>
        <ActualParameter>missionDN</ActualParameter>
       </ActualParameters>
      </Tool>
     </Implementation>
     <Performer>PROCESS.ROLE-Participant</Performer>
     <Priority>1</Priority>
      <Deadline Execution="SYNCHR">
       <DeadlineCondition>VARIABLE </DeadlineCondition>
       <ExceptionName>horsD&#233;lai</ExceptionName>
      </Deadline>
      <Deadline Execution="ASYNCHR">
       <DeadlineCondition>CALENDAR_DELAY 2 day</DeadlineCondition>
       <ExceptionName>relance</ExceptionName>
      </Deadline>
     <StartMode>Manual</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="AND"/>
       <Split Type="XOR">
        <TransitionRefs>
         <TransitionRef Id="T1452072030730"/>
         <TransitionRef Id="T1452014277554"/>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="Accepter mission"/>
      <ExtendedAttribute Name="fr_description"  Value="Accepter une mission"/>
      <ExtendedAttribute Name="XOffset" Value="420"/>
      <ExtendedAttribute Name="YOffset" Value="104"/>
      <ExtendedAttribute Name="Width" Value="201"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
      <ExtendedAttribute Name="Handlers" Value="HandlerList" >
<plugin en="Detect events" fr="D&#233;tection d&apos;&#233;v&#233;nements">
  <entries>
    <activity.state.Eligible>
      <action>1452270989283</action>
    </activity.state.Eligible>
  </entries>
</plugin>

      </ExtendedAttribute>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1449244931030" Name="">
     <Description></Description>
     <Implementation>
      <No/>
     </Implementation>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Automatic</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="AND"/>
       <Split Type="AND">
        <TransitionRefs>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="Relance"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="680"/>
      <ExtendedAttribute Name="YOffset" Value="132"/>
      <ExtendedAttribute Name="Width" Value="120"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1449245333752" Name="">
     <Description></Description>
     <Implementation>
      <Tool Id="MeiboScript" Type="SCRIPT">
       <ActualParameters>
        <ActualParameter>var /*Set*/ notificationRoleSet = meibo.setWorkflowVariable(&quot;notificationRoles&quot;);
if(!notificationRoleSet.isEmpty()){
//TODO notifications DDI ou autre en fonction de notificationRoleSet
}</ActualParameter>
       </ActualParameters>
      </Tool>
     </Implementation>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Automatic</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="AND"/>
       <Split Type="AND">
        <TransitionRefs>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="Notifications"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="676"/>
      <ExtendedAttribute Name="YOffset" Value="972"/>
      <ExtendedAttribute Name="Width" Value="125"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1452014265043" Name="">
     <Description></Description>
     <Route/>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Manual</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="AND"/>
       <Split Type="AND">
        <TransitionRefs>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value=""/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="808"/>
      <ExtendedAttribute Name="YOffset" Value="328"/>
      <ExtendedAttribute Name="Width" Value="120"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1452071850125" Name="">
     <Description></Description>
     <Implementation>
      <Tool Id="MeiboScript" Type="SCRIPT">
       <ActualParameters>
        <ActualParameter>var /*String*/ missionDN = meibo.getWorkflowVariable(&quot;missionDN&quot;); 
var /*Entry*/ missionEntry = meibo.getDnEntry(&quot;Mission&quot;, missionDN);
if((missionEntry.TMN_ESTIMATED_COST[0]!=null) &amp;&amp; (missionEntry.TMN_ESTIMATED_COST[0]!=&quot;&quot;)){
  meibo.setWorkflowVariable(&quot;costDefined&quot;,&quot;true&quot;); 
}else{
  meibo.setWorkflowVariable(&quot;costDefined&quot;,&quot;false&quot;);
}</ActualParameter>
       </ActualParameters>
      </Tool>
     </Implementation>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Automatic</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="XOR"/>
       <Split Type="XOR">
        <TransitionRefs>
         <TransitionRef Id="T1452071956127"/>
         <TransitionRef Id="T1452071980389"/>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="verifieCout"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="288"/>
      <ExtendedAttribute Name="YOffset" Value="196"/>
      <ExtendedAttribute Name="Width" Value="120"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1452078418181" Name="">
     <Description></Description>
     <Route/>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Manual</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="XOR"/>
       <Split Type="AND">
        <TransitionRefs>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value=""/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="96"/>
      <ExtendedAttribute Name="YOffset" Value="400"/>
      <ExtendedAttribute Name="Width" Value="120"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1452260216937" Name="">
     <Description></Description>
     <Implementation>
      <Tool Id="MeiboScript" Type="SCRIPT">
       <ActualParameters>
        <ActualParameter>var /*String*/ missionID = meibo.getWorkflowVariable(&quot;missionID&quot;); 
var /*String*/ ownerID = meibo.getWorkflowVariable(&quot;participantID&quot;);
var /*String*/ ownerDN = meibo.getWorkflowVariable(&quot;participantDN&quot;);

meibo.logDebug(&quot;Abandon explicite de la mission &quot; + missionID + &quot; pour &quot; + ownerDN); 
updateMissionStatus(missionID, ownerID, &quot;CAN&quot;, &quot;&quot;);</ActualParameter>
       </ActualParameters>
      </Tool>
     </Implementation>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Automatic</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="XOR"/>
       <Split Type="XOR">
        <TransitionRefs>
         <TransitionRef Id="T1452260261334"/>
         <TransitionRef Id="T1452260241541"/>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="Abandon"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="1204"/>
      <ExtendedAttribute Name="YOffset" Value="788"/>
      <ExtendedAttribute Name="Width" Value="120"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
   </Activities>
   <Transitions>
    <Transition Id="T1448472522446" Name="T1448472522446" From="A1448472295866" To="A1448472369326"/>
    <Transition Id="T1448472950998" Name="T1448472950998" From="A1448472836106" To="A1448472625633">
     <Condition Type="OTHERWISE"></Condition>
    </Transition>
    <Transition Id="T1448473268060" Name="T1448473268060" From="A1448472568550" To="A1448473223019">
     <Condition Type="OTHERWISE"></Condition>
    </Transition>
    <Transition Id="T1448473468781" Name="T1448473468781" From="A1448473223019" To="A1448473316383"/>
    <Transition Id="T1448473472486" Name="T1448473472486" From="A1448473316383" To="A1448472568550">
     <Condition Type="CONDITION">missionModified==&quot;true&quot;</Condition>
    </Transition>
    <Transition Id="T1448473616152" Name="T1448473616152" From="A1448472836106" To="A1448473028474">
     <Condition Type="CONDITION">secondValidationRoles.isEmpty()</Condition>
    </Transition>
    <Transition Id="T1448473752360" Name="T1448473752360" From="A1448472625633" To="A1448473223019">
     <Condition Type="OTHERWISE"></Condition>
    </Transition>
    <Transition Id="T1448473765695" Name="T1448473765695" From="A1448472625633" To="A1448473028474">
     <Condition Type="CONDITION">secondLevelValidated==&quot;true&quot;</Condition>
    </Transition>
    <Transition Id="T1448527696302" Name="T1448527696302" From="A1448473028474" To="A1448527318016">
     <Condition Type="CONDITION">completedForOrganisation==&quot;true&quot;</Condition>
    </Transition>
    <Transition Id="T1448531893154" Name="T1448531893154" From="A1448527961473" To="A1448531857602">
     <Condition Type="OTHERWISE"></Condition>
    </Transition>
    <Transition Id="T1448531937565" Name="T1448531937565" From="A1448531857602" To="A1448531734892"/>
    <Transition Id="T1448545497555" Name="T1448545497555" From="A1448527961473" To="A1448527724520">
     <Condition Type="EXCEPTION">horsD&#233;lai</Condition>
    </Transition>
    <Transition Id="T1448545610687" Name="T1448545610687" From="A1448527318016" To="A1448527724520">
     <Condition Type="EXCEPTION">horsD&#233;lai</Condition>
    </Transition>
    <Transition Id="T1448545750717" Name="T1448545750717" From="A1448472625633" To="A1448545744181">
     <Condition Type="EXCEPTION">rappel1</Condition>
    </Transition>
    <Transition Id="T1448545879483" Name="T1448545879483" From="A1448472568550" To="A1448545874035">
     <Condition Type="EXCEPTION">rappel1</Condition>
    </Transition>
    <Transition Id="T1448546325583" Name="T1448546325583" From="A1448536722066" To="A1448546285917">
     <Condition Type="EXCEPTION">rappel1</Condition>
    </Transition>
    <Transition Id="T1448546538767" Name="T1448546538767" From="A1448536722066" To="A1448546524800">
     <Condition Type="EXCEPTION">escalade</Condition>
    </Transition>
    <Transition Id="T1449065723371" Name="T1449065723371" From="A1448527961473" To="A1448557363960">
     <Condition Type="EXCEPTION">d&#233;partProche</Condition>
    </Transition>
    <Transition Id="T1449065800871" Name="T1449065800871" From="A1448527318016" To="A1448527961473"/>
    <Transition Id="T1449136047940" Name="T1449136047940" From="A1448527724520" To="A1449135987735">
     <Condition Type="OTHERWISE"></Condition>
    </Transition>
    <Transition Id="T1449136074946" Name="T1449136074946" From="A1449135987735" To="A1448472343512"/>
    <Transition Id="T1449140025000" Name="T1449140025000" From="A1449139919375" To="A1448472568550">
     <Condition Type="OTHERWISE"></Condition>
    </Transition>
    <Transition Id="T1449140155934" Name="T1449140155934" From="A1448536722066" To="A1449139919375"/>
    <Transition Id="T1449140168470" Name="T1449140168470" From="A1448546524800" To="A1449139919375"/>
    <Transition Id="T1449141870986" Name="T1449141870986" From="A1448527724520" To="A1448472343512">
     <Condition Type="CONDITION">isDG==&quot;true&quot;</Condition>
    </Transition>
    <Transition Id="T1449244728738" Name="T1449244728738" From="A1449244633439" To="A1448527724520">
     <Condition Type="EXCEPTION">horsD&#233;lai</Condition>
    </Transition>
    <Transition Id="T1449244943062" Name="T1449244943062" From="A1449244633439" To="A1449244931030">
     <Condition Type="EXCEPTION">relance</Condition>
    </Transition>
    <Transition Id="T1452014277554" Name="T1452014277554" From="A1449244633439" To="A1452014265043">
     <Condition Type="OTHERWISE"></Condition>
    </Transition>
    <Transition Id="T1452071956127" Name="T1452071956127" From="A1452071850125" To="A1449139919375">
     <Condition Type="CONDITION">costDefined==&quot;true&quot;</Condition>
    </Transition>
    <Transition Id="T1452071980389" Name="T1452071980389" From="A1452071850125" To="A1448536722066">
     <Condition Type="OTHERWISE"></Condition>
    </Transition>
    <Transition Id="T1452072000756" Name="T1452072000756" From="A1448472369326" To="A1452071850125">
     <Condition Type="CONDITION">participantID==initiatorID</Condition>
    </Transition>
    <Transition Id="T1452072030730" Name="T1452072030730" From="A1449244633439" To="A1452071850125">
     <Condition Type="CONDITION">accepted==&quot;true&quot;</Condition>
    </Transition>
    <Transition Id="T1452078449254" Name="T1452078449254" From="A1449139919375" To="A1452078418181">
     <Condition Type="CONDITION">isDG==&quot;true&quot;</Condition>
    </Transition>
    <Transition Id="T1452078466709" Name="T1452078466709" From="A1448472568550" To="A1452078418181">
     <Condition Type="CONDITION">managerValidated==&quot;true&quot;</Condition>
    </Transition>
    <Transition Id="T1452078534818" Name="T1452078534818" From="A1452078418181" To="A1448472836106"/>
    <Transition Id="T1452079024406" Name="T1452079024406" From="A1448536722066" To="A1448527724520">
     <Condition Type="EXCEPTION">horsDelai</Condition>
    </Transition>
    <Transition Id="T1452079250689" Name="T1452079250689" From="A1448472568550" To="A1448527724520">
     <Condition Type="EXCEPTION">horsD&#233;lai1</Condition>
    </Transition>
    <Transition Id="T1452079411023" Name="T1452079411023" From="A1448473028474" To="A1448473316383">
     <Condition Type="OTHERWISE"></Condition>
    </Transition>
    <Transition Id="T1452079443088" Name="T1452079443088" From="A1448473028474" To="A1448527724520">
     <Condition Type="EXCEPTION">horsD&#233;lai</Condition>
    </Transition>
    <Transition Id="T1452079538108" Name="T1452079538108" From="A1448473223019" To="A1448527724520">
     <Condition Type="EXCEPTION">horsD&#233;lai</Condition>
    </Transition>
    <Transition Id="T1452245070560" Name="T1452245070560" From="A1448472369326" To="A1449244633439">
     <Condition Type="OTHERWISE"></Condition>
    </Transition>
    <Transition Id="T1452260241541" Name="T1452260241541" From="A1452260216937" To="A1449135987735">
     <Condition Type="OTHERWISE"></Condition>
    </Transition>
    <Transition Id="T1452260261334" Name="T1452260261334" From="A1452260216937" To="A1448472343512">
     <Condition Type="CONDITION">isDG==&quot;true&quot;</Condition>
    </Transition>
    <Transition Id="T1452260301879" Name="T1452260301879" From="A1452014265043" To="A1452260216937"/>
    <Transition Id="T1452260326665" Name="T1452260326665" From="A1448473316383" To="A1452260216937">
     <Condition Type="OTHERWISE"></Condition>
    </Transition>
    <Transition Id="T1452260346922" Name="T1452260346922" From="A1448531857602" To="A1452260216937"/>
    <Transition Id="T1452592386838" Name="T1452592386838" From="A1448527961473" To="A1449245333752">
     <Condition Type="CONDITION">finalConfirmation==&quot;true&quot;</Condition>
    </Transition>
    <Transition Id="T1452592394901" Name="T1452592394901" From="A1449245333752" To="A1448472343512"/>
    <Transition Id="T1452592675661" Name="T1452592675661" From="A1448472568550" To="A1448472836106">
     <Condition Type="EXCEPTION">escaladeDDI</Condition>
    </Transition>
   </Transitions>
  </WorkflowProcess>
  <WorkflowProcess AccessLevel="PUBLIC" Id="1448472291649" Name="Mission">
   <ProcessHeader DurationUnit="D">
    <Description>Processus Meibo</Description>
   </ProcessHeader>
   <RedefinableHeader PublicationStatus="RELEASED">
    <Author>Meibo</Author>
    <Version>3</Version>
   </RedefinableHeader>
   <ExtendedAttributes>
    <ExtendedAttribute Name="scale"  Value="100%"/>
    <ExtendedAttribute Name="role"  Value="AdminMeibo"/>
    <ExtendedAttribute Name="role"  Value="InitiateurDeplacement"/>
    <ExtendedAttribute Name="role"  Value="Studio"/>
    <ExtendedAttribute Name="role"  Value="Utilisateur"/>
    <ExtendedAttribute Name="fr_name"  Value="Mission"/>
    <ExtendedAttribute Name="fr_description"  Value=""/>
    <ExtendedAttribute Name="actionsList" Value="">
      <Action Name="Initialisation" Type="workflowScriptImplementation" ID="1448472454995">
      </Action>
      <Action Name="Notifier" Type="pluginMail-1" ID="1448472764360">
      </Action>
      <Action Name="acceptationEligible" Type="workflowScriptImplementation" ID="1452270989283">
// affectation du role
var participantDn = meibo.getWorkflowVariable(&quot;participantDN&quot;);
var /*String*/ missionID = meibo.getWorkflowVariable(&quot;missionID&quot;); 
meibo.setWorkflowVariable(&quot;ROLE-Participant&quot;, participantDn); 

var /*WapiWorkItem*/ wapiworkitem = meibo.getCurrentWorkflowTask();
meibo.logInfo(&quot;Affectation de la tache (&quot; + wapiworkitem.getId() + &quot;) d&apos;acceptation de mission &quot; + missionID + &quot; &#224; &quot; + participantDn);

// notification
var email = meibo.getWorkflowVariable(&quot;participantEmail&quot;);
if(email==null){
  meibo.logWarn(&quot;Impossible de notifier &quot; + participantDn + &quot; car il n&apos;a pas d&apos;email&quot;);
}else{
  var /*Parameters*/ params = new Parameters();
  params.add(&quot;MAIL_HEADER&quot;, returnEmpty(getMailParameter(&quot;MAIL_HEADER&quot;)));
  params.add(&quot;MAIL_FOOTER&quot;, returnEmpty(getMailParameter(&quot;MAIL_FOOTER&quot;)));
  params.add(&quot;MAIL_LINKNAME&quot;, returnEmpty(getMailParameter(&quot;MAIL_LINKNAME&quot;)));
  params.add(&quot;MAIL_SENDER&quot;, getMailParameter(&quot;MAIL_SENDER&quot;));
  //params.add(&quot;participantDN&quot;, meibo.getWorkflowVariable(&quot;participantDN&quot;));
  params.add(&quot;recipient&quot;, email);
  meibo.executePlugin(&quot;NotifyParticipantForAcceptation&quot;,params);
}
      </Action>
      <Action Name="managerValidationEligible" Type="workflowScriptImplementation" ID="1452522071084">
///$debug
var /*String*/ participantDn = meibo.getWorkflowVariable(&quot;participantDN&quot;);
var /*String*/ missionID = meibo.getWorkflowVariable(&quot;missionID&quot;); 
var /*String*/ user = meibo.getWorkflowVariable(&quot;participantDisplayName&quot;);

var /*ResultSet*/ managerRs = getManager(participantDn);
var /*WapiWorkItem*/ wapiworkitem = meibo.getCurrentWorkflowTask();
meibo.logDebug(&quot;getCurrentWorkflowTask : &quot; + wapiworkitem);
var /*UserTask*/ userTask = meibo.getWorkflowUserTask()
meibo.logDebug(&quot;getWorkflowUserTask : &quot; + userTask);

if(managerRs.getEntryCount()&gt;0){
  // affectation du role
  var /*Entry*/ managerEntry = managerRs.getEntry();
  meibo.setWorkflowVariable(&quot;ROLE-Manager&quot;, managerEntry.dn[0]); 
  meibo.logInfo(&quot;Affectation de la tache (&quot; + wapiworkitem.getId() + &quot;) de validation de la mission &quot; + missionID + &quot; &#224; &quot; + managerEntry.dn[0] + &quot; pour &quot; + participantDn);

  // notification
  var email = meibo.getWorkflowVariable(&quot;participantEmail&quot;);
  if(email==null){
    meibo.logWarn(&quot;Impossible de notifier &quot; + participantDn + &quot; car il n&apos;a pas d&apos;email&quot;);
  }else{
    var /*Parameters*/ params = new Parameters();
    params.add(&quot;MAIL_HEADER&quot;, returnEmpty(getMailParameter(&quot;MAIL_HEADER&quot;)));
    params.add(&quot;MAIL_FOOTER&quot;, returnEmpty(getMailParameter(&quot;MAIL_FOOTER&quot;)));
    params.add(&quot;MAIL_LINKNAME&quot;, returnEmpty(getMailParameter(&quot;MAIL_LINKNAME&quot;)));
    params.add(&quot;MAIL_SENDER&quot;, getMailParameter(&quot;MAIL_SENDER&quot;));
    params.add(&quot;user&quot;, user);
    params.add(&quot;missionID&quot;, missionID);
    params.add(&quot;recipient&quot;, email);
    params.add(&quot;participantDN&quot;, participantDn);
    
    meibo.executePlugin(&quot;NotifyForValidation&quot;,params);
  }
}else{
  meibo.logWarn(&quot;Pas de manager trouv&#233; pour &quot; + participantDn);
  //TODO : voire comment traiter; par d&#233;faut le workflow resterait bloqu&#233;
  wapiworkitem.complete();
}
      </Action>
      <Action Name="modificationEligible" Type="workflowScriptImplementation" ID="1452524978986">
// affectation du role
var participantDn = meibo.getWorkflowVariable(&quot;participantDN&quot;);
var /*String*/ missionID = meibo.getWorkflowVariable(&quot;missionID&quot;); 
var /*String*/ reason = meibo.getWorkflowVariable(&quot;comment&quot;); 
meibo.setWorkflowVariable(&quot;ROLE-Participant&quot;, participantDn); 

var /*WapiWorkItem*/ wapiworkitem = meibo.getCurrentWorkflowTask();
meibo.logInfo(&quot;Affectation de la tache (&quot; + wapiworkitem.getId() + &quot;) de modification de mission &quot; + missionID + &quot; &#224; &quot; + participantDn);

// notification
var email = meibo.getWorkflowVariable(&quot;participantEmail&quot;);
if(email==null){
  meibo.logWarn(&quot;Impossible de notifier &quot; + participantDn + &quot; car il n&apos;a pas d&apos;email&quot;);
}else{
  var /*Parameters*/ params = new Parameters();
  params.add(&quot;MAIL_HEADER&quot;, returnEmpty(getMailParameter(&quot;MAIL_HEADER&quot;)));
  params.add(&quot;MAIL_FOOTER&quot;, returnEmpty(getMailParameter(&quot;MAIL_FOOTER&quot;)));
  params.add(&quot;MAIL_LINKNAME&quot;, returnEmpty(getMailParameter(&quot;MAIL_LINKNAME&quot;)));
  params.add(&quot;MAIL_SENDER&quot;, getMailParameter(&quot;MAIL_SENDER&quot;));
  params.add(&quot;recipient&quot;, email);
  params.add(&quot;reason&quot;, reason);
  meibo.executePlugin(&quot;NotifyRejection&quot;,params);
}
      </Action>
      <Action Name="secondLevelValidationEligible" Type="workflowScriptImplementation" ID="1452593973817">
var /*Set*/ validationRoleSet = meibo.setWorkflowVariable(&quot;secondValidationRoles&quot;); 
var /*Array*/ validationRoleArray = new Array(validationRoleSet.toArray());
meibo.setWorkflowVariable(&quot;ROLE_SecondLevelValidation&quot;, validationRoleArray);

var /*WapiWorkItem*/ wapiworkitem = meibo.getCurrentWorkflowTask();
meibo.logDebug(&quot;getCurrentWorkflowTask : &quot; + wapiworkitem);
var /*UserTask*/ userTask = meibo.getWorkflowUserTask()
meibo.logDebug(&quot;getWorkflowUserTask : &quot; + userTask);

meibo.logInfo(&quot;Affectation de la tache (&quot; + wapiworkitem.getId() + &quot;) de validation de la mission &quot; + missionID + &quot; &#224; &quot; + validationRoleArray + &quot; pour &quot; + participantDn);

if(!validationRoleSet.isEmpty()){

  // notification
  var email = meibo.getWorkflowVariable(&quot;participantEmail&quot;);
  //TODO recherche emails correspondant aux roles
  var targetUsers = getRecursiveGroupMembersFromGroupNames(validationRoleArray);
  if(targetUsers.isEmpty()){
    meibo.logWarn(&quot;Aucun utilisateur trouv&#233; avec les roles &quot; + validationRoleArray + &quot; pour validation de second niveau&quot;);
  }else{
    var secondLevelValidationPeople = new Array(targetUsers.toArray());
    meibo.setWorkflowVariable(&quot;secondLevelValidationPeople&quot;, secondLevelValidationPeople);

    var /*Parameters*/ params = new Parameters();
    params.add(&quot;MAIL_HEADER&quot;, returnEmpty(getMailParameter(&quot;MAIL_HEADER&quot;)));
    params.add(&quot;MAIL_FOOTER&quot;, returnEmpty(getMailParameter(&quot;MAIL_FOOTER&quot;)));
    params.add(&quot;MAIL_LINKNAME&quot;, returnEmpty(getMailParameter(&quot;MAIL_LINKNAME&quot;)));
    params.add(&quot;MAIL_SENDER&quot;, getMailParameter(&quot;MAIL_SENDER&quot;));
    params.add(&quot;user&quot;, user);
    params.add(&quot;missionID&quot;, missionID);
    params.add(&quot;recipient&quot;, email);
    params.add(&quot;participantDN&quot;, participantDn);
    
    meibo.executePlugin(&quot;NotifyForSecondLevelValidation&quot;,params);
  }
}else{
  // normalement &#231;a ne devrait pas arriver quand on passe par ici
  meibo.logDebug(&quot;Pas de role d&#233;fini pour validation de 2nd niveau&quot;);
  wapiworkitem.complete();
}
      </Action>
    </ExtendedAttribute>
   </ExtendedAttributes>
   <DataFields>
    <DataField Id="ROLE-Manager" IsArray="FALSE">
     <DataType>
      <BasicType Type="PERFORMER"/>
     </DataType>
     <InitialValue>0</InitialValue>
    </DataField>
    <DataField Id="ROLE-Initiateur" IsArray="FALSE">
     <DataType>
      <BasicType Type="PERFORMER"/>
     </DataType>
     <InitialValue>0</InitialValue>
    </DataField>
    <DataField Id="ROLE-Participant" IsArray="FALSE">
     <DataType>
      <BasicType Type="PERFORMER"/>
     </DataType>
     <InitialValue>0</InitialValue>
    </DataField>
    <DataField Id="missionDN" IsArray="FALSE">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </DataField>
    <DataField Id="accepted" IsArray="FALSE">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
     <InitialValue>false</InitialValue>
    </DataField>
    <DataField Id="costDefined" IsArray="FALSE">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
     <InitialValue>false</InitialValue>
    </DataField>
    <DataField Id="firstEventStartDate" IsArray="FALSE">
     <DataType>
      <BasicType Type="DEADLINE"/>
     </DataType>
     <InitialValue>01/01/16 10:24</InitialValue>
    </DataField>
    <DataField Id="MAIL_HEADER" IsArray="FALSE">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </DataField>
    <DataField Id="MAIL_FOOTER" IsArray="FALSE">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </DataField>
    <DataField Id="MAIL_SENDER" IsArray="FALSE">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </DataField>
    <DataField Id="participantCn" IsArray="FALSE">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </DataField>
    <DataField Id="participantEmail" IsArray="FALSE">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </DataField>
    <DataField Id="isDG" IsArray="FALSE">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
     <InitialValue>false</InitialValue>
    </DataField>
    <DataField Id="managerValidated" IsArray="FALSE">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
     <InitialValue>false</InitialValue>
    </DataField>
    <DataField Id="DDIvalidationRequired" IsArray="FALSE">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
     <InitialValue>true</InitialValue>
    </DataField>
    <DataField Id="notificationRoles" IsArray="FALSE">
     <DataType>
      <BasicType Type="OBJECT"/>
     </DataType>
    </DataField>
    <DataField Id="secondValidationRoles" IsArray="FALSE">
     <DataType>
      <BasicType Type="OBJECT"/>
     </DataType>
    </DataField>
    <DataField Id="finalConfirmation" IsArray="FALSE">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
     <InitialValue>false</InitialValue>
    </DataField>
    <DataField Id="completedForOrganisation" IsArray="FALSE">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
     <InitialValue>false</InitialValue>
    </DataField>
    <DataField Id="secondLevelValidated" IsArray="FALSE">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
     <InitialValue>false</InitialValue>
    </DataField>
    <DataField Id="missionModified" IsArray="FALSE">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
     <InitialValue>false</InitialValue>
    </DataField>
    <DataField Id="ROLE_SecondLevelValidation" IsArray="FALSE">
     <DataType>
      <BasicType Type="PERFORMER"/>
     </DataType>
    </DataField>
    <DataField Id="secondLevelValidationPeople" IsArray="TRUE">
     <DataType>
      <BasicType Type="OBJECT"/>
     </DataType>
    </DataField>
   </DataFields>
   <FormalParameters>
    <FormalParameter Id="participantDN" Index="23" Mode="IN">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="missionID" Index="24" Mode="IN">
     <DataType>
      <BasicType Type="INTEGER"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="initiatorDN" Index="25" Mode="IN">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="initiatorID" Index="26" Mode="IN">
     <DataType>
      <BasicType Type="INTEGER"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="participantID" Index="27" Mode="IN">
     <DataType>
      <BasicType Type="INTEGER"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="baseURL" Index="28" Mode="IN">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </FormalParameter>
    <FormalParameter Id="comment" Index="29" Mode="INOUT">
     <DataType>
      <BasicType Type="STRING"/>
     </DataType>
    </FormalParameter>
   </FormalParameters>
   <Participants>
    <Participant Id="AdminMeibo" Name="AdminMeibo">
     <ParticipantType Type="ROLE"/>
    </Participant>
    <Participant Id="AnalyseurDeplacement" Name="AnalyseurDeplacement">
     <ParticipantType Type="ROLE"/>
    </Participant>
    <Participant Id="DDI" Name="DDI">
     <ParticipantType Type="ROLE"/>
    </Participant>
    <Participant Id="InitiateurDeplacement" Name="InitiateurDeplacement">
     <ParticipantType Type="ROLE"/>
    </Participant>
    <Participant Id="OrganisateurVoyage" Name="OrganisateurVoyage">
     <ParticipantType Type="ROLE"/>
    </Participant>
    <Participant Id="Studio" Name="Studio">
     <ParticipantType Type="ROLE"/>
    </Participant>
    <Participant Id="Utilisateur" Name="Utilisateur">
     <ParticipantType Type="ROLE"/>
    </Participant>
   </Participants>
   <Activities>
    <Activity Id="A1448472295866" Name="">
     <Description></Description>
     <Route/>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Manual</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="AND"/>
       <Split Type="XOR">
        <TransitionRefs>
         <TransitionRef Id="T1448472522446"/>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="D&#233;but"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="96"/>
      <ExtendedAttribute Name="YOffset" Value="4"/>
      <ExtendedAttribute Name="Width" Value="120"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1448472343512" Name="">
     <Description></Description>
     <Route/>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Manual</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="XOR"/>
       <Split Type="AND">
        <TransitionRefs>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="Fin"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="992"/>
      <ExtendedAttribute Name="YOffset" Value="1024"/>
      <ExtendedAttribute Name="Width" Value="120"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1448472369326" Name="">
     <Description></Description>
     <Implementation>
      <Tool Id="MeiboScript" Type="SCRIPT">
       <ActualParameters>
        <ActualParameter>//$debug
var /*String*/ missionID = meibo.getWorkflowVariable(&quot;missionID&quot;); 
var /*String*/ missionDN = &quot;T_MISSION_TMN,TMN_ID,&quot; + missionID; 
meibo.setWorkflowVariable(&quot;missionDN&quot;, missionDN);
var /*String*/ ownerID = meibo.getWorkflowVariable(&quot;participantID&quot;);

meibo.setWorkflowVariable(&quot;MAIL_HEADER&quot;, returnEmpty(getMailParameter(&quot;MAIL_HEADER&quot;)));
meibo.setWorkflowVariable(&quot;MAIL_FOOTER&quot;, returnEmpty(getMailParameter(&quot;MAIL_FOOTER&quot;)));
meibo.setWorkflowVariable(&quot;MAIL_LINKNAME&quot;, returnEmpty(getMailParameter(&quot;MAIL_LINKNAME&quot;)));
meibo.setWorkflowVariable(&quot;MAIL_SENDER&quot;, getMailParameter(&quot;MAIL_SENDER&quot;));

var /*String*/ particpantLdapDN = null;
var /*Entry*/ personEntry = meibo.getDnEntry(&quot;TravelPeople&quot;,&quot;T_PERSON_PRS,PRS_ID,&quot; + ownerID, &quot;mail,ldapDn,PRS_LOGIN,displayName&quot;);
var participantEmail = personEntry.mail[0];
if((participantEmail==null) || (participantEmail==&quot;&quot;)){
  meibo.logWarn(&quot;Le participant &quot; + ownerID + &quot; n&apos;a pas d&apos;adresse email&quot;);
}else{
  meibo.setWorkflowVariable(&quot;participantEmail&quot;, participantEmail);
}
meibo.setWorkflowVariable(&quot;participantDN&quot;, personEntry.ldapDn[0]);
meibo.setWorkflowVariable(&quot;participantCn&quot;, personEntry.PRS_LOGIN[0]);
meibo.setWorkflowVariable(&quot;participantDisplayName&quot;, personEntry.displayName[0]);

var wfVariables = meibo.getWorkflowVariables(); // utile seulement en debug

meibo.logDebug(&quot;Initialisation workflow mission &quot; + missionID + &quot; pour &quot; + ownerID);

var /*Entry*/ missionEntry = meibo.getDnEntry(&quot;Mission&quot;, missionDN);

// recherche les caract&#233;ristiques des participications aux &#233;v&#232;nements :
// - 1ere date de d&#233;but de participation &#224; un &#233;venement (pour constituer l&apos;&#233;ch&#233;ance du workflow)
// - roles pour les validations et notifications en fonction de ces &#233;venements et participations
var /*ResultSet*/ missionEventRS = meibo.executeLink(&quot;MissionEvent&quot;, missionDN,&quot;fkTCT_ID,fkTES_ID,fkTTY_ID&quot;);
var /*ResultSet*/ eventAttendeesRS = null;
var /*Entry*/ eventAttendeesEntry = null;
var missionId=null;
var /*Date*/ eventStartDate = null;
var /*Date*/ overallStartDate = null;
var scopeID = null;
var evtTypeID = null;
var purposeID = null;
var involvementID = null;
var /*ResultSet*/ validationRoleRS = null;
var /*Entry*/ validationRoleEntry = null;
var /*Set*/ validationRoleSet = new java.util.HashSet();
var /*ResultSet*/ notificationRoleRS = null;
var /*Entry*/ notificationRoleEntry = null;
var /*Set*/ notificationRoleSet = new java.util.HashSet();

for each(var missionEvent in missionEventRS){
  missionId = missionEvent.fkTCT_ID[0] 
  eventAttendeesRS = meibo.executeResource(&quot;R_Attendees&quot;,&quot;PRS_ID=&quot;+ ownerID + &quot; AND TCT_ID=&quot;+missionId ,1,&quot;RAS_START_DATE,TPE_ID,TIN_ID&quot;);
  eventAttendeesEntry = eventAttendeesRS.getEntry();
  
  scopeID = missionEvent.fkTES_ID[0];
  evtTypeID = missionEvent.fkTTY_ID[0];
  purposeID = eventAttendeesEntry.TPE_ID[0];
  involvementID = eventAttendeesEntry.TIN_ID[0];

  // recherche des roles pour la 2eme validation (validation &quot;DDI&quot;)  
  validationRoleRS = meibo.executeSqlRequest(&quot;TRAVEL_BCOM&quot;,&quot;call get_travel_validation_roles(&apos;&quot;+ scopeID + &quot;&apos;,&apos;&quot; + evtTypeID + &quot;&apos;,&apos;&quot; + purposeID + &quot;&apos;,&apos;&quot; + involvementID + &quot;&apos;)&quot;,0); 
  for each(var validationRoleEntry in validationRoleRS){
    meibo.logDebug(&quot;ValidationRole : &quot; + validationRoleEntry);
    validationRoleSet.add(validationRoleEntry.ValidationRoles[0]);
  }
  meibo.setWorkflowVariable(&quot;secondValidationRoles&quot;, validationRoleSet);
  
  // recherche des roles pour la natification sans validation (notification &quot;DDI&quot;)  
  notificationRoleRS = meibo.executeSqlRequest(&quot;TRAVEL_BCOM&quot;,&quot;call get_travel_notified_roles(&apos;&quot;+ scopeID + &quot;&apos;,&apos;&quot; + evtTypeID + &quot;&apos;,&apos;&quot; + purposeID + &quot;&apos;,&apos;&quot; + involvementID + &quot;&apos;)&quot;,0); 
  for each(var notificationRoleEntry in notificationRoleRS){
    meibo.logDebug(&quot;ValidationRole : &quot; + notificationRoleEntry);   
    notificationRoleSet.add(notificationRoleEntry.ValidationRoles[0]); 
  }
  meibo.setWorkflowVariable(&quot;notificationRoles&quot;, notificationRoleSet);
  
  //1ere date de d&#233;but de participation &#224; un &#233;venement (pour constituer l&apos;&#233;ch&#233;ance du workflow)    
  eventStartDate = new Date(SQL_DATE_FORMAT.parse(eventAttendeesEntry.RAS_START_DATE[0]));
  if((overallStartDate==null) || (eventStartDate &lt; overallStartDate)){
    overallStartDate = eventStartDate;
  }
}
meibo.logDebug(&quot;Date d&apos;&#233;cheance workflow mission &quot; + missionID + &quot; : &quot; + overallStartDate.toLocaleString());
meibo.setWorkflowVariable(&quot;firstEventStartDate&quot;, new WAPIDeadline(overallStartDate));

// v&#233;rifie si le participant est Directeur G&#233;n&#233;ral
var parameters_groupsMapping = getProvisioningParameters_Droit();
var /*boolean*/isDG = userHasRole(personEntry.ldapDn[0], &quot;DG&quot;, parameters_groupsMapping);
meibo.setWorkflowVariable(&quot;isDG&quot;, &quot;&quot;+ isDG);</ActualParameter>
       </ActualParameters>
      </Tool>
     </Implementation>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Automatic</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="XOR"/>
       <Split Type="XOR">
        <TransitionRefs>
         <TransitionRef Id="T1452072000756"/>
         <TransitionRef Id="T1452245070560"/>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="Initialisation"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="288"/>
      <ExtendedAttribute Name="YOffset" Value="4"/>
      <ExtendedAttribute Name="Width" Value="145"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1448472568550" Name="">
     <Description></Description>
     <Implementation>
      <Tool Id="MeiboView" Type="APPLICATION">
       <ActualParameters>
        <ActualParameter>Mission</ActualParameter>
        <ActualParameter>MissionValidate</ActualParameter>
        <ActualParameter>missionDN</ActualParameter>
       </ActualParameters>
      </Tool>
     </Implementation>
     <Performer>PROCESS.ROLE-Manager</Performer>
     <Priority>1</Priority>
      <Deadline Execution="SYNCHR">
       <DeadlineCondition>VARIABLE firstEventStartDate</DeadlineCondition>
       <ExceptionName>horsD&#233;lai1</ExceptionName>
      </Deadline>
      <Deadline Execution="ASYNCHR">
       <DeadlineCondition>DELAY 2 day</DeadlineCondition>
       <ExceptionName>rappel1</ExceptionName>
      </Deadline>
      <Deadline Execution="SYNCHR">
       <DeadlineCondition></DeadlineCondition>
       <ExceptionName>escaladeDDI</ExceptionName>
      </Deadline>
     <StartMode>Manual</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="XOR"/>
       <Split Type="XOR">
        <TransitionRefs>
         <TransitionRef Id="T1452078466709"/>
         <TransitionRef Id="T1448473268060"/>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="Validation Manager"/>
      <ExtendedAttribute Name="fr_description"  Value="Valider une mission"/>
      <ExtendedAttribute Name="XOffset" Value="332"/>
      <ExtendedAttribute Name="YOffset" Value="340"/>
      <ExtendedAttribute Name="Width" Value="185"/>
      <ExtendedAttribute Name="Height" Value="41"/>
      <ExtendedAttribute Name="State" Value="0"/>
      <ExtendedAttribute Name="Handlers" Value="HandlerList" >
<plugin en="Detect events" fr="D&#233;tection d&apos;&#233;v&#233;nements">
  <entries>
    <activity.state.Eligible>
      <action>1452522071084</action>
    </activity.state.Eligible>
  </entries>
</plugin>

      </ExtendedAttribute>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1448472625633" Name="">
     <Description></Description>
     <Implementation>
      <Tool Id="MeiboView" Type="APPLICATION">
       <ActualParameters>
        <ActualParameter>Mission</ActualParameter>
        <ActualParameter>MissionValidate</ActualParameter>
        <ActualParameter>missionDN</ActualParameter>
       </ActualParameters>
      </Tool>
     </Implementation>
     <Performer>PROCESS.ROLE_SecondLevelValidation</Performer>
     <Priority>1</Priority>
      <Deadline Execution="ASYNCHR">
       <DeadlineCondition>DELAY 2 day</DeadlineCondition>
       <ExceptionName>rappel1</ExceptionName>
      </Deadline>
     <StartMode>Manual</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="XOR"/>
       <Split Type="XOR">
        <TransitionRefs>
         <TransitionRef Id="T1448473765695"/>
         <TransitionRef Id="T1448473752360"/>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="Validation DDI"/>
      <ExtendedAttribute Name="fr_description"  Value="Valider une mission"/>
      <ExtendedAttribute Name="XOffset" Value="0"/>
      <ExtendedAttribute Name="YOffset" Value="556"/>
      <ExtendedAttribute Name="Width" Value="269"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1448472836106" Name="">
     <Description></Description>
     <Route/>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Manual</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="XOR"/>
       <Split Type="XOR">
        <TransitionRefs>
         <TransitionRef Id="T1448473616152"/>
         <TransitionRef Id="T1448472950998"/>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="route"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="320"/>
      <ExtendedAttribute Name="YOffset" Value="460"/>
      <ExtendedAttribute Name="Width" Value="120"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1448473028474" Name="">
     <Description></Description>
     <Implementation>
      <No/>
     </Implementation>
     <Performer>PROCESS.ROLE-Participant</Performer>
     <Priority>1</Priority>
      <Deadline Execution="SYNCHR">
       <DeadlineCondition>VARIABLE firstEventStartDate</DeadlineCondition>
       <ExceptionName>horsD&#233;lai</ExceptionName>
      </Deadline>
     <StartMode>Manual</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="XOR"/>
       <Split Type="XOR">
        <TransitionRefs>
         <TransitionRef Id="T1448527696302"/>
         <TransitionRef Id="T1452079411023"/>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="Compl&#232;te demande"/>
      <ExtendedAttribute Name="fr_description"  Value="Compl&#233;ter une demande de mission pour son organisation"/>
      <ExtendedAttribute Name="XOffset" Value="344"/>
      <ExtendedAttribute Name="YOffset" Value="672"/>
      <ExtendedAttribute Name="Width" Value="201"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1448473223019" Name="">
     <Description></Description>
     <Implementation>
      <Tool Id="MeiboView" Type="APPLICATION">
       <ActualParameters>
        <ActualParameter>Mission</ActualParameter>
        <ActualParameter>MissionCreate</ActualParameter>
        <ActualParameter>missionDN</ActualParameter>
       </ActualParameters>
      </Tool>
     </Implementation>
     <Performer>PROCESS.ROLE-Participant</Performer>
     <Priority>1</Priority>
      <Deadline Execution="SYNCHR">
       <DeadlineCondition>VARIABLE firstEventStartDate</DeadlineCondition>
       <ExceptionName>horsD&#233;lai</ExceptionName>
      </Deadline>
     <StartMode>Manual</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="XOR"/>
       <Split Type="XOR">
        <TransitionRefs>
         <TransitionRef Id="T1448473468781"/>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="Modifie demande"/>
      <ExtendedAttribute Name="fr_description"  Value="Modifier une demande de mission"/>
      <ExtendedAttribute Name="XOffset" Value="484"/>
      <ExtendedAttribute Name="YOffset" Value="556"/>
      <ExtendedAttribute Name="Width" Value="189"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
      <ExtendedAttribute Name="Handlers" Value="HandlerList" >
<plugin en="Detect events" fr="D&#233;tection d&apos;&#233;v&#233;nements">
  <entries>
    <activity.state.Eligible>
      <action>1452524978986</action>
    </activity.state.Eligible>
  </entries>
</plugin>

      </ExtendedAttribute>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1448473316383" Name="">
     <Description></Description>
     <Route/>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Manual</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="XOR"/>
       <Split Type="XOR">
        <TransitionRefs>
         <TransitionRef Id="T1448473472486"/>
         <TransitionRef Id="T1452260326665"/>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="d&#233;cision demandeur"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="728"/>
      <ExtendedAttribute Name="YOffset" Value="636"/>
      <ExtendedAttribute Name="Width" Value="205"/>
      <ExtendedAttribute Name="Height" Value="45"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1448527318016" Name="">
     <Description></Description>
     <Implementation>
      <SubFlow>
       <Id>1449063509239</Id>
       <Execution>SYNCHR</Execution>
       <ActualParameters>
        <ActualParameter>userDN</ActualParameter>
        <ActualParameter>isMission</ActualParameter>
       </ActualParameters>
      </SubFlow>
     </Implementation>
     <Performer></Performer>
     <Priority>1</Priority>
      <Deadline Execution="SYNCHR">
       <DeadlineCondition></DeadlineCondition>
       <ExceptionName>horsD&#233;lai</ExceptionName>
      </Deadline>
     <StartMode>Automatic</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="XOR"/>
       <Split Type="XOR">
        <TransitionRefs>
         <TransitionRef Id="T1449065800871"/>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="OrganiseDeplacement"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="652"/>
      <ExtendedAttribute Name="YOffset" Value="756"/>
      <ExtendedAttribute Name="Width" Value="205"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
      <ExtendedAttribute Name="numberSubflowToLaunch" Value="1"/>
      <ExtendedAttribute Name="fr_titleParameter"  Value="Organisation D&#233;placement mission {userDn}"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1448527724520" Name="">
     <Description></Description>
     <Implementation>
      <Tool Id="MeiboScript" Type="SCRIPT">
       <ActualParameters>
        <ActualParameter>var /*String*/ missionID = meibo.getWorkflowVariable(&quot;missionID&quot;); 
var /*String*/ ownerID = meibo.getWorkflowVariable(&quot;participantID&quot;);
var /*String*/ ownerDN = meibo.getWorkflowVariable(&quot;participantDN&quot;);

meibo.logDebug(&quot;Abandon automatique de la mission &quot; + missionID + &quot; pour &quot; + ownerDN + &quot;; le d&#233;lai est expir&#233;&quot;); 
updateMissionStatus(missionID, ownerID, &quot;CAN&quot;, &quot;Abandon automatique, d&#233;lai expir&#233;&quot;);</ActualParameter>
       </ActualParameters>
      </Tool>
     </Implementation>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Automatic</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="XOR"/>
       <Split Type="XOR">
        <TransitionRefs>
         <TransitionRef Id="T1449141870986"/>
         <TransitionRef Id="T1449136047940"/>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="Abandon Automatique"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="1644"/>
      <ExtendedAttribute Name="YOffset" Value="704"/>
      <ExtendedAttribute Name="Width" Value="189"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1448527961473" Name="">
     <Description></Description>
     <Implementation>
      <No/>
     </Implementation>
     <Performer>PROCESS.ROLE-Participant</Performer>
     <Priority>2</Priority>
      <Deadline Execution="SYNCHR">
       <DeadlineCondition></DeadlineCondition>
       <ExceptionName>horsD&#233;lai</ExceptionName>
      </Deadline>
      <Deadline Execution="ASYNCHR">
       <DeadlineCondition>VARIABLE </DeadlineCondition>
       <ExceptionName>d&#233;partProche</ExceptionName>
      </Deadline>
     <StartMode>Manual</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="XOR"/>
       <Split Type="XOR">
        <TransitionRefs>
         <TransitionRef Id="T1452592386838"/>
         <TransitionRef Id="T1448531893154"/>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="EditeOrdreDeMission"/>
      <ExtendedAttribute Name="fr_description"  Value="Editer un ordre de mission"/>
      <ExtendedAttribute Name="XOffset" Value="456"/>
      <ExtendedAttribute Name="YOffset" Value="836"/>
      <ExtendedAttribute Name="Width" Value="217"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1448531734892" Name="">
     <Description></Description>
     <Implementation>
      <No/>
     </Implementation>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Automatic</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="AND"/>
       <Split Type="AND">
        <TransitionRefs>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="notif pour annulation organisation"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="864"/>
      <ExtendedAttribute Name="YOffset" Value="916"/>
      <ExtendedAttribute Name="Width" Value="253"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1448531857602" Name="">
     <Description></Description>
     <Route/>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Manual</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="AND"/>
       <Split Type="AND">
        <TransitionRefs>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value=""/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="832"/>
      <ExtendedAttribute Name="YOffset" Value="860"/>
      <ExtendedAttribute Name="Width" Value="120"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1448536722066" Name="">
     <Description></Description>
     <Implementation>
      <No/>
     </Implementation>
     <Performer>OrganisateurVoyage</Performer>
     <Priority>1</Priority>
      <Deadline Execution="ASYNCHR">
       <DeadlineCondition>DELAY 2 day</DeadlineCondition>
       <ExceptionName>rappel1</ExceptionName>
      </Deadline>
      <Deadline Execution="ASYNCHR">
       <DeadlineCondition></DeadlineCondition>
       <ExceptionName>escalade</ExceptionName>
      </Deadline>
      <Deadline Execution="SYNCHR">
       <DeadlineCondition>VARIABLE firstEventStartDate</DeadlineCondition>
       <ExceptionName>horsDelai</ExceptionName>
      </Deadline>
     <StartMode>Manual</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="AND"/>
       <Split Type="AND">
        <TransitionRefs>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="EstimationCout"/>
      <ExtendedAttribute Name="fr_description"  Value="Estimer le co&#251;t d&apos;une mission"/>
      <ExtendedAttribute Name="XOffset" Value="824"/>
      <ExtendedAttribute Name="YOffset" Value="208"/>
      <ExtendedAttribute Name="Width" Value="161"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1448545744181" Name="">
     <Description></Description>
     <Implementation>
      <No/>
     </Implementation>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Automatic</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="AND"/>
       <Split Type="AND">
        <TransitionRefs>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="Relance"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="32"/>
      <ExtendedAttribute Name="YOffset" Value="640"/>
      <ExtendedAttribute Name="Width" Value="120"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1448545874035" Name="">
     <Description></Description>
     <Implementation>
      <No/>
     </Implementation>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Manual</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="AND"/>
       <Split Type="AND">
        <TransitionRefs>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="Relance"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="588"/>
      <ExtendedAttribute Name="YOffset" Value="348"/>
      <ExtendedAttribute Name="Width" Value="120"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1448546285917" Name="">
     <Description></Description>
     <Implementation>
      <No/>
     </Implementation>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Automatic</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="AND"/>
       <Split Type="AND">
        <TransitionRefs>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="Relance"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="1056"/>
      <ExtendedAttribute Name="YOffset" Value="208"/>
      <ExtendedAttribute Name="Width" Value="120"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1448546524800" Name="">
     <Description></Description>
     <Route/>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Manual</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="AND"/>
       <Split Type="AND">
        <TransitionRefs>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value=""/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="428"/>
      <ExtendedAttribute Name="YOffset" Value="280"/>
      <ExtendedAttribute Name="Width" Value="101"/>
      <ExtendedAttribute Name="Height" Value="37"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1448557363960" Name="">
     <Description></Description>
     <Implementation>
      <Tool Id="MeiboScript" Type="SCRIPT">
       <ActualParameters>
        <ActualParameter></ActualParameter>
       </ActualParameters>
      </Tool>
     </Implementation>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Automatic</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="AND"/>
       <Split Type="AND">
        <TransitionRefs>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="rappel D&#233;part"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="416"/>
      <ExtendedAttribute Name="YOffset" Value="924"/>
      <ExtendedAttribute Name="Width" Value="120"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1449135987735" Name="">
     <Description></Description>
     <Implementation>
      <Tool Id="MeiboScript" Type="SCRIPT">
       <ActualParameters>
        <ActualParameter>var participantDn = meibo.getWorkflowVariable(&quot;participantDN&quot;);
var missionID = meibo.getWorkflowVariable(&quot;missionID&quot;);
var user = meibo.getWorkflowVariable(&quot;participantDisplayName&quot;);

// notification
var email = meibo.getWorkflowVariable(&quot;participantEmail&quot;);
if(email==null){
  meibo.logWarn(&quot;Impossible de notifier &quot; + participantDn + &quot; car il n&apos;a pas d&apos;email&quot;);
}else{
  var /*Parameters*/ params = new Parameters();
  params.add(&quot;MAIL_HEADER&quot;, returnEmpty(getMailParameter(&quot;MAIL_HEADER&quot;)));
  params.add(&quot;MAIL_FOOTER&quot;, returnEmpty(getMailParameter(&quot;MAIL_FOOTER&quot;)));
  params.add(&quot;MAIL_LINKNAME&quot;, returnEmpty(getMailParameter(&quot;MAIL_LINKNAME&quot;)));
  params.add(&quot;MAIL_SENDER&quot;, getMailParameter(&quot;MAIL_SENDER&quot;));
  params.add(&quot;user&quot;, user);
  params.add(&quot;missionID&quot;, missionID);
  params.add(&quot;recipient&quot;, email);  
  params.add(&quot;participantDN&quot;, participantDn);  
  meibo.executePlugin(&quot;NotifyMissionCanceled&quot;,params);
}</ActualParameter>
       </ActualParameters>
      </Tool>
     </Implementation>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Automatic</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="XOR"/>
       <Split Type="XOR">
        <TransitionRefs>
         <TransitionRef Id="T1449136074946"/>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="notification"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="1248"/>
      <ExtendedAttribute Name="YOffset" Value="852"/>
      <ExtendedAttribute Name="Width" Value="133"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1449139919375" Name="">
     <Description></Description>
     <Route/>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Manual</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="XOR"/>
       <Split Type="XOR">
        <TransitionRefs>
         <TransitionRef Id="T1452078449254"/>
         <TransitionRef Id="T1449140025000"/>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value=""/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="132"/>
      <ExtendedAttribute Name="YOffset" Value="280"/>
      <ExtendedAttribute Name="Width" Value="120"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1449244633439" Name="">
     <Description></Description>
     <Implementation>
      <Tool Id="MeiboView" Type="APPLICATION">
       <ActualParameters>
        <ActualParameter>Mission</ActualParameter>
        <ActualParameter>MissionAccept</ActualParameter>
        <ActualParameter>missionDN</ActualParameter>
       </ActualParameters>
      </Tool>
     </Implementation>
     <Performer>PROCESS.ROLE-Participant</Performer>
     <Priority>1</Priority>
      <Deadline Execution="SYNCHR">
       <DeadlineCondition>VARIABLE </DeadlineCondition>
       <ExceptionName>horsD&#233;lai</ExceptionName>
      </Deadline>
      <Deadline Execution="ASYNCHR">
       <DeadlineCondition>CALENDAR_DELAY 2 day</DeadlineCondition>
       <ExceptionName>relance</ExceptionName>
      </Deadline>
     <StartMode>Manual</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="AND"/>
       <Split Type="XOR">
        <TransitionRefs>
         <TransitionRef Id="T1452072030730"/>
         <TransitionRef Id="T1452014277554"/>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="Accepter mission"/>
      <ExtendedAttribute Name="fr_description"  Value="Accepter une mission"/>
      <ExtendedAttribute Name="XOffset" Value="420"/>
      <ExtendedAttribute Name="YOffset" Value="104"/>
      <ExtendedAttribute Name="Width" Value="201"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
      <ExtendedAttribute Name="Handlers" Value="HandlerList" >
<plugin en="Detect events" fr="D&#233;tection d&apos;&#233;v&#233;nements">
  <entries>
    <activity.state.Eligible>
      <action>1452270989283</action>
    </activity.state.Eligible>
  </entries>
</plugin>

      </ExtendedAttribute>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1449244931030" Name="">
     <Description></Description>
     <Implementation>
      <No/>
     </Implementation>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Automatic</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="AND"/>
       <Split Type="AND">
        <TransitionRefs>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="Relance"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="680"/>
      <ExtendedAttribute Name="YOffset" Value="132"/>
      <ExtendedAttribute Name="Width" Value="120"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1449245333752" Name="">
     <Description></Description>
     <Implementation>
      <Tool Id="MeiboScript" Type="SCRIPT">
       <ActualParameters>
        <ActualParameter>var /*Set*/ notificationRoleSet = meibo.setWorkflowVariable(&quot;notificationRoles&quot;);
if(!notificationRoleSet.isEmpty()){
//TODO notifications DDI ou autre en fonction de notificationRoleSet
}</ActualParameter>
       </ActualParameters>
      </Tool>
     </Implementation>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Automatic</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="AND"/>
       <Split Type="AND">
        <TransitionRefs>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="Notifications"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="676"/>
      <ExtendedAttribute Name="YOffset" Value="972"/>
      <ExtendedAttribute Name="Width" Value="125"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1452014265043" Name="">
     <Description></Description>
     <Route/>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Manual</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="AND"/>
       <Split Type="AND">
        <TransitionRefs>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value=""/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="808"/>
      <ExtendedAttribute Name="YOffset" Value="328"/>
      <ExtendedAttribute Name="Width" Value="120"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1452071850125" Name="">
     <Description></Description>
     <Implementation>
      <Tool Id="MeiboScript" Type="SCRIPT">
       <ActualParameters>
        <ActualParameter>var /*String*/ missionDN = meibo.getWorkflowVariable(&quot;missionDN&quot;); 
var /*Entry*/ missionEntry = meibo.getDnEntry(&quot;Mission&quot;, missionDN);
if((missionEntry.TMN_ESTIMATED_COST[0]!=null) &amp;&amp; (missionEntry.TMN_ESTIMATED_COST[0]!=&quot;&quot;)){
  meibo.setWorkflowVariable(&quot;costDefined&quot;,&quot;true&quot;); 
}else{
  meibo.setWorkflowVariable(&quot;costDefined&quot;,&quot;false&quot;);
}</ActualParameter>
       </ActualParameters>
      </Tool>
     </Implementation>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Automatic</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="XOR"/>
       <Split Type="XOR">
        <TransitionRefs>
         <TransitionRef Id="T1452071956127"/>
         <TransitionRef Id="T1452071980389"/>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="verifieCout"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="288"/>
      <ExtendedAttribute Name="YOffset" Value="196"/>
      <ExtendedAttribute Name="Width" Value="120"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1452078418181" Name="">
     <Description></Description>
     <Route/>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Manual</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="XOR"/>
       <Split Type="AND">
        <TransitionRefs>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value=""/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="96"/>
      <ExtendedAttribute Name="YOffset" Value="400"/>
      <ExtendedAttribute Name="Width" Value="120"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
    <Activity Id="A1452260216937" Name="">
     <Description></Description>
     <Implementation>
      <Tool Id="MeiboScript" Type="SCRIPT">
       <ActualParameters>
        <ActualParameter>var /*String*/ missionID = meibo.getWorkflowVariable(&quot;missionID&quot;); 
var /*String*/ ownerID = meibo.getWorkflowVariable(&quot;participantID&quot;);
var /*String*/ ownerDN = meibo.getWorkflowVariable(&quot;participantDN&quot;);

meibo.logDebug(&quot;Abandon explicite de la mission &quot; + missionID + &quot; pour &quot; + ownerDN); 
updateMissionStatus(missionID, ownerID, &quot;CAN&quot;, &quot;&quot;);</ActualParameter>
       </ActualParameters>
      </Tool>
     </Implementation>
     <Performer></Performer>
     <Priority>1</Priority>
     <StartMode>Automatic</StartMode>
     <TransitionRestrictions>
      <TransitionRestriction>
       <Join Type="XOR"/>
       <Split Type="XOR">
        <TransitionRefs>
         <TransitionRef Id="T1452260261334"/>
         <TransitionRef Id="T1452260241541"/>
        </TransitionRefs>
       </Split>
      </TransitionRestriction>
     </TransitionRestrictions>
     <ExtendedAttributes>
      <ExtendedAttribute Name="fr_name"  Value="Abandon"/>
      <ExtendedAttribute Name="fr_description"  Value=""/>
      <ExtendedAttribute Name="XOffset" Value="1204"/>
      <ExtendedAttribute Name="YOffset" Value="788"/>
      <ExtendedAttribute Name="Width" Value="120"/>
      <ExtendedAttribute Name="Height" Value="40"/>
      <ExtendedAttribute Name="State" Value="0"/>
     </ExtendedAttributes>
    </Activity>
   </Activities>
   <Transitions>
    <Transition Id="T1448472522446" Name="T1448472522446" From="A1448472295866" To="A1448472369326"/>
    <Transition Id="T1448472950998" Name="T1448472950998" From="A1448472836106" To="A1448472625633">
     <Condition Type="OTHERWISE"></Condition>
    </Transition>
    <Transition Id="T1448473268060" Name="T1448473268060" From="A1448472568550" To="A1448473223019">
     <Condition Type="OTHERWISE"></Condition>
    </Transition>
    <Transition Id="T1448473468781" Name="T1448473468781" From="A1448473223019" To="A1448473316383"/>
    <Transition Id="T1448473472486" Name="T1448473472486" From="A1448473316383" To="A1448472568550">
     <Condition Type="CONDITION">missionModified==&quot;true&quot;</Condition>
    </Transition>
    <Transition Id="T1448473616152" Name="T1448473616152" From="A1448472836106" To="A1448473028474">
     <Condition Type="CONDITION">secondValidationRoles.isEmpty()</Condition>
    </Transition>
    <Transition Id="T1448473752360" Name="T1448473752360" From="A1448472625633" To="A1448473223019">
     <Condition Type="OTHERWISE"></Condition>
    </Transition>
    <Transition Id="T1448473765695" Name="T1448473765695" From="A1448472625633" To="A1448473028474">
     <Condition Type="CONDITION">secondLevelValidated==&quot;true&quot;</Condition>
    </Transition>
    <Transition Id="T1448527696302" Name="T1448527696302" From="A1448473028474" To="A1448527318016">
     <Condition Type="CONDITION">completedForOrganisation==&quot;true&quot;</Condition>
    </Transition>
    <Transition Id="T1448531893154" Name="T1448531893154" From="A1448527961473" To="A1448531857602">
     <Condition Type="OTHERWISE"></Condition>
    </Transition>
    <Transition Id="T1448531937565" Name="T1448531937565" From="A1448531857602" To="A1448531734892"/>
    <Transition Id="T1448545497555" Name="T1448545497555" From="A1448527961473" To="A1448527724520">
     <Condition Type="EXCEPTION">horsD&#233;lai</Condition>
    </Transition>
    <Transition Id="T1448545610687" Name="T1448545610687" From="A1448527318016" To="A1448527724520">
     <Condition Type="EXCEPTION">horsD&#233;lai</Condition>
    </Transition>
    <Transition Id="T1448545750717" Name="T1448545750717" From="A1448472625633" To="A1448545744181">
     <Condition Type="EXCEPTION">rappel1</Condition>
    </Transition>
    <Transition Id="T1448545879483" Name="T1448545879483" From="A1448472568550" To="A1448545874035">
     <Condition Type="EXCEPTION">rappel1</Condition>
    </Transition>
    <Transition Id="T1448546325583" Name="T1448546325583" From="A1448536722066" To="A1448546285917">
     <Condition Type="EXCEPTION">rappel1</Condition>
    </Transition>
    <Transition Id="T1448546538767" Name="T1448546538767" From="A1448536722066" To="A1448546524800">
     <Condition Type="EXCEPTION">escalade</Condition>
    </Transition>
    <Transition Id="T1449065723371" Name="T1449065723371" From="A1448527961473" To="A1448557363960">
     <Condition Type="EXCEPTION">d&#233;partProche</Condition>
    </Transition>
    <Transition Id="T1449065800871" Name="T1449065800871" From="A1448527318016" To="A1448527961473"/>
    <Transition Id="T1449136047940" Name="T1449136047940" From="A1448527724520" To="A1449135987735">
     <Condition Type="OTHERWISE"></Condition>
    </Transition>
    <Transition Id="T1449136074946" Name="T1449136074946" From="A1449135987735" To="A1448472343512"/>
    <Transition Id="T1449140025000" Name="T1449140025000" From="A1449139919375" To="A1448472568550">
     <Condition Type="OTHERWISE"></Condition>
    </Transition>
    <Transition Id="T1449140155934" Name="T1449140155934" From="A1448536722066" To="A1449139919375"/>
    <Transition Id="T1449140168470" Name="T1449140168470" From="A1448546524800" To="A1449139919375"/>
    <Transition Id="T1449141870986" Name="T1449141870986" From="A1448527724520" To="A1448472343512">
     <Condition Type="CONDITION">isDG==&quot;true&quot;</Condition>
    </Transition>
    <Transition Id="T1449244728738" Name="T1449244728738" From="A1449244633439" To="A1448527724520">
     <Condition Type="EXCEPTION">horsD&#233;lai</Condition>
    </Transition>
    <Transition Id="T1449244943062" Name="T1449244943062" From="A1449244633439" To="A1449244931030">
     <Condition Type="EXCEPTION">relance</Condition>
    </Transition>
    <Transition Id="T1452014277554" Name="T1452014277554" From="A1449244633439" To="A1452014265043">
     <Condition Type="OTHERWISE"></Condition>
    </Transition>
    <Transition Id="T1452071956127" Name="T1452071956127" From="A1452071850125" To="A1449139919375">
     <Condition Type="CONDITION">costDefined==&quot;true&quot;</Condition>
    </Transition>
    <Transition Id="T1452071980389" Name="T1452071980389" From="A1452071850125" To="A1448536722066">
     <Condition Type="OTHERWISE"></Condition>
    </Transition>
    <Transition Id="T1452072000756" Name="T1452072000756" From="A1448472369326" To="A1452071850125">
     <Condition Type="CONDITION">participantID==initiatorID</Condition>
    </Transition>
    <Transition Id="T1452072030730" Name="T1452072030730" From="A1449244633439" To="A1452071850125">
     <Condition Type="CONDITION">accepted==&quot;true&quot;</Condition>
    </Transition>
    <Transition Id="T1452078449254" Name="T1452078449254" From="A1449139919375" To="A1452078418181">
     <Condition Type="CONDITION">isDG==&quot;true&quot;</Condition>
    </Transition>
    <Transition Id="T1452078466709" Name="T1452078466709" From="A1448472568550" To="A1452078418181">
     <Condition Type="CONDITION">managerValidated==&quot;true&quot;</Condition>
    </Transition>
    <Transition Id="T1452078534818" Name="T1452078534818" From="A1452078418181" To="A1448472836106"/>
    <Transition Id="T1452079024406" Name="T1452079024406" From="A1448536722066" To="A1448527724520">
     <Condition Type="EXCEPTION">horsDelai</Condition>
    </Transition>
    <Transition Id="T1452079250689" Name="T1452079250689" From="A1448472568550" To="A1448527724520">
     <Condition Type="EXCEPTION">horsD&#233;lai1</Condition>
    </Transition>
    <Transition Id="T1452079411023" Name="T1452079411023" From="A1448473028474" To="A1448473316383">
     <Condition Type="OTHERWISE"></Condition>
    </Transition>
    <Transition Id="T1452079443088" Name="T1452079443088" From="A1448473028474" To="A1448527724520">
     <Condition Type="EXCEPTION">horsD&#233;lai</Condition>
    </Transition>
    <Transition Id="T1452079538108" Name="T1452079538108" From="A1448473223019" To="A1448527724520">
     <Condition Type="EXCEPTION">horsD&#233;lai</Condition>
    </Transition>
    <Transition Id="T1452245070560" Name="T1452245070560" From="A1448472369326" To="A1449244633439">
     <Condition Type="OTHERWISE"></Condition>
    </Transition>
    <Transition Id="T1452260241541" Name="T1452260241541" From="A1452260216937" To="A1449135987735">
     <Condition Type="OTHERWISE"></Condition>
    </Transition>
    <Transition Id="T1452260261334" Name="T1452260261334" From="A1452260216937" To="A1448472343512">
     <Condition Type="CONDITION">isDG==&quot;true&quot;</Condition>
    </Transition>
    <Transition Id="T1452260301879" Name="T1452260301879" From="A1452014265043" To="A1452260216937"/>
    <Transition Id="T1452260326665" Name="T1452260326665" From="A1448473316383" To="A1452260216937">
     <Condition Type="OTHERWISE"></Condition>
    </Transition>
    <Transition Id="T1452260346922" Name="T1452260346922" From="A1448531857602" To="A1452260216937"/>
    <Transition Id="T1452592386838" Name="T1452592386838" From="A1448527961473" To="A1449245333752">
     <Condition Type="CONDITION">finalConfirmation==&quot;true&quot;</Condition>
    </Transition>
    <Transition Id="T1452592394901" Name="T1452592394901" From="A1449245333752" To="A1448472343512"/>
    <Transition Id="T1452592675661" Name="T1452592675661" From="A1448472568550" To="A1448472836106">
     <Condition Type="EXCEPTION">escaladeDDI</Condition>
    </Transition>
   </Transitions>
  </WorkflowProcess>
 </WorkflowProcesses>
 <ExtendedAttributes>
  <ExtendedAttribute Name="activityStateColorInactive"  Value="-4144960_-16777216_-65536"/>
  <ExtendedAttribute Name="activityStateColorError"  Value="-65536_-1_-16776961"/>
  <ExtendedAttribute Name="activityStateColorEligible"  Value="-14336_-16777216_-65536"/>
  <ExtendedAttribute Name="activityStateColorExecuting"  Value="-16711936_-16777216_-65536"/>
  <ExtendedAttribute Name="activityStateColorCompleted"  Value="-16776961_-16777216_-65536"/>
  <ExtendedAttribute Name="activityStateColorAborted"  Value="-65281_-1_-256"/>
 </ExtendedAttributes>
</Package>