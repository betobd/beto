<?xml version = "1.0" encoding="iso-8859-1" standalone="no"?>
<screen>
  <source>
  </source>
  <destination>
    <page ar="" de="" en="" es="" fr="" it="" pt="" technicalName="1" titleTab="MissionListe (MissionList)" zh="">
      <textarea>
        <content class="lingual">
          <fr></fr>
        </content>
        <alignment class="fullalignment">left</alignment>
        <htmlcontent class="boolean">false</htmlcontent>
        <css class="css"></css>
        <tooltip class="lingual">
          <fr></fr>
        </tooltip>
        <separator class="separator"></separator>
        <hidden class="boolean">false</hidden>
        <posx class="number">121</posx>
        <posy class="number">173</posy>
        <sizextype class="sizetype">AUTOMATICSIZING</sizextype>
        <altersizex class="hidden">30</altersizex>
        <sizex class="number">327</sizex>
        <sizeytype class="sizetype">AUTOMATICSIZING</sizeytype>
        <sizey class="number">15</sizey>
        <altersizey class="hidden">30</altersizey>
        <alty class="hidden">0</alty>
        <name class="text">OBJ_nbMissions</name>
        <id class="hidden">z8435968416201</id>
        <fieldButton class="node" component_en="Link to a directory field" component_fr="Lier &#224; un attribut annuaire" components="fieldPart" en="" fr="" indexed="local" maxcomp="1"></fieldButton>
        <components class="components">
          <fieldPart class="node" en="" fr="">
            <values class="node" delete_en="Delete" delete_fr="Supprimer" en="" fr="" indexed="father" position="false">
              <field class="field"></field>
            </values>
          </fieldPart>
        </components>
      </textarea>
      <multilist>
        <content class="text">TMN_ID,PRS_ID,PRS_ID,RAS_START_DATE,RAS_END_DATE,Events,TST_ABBREV</content>
        <tablecss class="css"></tablecss>
        <headercss class="css"></headercss>
        <evenrowcss class="css"></evenrowcss>
        <oddrowcss class="css"></oddrowcss>
        <hoverrowcss class="css"></hoverrowcss>
        <hoverrowboolean class="boolean">true</hoverrowboolean>
        <tooltip class="lingual">
          <fr></fr>
        </tooltip>
        <headertitles class="linguallist">
          <fr>
            <item0>Id</item0>
            <item1>Pr&#233;nom</item1>
            <item2>Nom</item2>
            <item3>du</item3>
            <item4>au</item4>
            <item5>1er &#233;v&#232;nement</item5>
            <item6>Status</item6>
          </fr>
        </headertitles>
        <headerpercents class="list"></headerpercents>
        <headervisible class="multilistsetheaders" headerfix="true">true</headervisible>
        <onheaderclick class="script">///$debug
</onheaderclick>
        <ondoubleclick class="script">///$debug

// on r&#233;cup&#232;re le DN de la mission
var /*area*/   missionTable = meibo.getCurrentField();
var /*int*/    row = missionTable.selectedRow;
var /*string*/ missionDn = &quot;T_MISSION_TMN,TMN_ID,&quot; + missionTable.getCell(row,COL_MissionId);

// on affiche le participant &#224; la mission
var name    = missionTable.getCell(row,COL_OwnerName);
var surname = missionTable.getCell(row,COL_OwnerSurname);
var debut   = missionTable.getCell(row,COL_DateDebut);
var fin     = missionTable.getCell(row,COL_DateFin);
meibo.getField(&quot;OBJ_participant&quot;).setValue(&quot;Mission de &quot;+name+&quot; &quot;+surname+&quot; du &quot;+debut+&quot; au &quot;+fin);
meibo.showField(&quot;OBJ_participant&quot;,true);

// On r&#233;cup&#232;re la liste des &#233;v&#232;nements de la mission et on les affiche dans la table des &#233;v&#232;nements
var /*resultSet*/ missionEventRS = meibo.executeLink(&quot;MissionEvent&quot;, missionDn,&quot;fkTCT_ID,TET_ID,TET_NAME,TCT_START_DATE,TCT_DURATION&quot;);
var /*field*/     eventTable = meibo.getField(&quot;OBJ_listeEvents&quot;);
var /*int*/       nbEvents = eventTable.fillInWithResultSet(missionEventRS,0,0,&quot;TET_ID,TCT_START_DATE,TCT_DURATION,TET_NAME&quot;);


for (var row = 0; row &lt; nbEvents; row++) {
  // On r&#233;cup&#232;re la liste des participants et on lea met en Info bulle
  var /*string*/ bubbleInfo = &quot;Participants &#224; l&apos;&#233;v&#232;nement &quot;+eventTable.getCell(row,3)+&quot;\n&quot;;
  var /*resultSet*/ eventAttendeesRS = meibo.executeLink(&quot;EventAttendees&quot;, &quot;travel_event,fkTCT_ID,&quot;+eventTable.getCell(row,0),&quot;personDisplayName,RAS_START_DATE,RAS_END_DATE&quot;);
  for each(var eventAttendee in eventAttendeesRS){
    bubbleInfo = bubbleInfo + eventAttendee.personDisplayName[0]+&quot; du &quot;+eventAttendee.RAS_START_DATE[0]+&quot; au &quot; +eventAttendee.RAS_END_DATE[0]+&quot;\n&quot;;
  }
  
  // L&apos;insertion de l&apos;info bulle est invalid&#233;e car elle pose probl&#232;me dans le script OnClick de la table des events pour afficher le nom de l&apos;&#233;v&#232;nement
  //eventTable.addRawCell(row,3,&quot;&lt;span title=\&quot;&quot;+bubbleInfo+&quot;\&quot;&gt;&quot; + eventTable.getCell(row,3) + &quot;&lt;/span&gt;&quot;);
}




// On valide l&apos;affichage de la description d&apos;une mission
meibo.showField(&quot;OBJ_descriptionMission&quot;,true);

//On invalide la description des participants
meibo.showField(&quot;OBJ_descriptionParticipants&quot;,false);</ondoubleclick>
        <selection class="selectionMode" wantTitle="false">NoneSelection</selection>
        <separator1 class="separator"></separator1>
        <captioncss class="css">_000000__FFFFFF__000000_0</captioncss>
        <caption class="lingual">
          <fr></fr>
        </caption>
        <summary class="lingual">
          <fr></fr>
        </summary>
        <headerabbreviations class="linguallist">
          <fr></fr>
        </headerabbreviations>
        <separator class="separator"></separator>
        <hidden class="boolean">true</hidden>
        <posx class="number">119</posx>
        <posy class="number">190</posy>
        <sizextype class="sizetype">FIXED</sizextype>
        <altersizex class="hidden">30</altersizex>
        <sizex class="number">550</sizex>
        <sizeytype class="sizetype">FIXED</sizeytype>
        <sizey class="number">150</sizey>
        <altersizey class="hidden">30</altersizey>
        <alty class="hidden">0</alty>
        <name class="text">OBJ_listeMissions</name>
        <id class="hidden">p8436035880332</id>
      </multilist>
      <edit>
        <placeholder class="lingual">
          <fr></fr>
        </placeholder>
        <content class="text"></content>
        <limitchar class="number"></limitchar>
        <multivalue class="multivaluehandle" multivalueorderable="false">false</multivalue>
        <resourceAutocomplete class="autocomplete" resourceAutoCompleteSearchAttr="">false</resourceAutocomplete>
        <autoComplete class="boolean">true</autoComplete>
        <separator1 class="separator"></separator1>
        <required class="boolean">false</required>
        <resourcefed class="resourcefed">
          <param>TravelPeople/PRS_ID/Picker/false/false/0/0/</param>
          <pickertitle class="lingual">
            <fr></fr>
          </pickertitle>
        </resourcefed>
        <deletable class="boolean">true</deletable>
        <separator2 class="separator"></separator2>
        <theme class="theme"></theme>
        <css class="css"></css>
        <tooltip class="lingual">
          <fr></fr>
        </tooltip>
        <tabindex class="number"></tabindex>
        <noecho class="boolean">false</noecho>
        <multiline class="boolean">false</multiline>
        <tinymce class="tinymce">false</tinymce>
        <tinymceparameter class="text"></tinymceparameter>
        <tinymcesetup class="text"></tinymcesetup>
        <format class="text"></format>
        <kind class="edittype">regular</kind>
        <separator class="separator"></separator>
        <hidden class="boolean">false</hidden>
        <enable class="boolean">true</enable>
        <posx class="number">181</posx>
        <posy class="number">55</posy>
        <sizextype class="sizetype">FIXED</sizextype>
        <altersizex class="hidden">30</altersizex>
        <sizex class="number">264</sizex>
        <sizeytype class="sizetype">FIXED</sizeytype>
        <sizey class="number">24</sizey>
        <altersizey class="hidden">30</altersizey>
        <alty class="hidden">0</alty>
        <name class="text">OBJ_UserId</name>
        <id class="hidden">q8436274902313</id>
        <fieldButton class="node" component_en="Link to a directory field" component_fr="Lier &#224; un attribut annuaire" components="fieldPart" en="" fr="" indexed="local" maxcomp="1"></fieldButton>
        <components class="components">
          <fieldPart class="node" en="" fr="">
            <values class="node" delete_en="Delete" delete_fr="Supprimer" en="" fr="" indexed="father" position="false">
              <field class="field"></field>
            </values>
          </fieldPart>
        </components>
      </edit>
      <textarea>
        <content class="lingual">
          <fr>Personne :</fr>
        </content>
        <alignment class="fullalignment">left</alignment>
        <htmlcontent class="boolean">false</htmlcontent>
        <css class="css"></css>
        <tooltip class="lingual">
          <fr></fr>
        </tooltip>
        <separator class="separator"></separator>
        <hidden class="boolean">false</hidden>
        <posx class="number">114</posx>
        <posy class="number">57</posy>
        <sizextype class="sizetype">FIXED</sizextype>
        <altersizex class="hidden">30</altersizex>
        <sizex class="number">61</sizex>
        <sizeytype class="sizetype">FIXED</sizeytype>
        <sizey class="number">15</sizey>
        <altersizey class="hidden">30</altersizey>
        <alty class="hidden">0</alty>
        <name class="text"></name>
        <id class="hidden">p8436298583844</id>
        <fieldButton class="node" component_en="Link to a directory field" component_fr="Lier &#224; un attribut annuaire" components="fieldPart" en="" fr="" indexed="local" maxcomp="1"></fieldButton>
        <components class="components">
          <fieldPart class="node" en="" fr="">
            <values class="node" delete_en="Delete" delete_fr="Supprimer" en="" fr="" indexed="father" position="false">
              <field class="field"></field>
            </values>
          </fieldPart>
        </components>
      </textarea>
      <button>
        <content class="lingual">
          <fr>Rechercher</fr>
        </content>
        <wordwrap class="boolean">true</wordwrap>
        <alt class="lingual">
          <fr></fr>
        </alt>
        <tooltip class="lingual">
          <fr></fr>
        </tooltip>
        <tabindex class="number"></tabindex>
        <onclick class="script">///$debug
// On r&#233;cup&#232;re le nom du user s&#233;lectionn&#233;, si vide alors tous les users sont s&#233;lectionn&#233;s
var userId = meibo.getField(&quot;OBJ_UserId&quot;).getContent();

// On r&#233;cup&#232;re le date de d&#233;but et de fin de la recherche
var fromDate = meibo.getField(&quot;OBJ_StartDate&quot;).getContent();
var toDate   = meibo.getField(&quot;OBJ_EndDate&quot;).getContent();

// On construit le filtre qui va permettre de construire la table des missions
var /*String*/ filter = &quot;&quot;;
if( userId != &quot;&quot; ) {
  filter = filter + &quot;PRS_ID=&quot; + userId;
}

if( fromDate != &quot;&quot; ) {
  if( filter != &quot;&quot; ) { filter = filter + &quot; AND &quot;; }
  filter = filter + &quot;RAS_START_DATE &gt;= &apos;&quot; + SQL_DATE_FORMAT.format(DATE_FORMAT.parse(fromDate)) + &quot;&apos;&quot;;
}

if( toDate != &quot;&quot; ) {
  if( filter != &quot;&quot; ) { filter = filter + &quot; AND &quot;; }
  filter = filter + &quot;RAS_END_DATE &lt;= &apos;&quot; + SQL_DATE_FORMAT.format(DATE_FORMAT.parse(toDate)) + &quot;&apos;&quot;;
}

var status   = &quot;&quot;;
if( status != &quot;&quot; ) {
  if( filter != &quot;&quot; ) { filter = filter + &quot; AND &quot;; }
  //filter = filter + &quot;ml.TST_ABBREV = &apos;&quot; + status + &quot;&apos;&quot;;
  filter = filter + &quot;TST_ABBREV = &apos;&quot; + status + &quot;&apos;&quot;;
}

// Fin du filtre avec l&apos;&#233;tat la mission dans l&apos;&#233;tat le plus r&#233;cent
//if( filter != &quot;&quot; ) { filter = filter + &quot; AND &quot;; }
//filter = filter + &quot;ml.STATUS_DATE = (SELECT  max(TST_TMN_DATE) FROM R_TST_TMN rtst2 WHERE rtst2.TMN_ID = ml.TMN_ID)ORDER BY ml.TMN_ID;&quot;;


/*
filter = filter + 

RAS_START_DATE &gt;= &apos;2016-09-08&apos;  AND   RAS_END_DATE &lt;= &apos;2016-09-13&apos; AND ml.TST_ABBREV = &apos;CRE&apos;
 AND ml.STATUS_DATE = (SELECT  max(TST_TMN_DATE) FROM R_TST_TMN rtst2 WHERE rtst2.TMN_ID = ml.TMN_ID)ORDER BY ml.TMN_ID   ;
*/


// A FAIRE, NE RETENIR QUE LES DESCRIPTIONS LES PLUS RECENTES POUR CHAQUE MISSION
// A FAIRE : AJOUTER UN CRITERE SUR LE STATUS DE LA MISSION


// On construit la table des missions &#224; afficher avec les informations suivantes :
var missionTable = meibo.getField(&quot;OBJ_listeMissions&quot;);
var /*int*/ nbMissions = missionTable.fillInWithQuery(&apos;MissionList&apos;, filter, 0);

// Affichage du nombre de missions correspondant aux crit&#232;res
// Et affichage du tablean des missions si au moins une mission
if( nbMissions == 0 ) {
  meibo.getField(&quot;OBJ_nbMissions&quot;).setValue(&quot;Aucune mission ne correspond aux crit&#232;res&quot;);
  meibo.showField(&quot;OBJ_listeMissions&quot;,false);
}
else {
  if( nbMissions == 1 ) {
    meibo.getField(&quot;OBJ_nbMissions&quot;).setValue(&quot;1 mission correspond aux crit&#232;res&quot;);
  }
  else {
    meibo.getField(&quot;OBJ_nbMissions&quot;).setValue(nbMissions + &quot; missions correspondent aux crit&#232;res&quot;);
  }
  meibo.showField(&quot;OBJ_listeMissions&quot;,true);
}

// On va modifier le tableau pour y mettre des informations plus pertinentes
var /*String*/ ownerId = &quot;&quot;;
var /*String*/ owner = &quot;&quot;;
var /*String*/    missionDn = null;
var /*resultSet*/ missionEventRS = null;
for (var row = 0; row &lt; nbMissions; row++) {
  // On r&#233;cup&#232;re la description du propri&#233;taire de la mission
  // et on va mettre &#224; jour les colonnes contenant le nom/pr&#233;nom
  ownerId = missionTable.getCell(row,COL_OwnerName)
  owner = meibo.getDnEntry(&quot;TravelPeople&quot;,&quot;T_PERSON_PRS,PRS_ID,&quot; + ownerId, &quot;PRS_NAME,PRS_SIRNAME&quot;);
  missionTable.addCell(row,COL_OwnerName,    owner.PRS_NAME[0]);
  missionTable.addCell(row,COL_OwnerSurname, owner.PRS_SIRNAME[0]);
  
  // On va rechercher le premier &#233;v&#232;nement de la mission
  // et mettre &#224; jour la colonne contenant le premier &#233;v&#232;nement dans le tableau
  missionDn = &quot;T_MISSION_TMN,TMN_ID,&quot; + missionTable.getCell(row,COL_MissionId);
  missionEventRS = meibo.executeLink(&quot;MissionEvent&quot;, missionDn,&quot;TET_NAME,TCT_START_DATE,TCT_DURATION&quot;);
  //missionTable.addRawCell(row,COL_MissionId,&quot;&lt;span title=\&quot;blabla\&quot;&gt;&quot; + missionTable.getCell(row,COL_MissionId) + &quot;&lt;/span&gt;&quot;);
  missionTable.addCell(row,COL_FirstEvent,missionEventRS.getEntry().TET_NAME[0]);
}

// La description d&apos;une mission ne doit pas &#234;tre affich&#233; par d&#233;faut
meibo.showField(&quot;OBJ_descriptionMission&quot;,false);</onclick>
        <submit class="boolean">false</submit>
        <separator0 class="separator"></separator0>
        <confirmation class="boolean">false</confirmation>
        <confirmationdialogmessage class="lingual">
          <fr></fr>
        </confirmationdialogmessage>
        <confirmationdialogtitle class="lingual">
          <fr></fr>
        </confirmationdialogtitle>
        <theme class="theme"></theme>
        <css class="css"></css>
        <separator1 class="separator"></separator1>
        <waitbutton class="boolean">true</waitbutton>
        <waitingmode class="waitingmode">none</waitingmode>
        <progressbartitle class="lingual">
          <fr></fr>
        </progressbartitle>
        <progressbarnboperationtext class="lingual">
          <fr></fr>
        </progressbarnboperationtext>
        <progressbarnboperationdonetext class="lingual">
          <fr></fr>
        </progressbarnboperationdonetext>
        <prescript class="script"></prescript>
        <separator2 class="separator"></separator2>
        <image class="file"></image>
        <image2 class="file"></image2>
        <separator class="separator"></separator>
        <hidden class="boolean">false</hidden>
        <enable class="boolean">true</enable>
        <posx class="number">319</posx>
        <posy class="number">134</posy>
        <sizextype class="sizetype">FIXED</sizextype>
        <altersizex class="hidden">30</altersizex>
        <sizex class="number">127</sizex>
        <sizeytype class="sizetype">FIXED</sizeytype>
        <sizey class="number">20</sizey>
        <altersizey class="hidden">30</altersizey>
        <alty class="hidden">0</alty>
        <name class="text"></name>
        <id class="hidden">k8436327902515</id>
      </button>
      <calendar>
        <calendarformat class="messages">calendarDisplayPattern</calendarformat>
        <placeholder class="lingual">
          <fr></fr>
        </placeholder>
        <content class="text"></content>
        <tooltip class="lingual">
          <fr></fr>
        </tooltip>
        <tabindex class="number"></tabindex>
        <LDAPValue class="boolean">false</LDAPValue>
        <EditMode class="boolean">false</EditMode>
        <LabelType class="boolean">false</LabelType>
        <separator1 class="separator"></separator1>
        <theme class="theme"></theme>
        <css class="css"></css>
        <required class="boolean">false</required>
        <separator class="separator"></separator>
        <hidden class="boolean">false</hidden>
        <enable class="boolean">true</enable>
        <posx class="number">182</posx>
        <posy class="number">93</posy>
        <sizextype class="sizetype">FIXED</sizextype>
        <altersizex class="hidden">30</altersizex>
        <sizex class="number">113</sizex>
        <sizeytype class="sizetype">FIXED</sizeytype>
        <sizey class="number">25</sizey>
        <altersizey class="hidden">30</altersizey>
        <alty class="hidden">0</alty>
        <name class="text">OBJ_startDate</name>
        <id class="hidden">m8436347048276</id>
        <fieldButton class="node" component_en="Link to a directory field" component_fr="Lier &#224; un attribut annuaire" components="fieldPart" en="" fr="" indexed="local" maxcomp="1"></fieldButton>
        <components class="components">
          <fieldPart class="node" en="" fr="">
            <values class="node" delete_en="Delete" delete_fr="Supprimer" en="" fr="" indexed="father" position="false">
              <field class="field"></field>
            </values>
          </fieldPart>
        </components>
      </calendar>
      <textarea>
        <content class="lingual">
          <fr>Entre</fr>
        </content>
        <alignment class="fullalignment">right</alignment>
        <htmlcontent class="boolean">false</htmlcontent>
        <css class="css"></css>
        <tooltip class="lingual">
          <fr></fr>
        </tooltip>
        <separator class="separator"></separator>
        <hidden class="boolean">false</hidden>
        <posx class="number">115</posx>
        <posy class="number">97</posy>
        <sizextype class="sizetype">FIXED</sizextype>
        <altersizex class="hidden">30</altersizex>
        <sizex class="number">60</sizex>
        <sizeytype class="sizetype">FIXED</sizeytype>
        <sizey class="number">15</sizey>
        <altersizey class="hidden">30</altersizey>
        <alty class="hidden">0</alty>
        <name class="text"></name>
        <id class="hidden">z8436369194197</id>
        <fieldButton class="node" component_en="Link to a directory field" component_fr="Lier &#224; un attribut annuaire" components="fieldPart" en="" fr="" indexed="local" maxcomp="1"></fieldButton>
        <components class="components">
          <fieldPart class="node" en="" fr="">
            <values class="node" delete_en="Delete" delete_fr="Supprimer" en="" fr="" indexed="father" position="false">
              <field class="field"></field>
            </values>
          </fieldPart>
        </components>
      </textarea>
      <textarea>
        <content class="lingual">
          <fr>et </fr>
        </content>
        <alignment class="fullalignment">right</alignment>
        <htmlcontent class="boolean">false</htmlcontent>
        <css class="css"></css>
        <tooltip class="lingual">
          <fr></fr>
        </tooltip>
        <separator class="separator"></separator>
        <hidden class="boolean">false</hidden>
        <posx class="number">307</posx>
        <posy class="number">97</posy>
        <sizextype class="sizetype">FIXED</sizextype>
        <altersizex class="hidden">30</altersizex>
        <sizex class="number">15</sizex>
        <sizeytype class="sizetype">FIXED</sizeytype>
        <sizey class="number">15</sizey>
        <altersizey class="hidden">30</altersizey>
        <alty class="hidden">0</alty>
        <name class="text"></name>
        <id class="hidden">k8436397652298</id>
        <fieldButton class="node" component_en="Link to a directory field" component_fr="Lier &#224; un attribut annuaire" components="fieldPart" en="" fr="" indexed="local" maxcomp="1"></fieldButton>
        <components class="components">
          <fieldPart class="node" en="" fr="">
            <values class="node" delete_en="Delete" delete_fr="Supprimer" en="" fr="" indexed="father" position="false">
              <field class="field"></field>
            </values>
          </fieldPart>
        </components>
      </textarea>
      <calendar>
        <calendarformat class="messages">calendarDisplayPattern</calendarformat>
        <placeholder class="lingual">
          <fr></fr>
        </placeholder>
        <content class="text"></content>
        <tooltip class="lingual">
          <fr></fr>
        </tooltip>
        <tabindex class="number"></tabindex>
        <LDAPValue class="boolean">false</LDAPValue>
        <EditMode class="boolean">false</EditMode>
        <LabelType class="boolean">false</LabelType>
        <separator1 class="separator"></separator1>
        <theme class="theme"></theme>
        <css class="css"></css>
        <required class="boolean">false</required>
        <separator class="separator"></separator>
        <hidden class="boolean">false</hidden>
        <enable class="boolean">true</enable>
        <posx class="number">332</posx>
        <posy class="number">94</posy>
        <sizextype class="sizetype">FIXED</sizextype>
        <altersizex class="hidden">30</altersizex>
        <sizex class="number">113</sizex>
        <sizeytype class="sizetype">FIXED</sizeytype>
        <sizey class="number">25</sizey>
        <altersizey class="hidden">30</altersizey>
        <alty class="hidden">0</alty>
        <name class="text">OBJ_endDate</name>
        <id class="hidden">c8436425415629</id>
        <fieldButton class="node" component_en="Link to a directory field" component_fr="Lier &#224; un attribut annuaire" components="fieldPart" en="" fr="" indexed="local" maxcomp="1"></fieldButton>
        <components class="components">
          <fieldPart class="node" en="" fr="">
            <values class="node" delete_en="Delete" delete_fr="Supprimer" en="" fr="" indexed="father" position="false">
              <field class="field"></field>
            </values>
          </fieldPart>
        </components>
      </calendar>
      <verticallayout>
        <css class="css"></css>
        <verticallayout_spaceBetweenComponent class="text">5</verticallayout_spaceBetweenComponent>
        <theme class="theme"></theme>
        <separator class="separator"></separator>
        <hidden class="boolean">true</hidden>
        <posx class="number">122</posx>
        <posy class="number">352</posy>
        <sizextype class="sizetype">FIXED</sizextype>
        <altersizex class="hidden">30</altersizex>
        <sizex class="number">544</sizex>
        <sizeytype class="sizetype">AUTOMATICSIZING</sizeytype>
        <sizey class="number">175</sizey>
        <altersizey class="hidden">30</altersizey>
        <alty class="hidden">0</alty>
        <name class="text">OBJ_descriptionMission</name>
        <id class="hidden">y84364514656911</id>
        <childs class="hidden">
          <textarea>
            <content class="lingual">
              <fr>Participant</fr>
            </content>
            <alignment class="fullalignment">left</alignment>
            <htmlcontent class="boolean">false</htmlcontent>
            <css class="css"></css>
            <tooltip class="lingual">
              <fr></fr>
            </tooltip>
            <separator class="separator"></separator>
            <hidden class="boolean">true</hidden>
            <posx class="number">333</posx>
            <posy class="number">408</posy>
            <sizextype class="sizetype">AUTOMATICSIZING</sizextype>
            <altersizex class="hidden">30</altersizex>
            <sizex class="number">327</sizex>
            <sizeytype class="sizetype">FIXED</sizeytype>
            <sizey class="number">20</sizey>
            <altersizey class="hidden">30</altersizey>
            <alty class="hidden">0</alty>
            <name class="text">OBJ_participant</name>
            <id class="hidden">a84364515920112</id>
            <fieldButton class="node" component_en="Link to a directory field" component_fr="Lier &#224; un attribut annuaire" components="fieldPart" en="" fr="" indexed="local" maxcomp="1"></fieldButton>
            <components class="components">
              <fieldPart class="node" en="" fr="">
                <values class="node" delete_en="Delete" delete_fr="Supprimer" en="" fr="" indexed="father" position="false">
                  <field class="field"></field>
                </values>
              </fieldPart>
            </components>
          </textarea>
          <multilist>
            <content class="text">TCT_ID,TCT_START_DATE,TCT_DURATION,TET_NAME</content>
            <tablecss class="css"></tablecss>
            <headercss class="css"></headercss>
            <evenrowcss class="css"></evenrowcss>
            <oddrowcss class="css"></oddrowcss>
            <hoverrowcss class="css"></hoverrowcss>
            <hoverrowboolean class="boolean">true</hoverrowboolean>
            <tooltip class="lingual">
              <fr></fr>
            </tooltip>
            <headertitles class="linguallist">
              <fr>
                <item0>Id</item0>
                <item1> Date</item1>
                <item2> Dur&#233;e</item2>
                <item3> Nom</item3>
              </fr>
            </headertitles>
            <headerpercents class="list">
              <item0>5</item0>
              <item1>20</item1>
              <item2>10</item2>
              <item3>85</item3>
            </headerpercents>
            <headervisible class="multilistsetheaders" headerfix="true">true</headervisible>
            <onheaderclick class="script">///$debug
</onheaderclick>
            <ondoubleclick class="script">///$debug
// on r&#233;cup&#232;re les identifiants de l&apos;&#233;v&#232;nements (id + dn)
var /*area*/   eventTable = meibo.getCurrentField();
var /*int*/    row = eventTable.selectedRow;
var /*int*/    eventId = eventTable.getCell(row,0);



var /*resultSet*/ eventAttendeesRS = meibo.executeLink(&quot;EventAttendees&quot;, &quot;travel_event,fkTCT_ID,&quot;+eventId,&quot;personDisplayName,RAS_START_DATE,RAS_END_DATE&quot;);
var listeAttendees = &quot;&quot;;
for each(var eventAttendee in eventAttendeesRS){
  if( listeAttendees != &quot;&quot; ) { listeAttendees = listeAttendees + &quot;\n&quot; ; }
  listeAttendees = listeAttendees + eventAttendee.personDisplayName[0]+&quot; sera pr&#233;sent du &quot;+eventAttendee.RAS_START_DATE[0]+&quot; au &quot; +eventAttendee.RAS_END_DATE[0];
}


meibo.getField(&quot;OBJ_AnnonceListeAccompagnateurs&quot;).setValue(&quot;Les participants &#224; l&apos;&#233;v&#232;nement &quot;+eventTable.getCell(row,3)+&quot; sont les suivants&quot;);

//if (false) {
//var /*resultSet*/ eventAttendeesRS = meibo.executeLink(&quot;EventAttendeesPerson&quot;, &quot;travel_event,fkTCT_ID,&quot;+eventId,&quot;PRS_ID,PRS_NAME,PRS_SIRNAME&quot;);
//var listeAttendees = &quot;&quot;;
//for each(var eventAttendee in eventAttendeesRS){
//  if( listeAttendees != &quot;&quot; ) { listeAttendees = listeAttendees + &quot;\n&quot; ; }
//  listeAttendees = listeAttendees + eventAttendee.PRS_NAME[0]+&quot; &quot;+eventAttendee.PRS_SIRNAME[0];
//}
//}

meibo.getField(&quot;OBJ_listeAccompagnateurs&quot;).setValue(listeAttendees);

//On valide la description des participants
meibo.showField(&quot;OBJ_descriptionParticipants&quot;,true);

// On valide l&apos;affichage de la description de l&apos;&#233;v&#232;nement et des participants
//meibo.showField(&quot;OBJ_AnnonceListeAccompagnateurs&quot;,true);
//meibo.showField(&quot;OBJ_listeAccompagnateurs&quot;,true);</ondoubleclick>
            <selection class="selectionMode" wantTitle="false">NoneSelection</selection>
            <separator1 class="separator"></separator1>
            <captioncss class="css">_000000__FFFFFF__000000_0</captioncss>
            <caption class="lingual">
              <fr></fr>
            </caption>
            <summary class="lingual">
              <fr></fr>
            </summary>
            <headerabbreviations class="linguallist">
              <fr></fr>
            </headerabbreviations>
            <separator class="separator"></separator>
            <hidden class="boolean">false</hidden>
            <posx class="number">-21</posx>
            <posy class="number">381</posy>
            <sizextype class="sizetype">FIXED</sizextype>
            <altersizex class="hidden">30</altersizex>
            <sizex class="number">500</sizex>
            <sizeytype class="sizetype">FIXED</sizeytype>
            <sizey class="number">50</sizey>
            <altersizey class="hidden">30</altersizey>
            <alty class="hidden">0</alty>
            <name class="text">OBJ_listeEvents</name>
            <id class="hidden">q84364516788613</id>
          </multilist>
          <verticallayout>
            <css class="css"></css>
            <verticallayout_spaceBetweenComponent class="text">5</verticallayout_spaceBetweenComponent>
            <theme class="theme"></theme>
            <separator class="separator"></separator>
            <hidden class="boolean">false</hidden>
            <posx class="number">361</posx>
            <posy class="number">445</posy>
            <sizextype class="sizetype">FIXED</sizextype>
            <altersizex class="hidden">30</altersizex>
            <sizex class="number">540</sizex>
            <sizeytype class="sizetype">AUTOMATICSIZING</sizeytype>
            <sizey class="number">60</sizey>
            <altersizey class="hidden">30</altersizey>
            <alty class="hidden">0</alty>
            <name class="text">OBJ_descriptionParticipants</name>
            <id class="hidden">s84364517696614</id>
            <childs class="hidden">
              <textarea>
                <content class="lingual">
                  <fr>Description de la mission</fr>
                </content>
                <alignment class="fullalignment">left</alignment>
                <htmlcontent class="boolean">false</htmlcontent>
                <css class="css"></css>
                <tooltip class="lingual">
                  <fr></fr>
                </tooltip>
                <separator class="separator"></separator>
                <hidden class="boolean">false</hidden>
                <posx class="number">120</posx>
                <posy class="number">457</posy>
                <sizextype class="sizetype">FIXED</sizextype>
                <altersizex class="hidden">30</altersizex>
                <sizex class="number">500</sizex>
                <sizeytype class="sizetype">FIXED</sizeytype>
                <sizey class="number">20</sizey>
                <altersizey class="hidden">30</altersizey>
                <alty class="hidden">0</alty>
                <name class="text">OBJ_AnnonceListeAccompagnateurs</name>
                <id class="hidden">q84364518486115</id>
                <fieldButton class="node" component_en="Link to a directory field" component_fr="Lier &#224; un attribut annuaire" components="fieldPart" en="" fr="" indexed="local" maxcomp="1"></fieldButton>
                <components class="components">
                  <fieldPart class="node" en="" fr="">
                    <values class="node" delete_en="Delete" delete_fr="Supprimer" en="" fr="" indexed="father" position="false">
                      <field class="field"></field>
                    </values>
                  </fieldPart>
                </components>
              </textarea>
              <textarea>
                <content class="lingual">
                  <fr>Liste des accompagnateurs</fr>
                </content>
                <alignment class="fullalignment">left</alignment>
                <htmlcontent class="boolean">false</htmlcontent>
                <css class="css"></css>
                <tooltip class="lingual">
                  <fr></fr>
                </tooltip>
                <separator class="separator"></separator>
                <hidden class="boolean">false</hidden>
                <posx class="number">23</posx>
                <posy class="number">467</posy>
                <sizextype class="sizetype">FIXED</sizextype>
                <altersizex class="hidden">30</altersizex>
                <sizex class="number">500</sizex>
                <sizeytype class="sizetype">AUTOMATICSIZING</sizeytype>
                <sizey class="number">20</sizey>
                <altersizey class="hidden">30</altersizey>
                <alty class="hidden">0</alty>
                <name class="text">OBJ_listeAccompagnateurs</name>
                <id class="hidden">o84364519078216</id>
                <fieldButton class="node" component_en="Link to a directory field" component_fr="Lier &#224; un attribut annuaire" components="fieldPart" en="" fr="" indexed="local" maxcomp="1"></fieldButton>
                <components class="components">
                  <fieldPart class="node" en="" fr="">
                    <values class="node" delete_en="Delete" delete_fr="Supprimer" en="" fr="" indexed="father" position="false">
                      <field class="field"></field>
                    </values>
                  </fieldPart>
                </components>
              </textarea>
            </childs>
          </verticallayout>
        </childs>
      </verticallayout>
    </page>
  </destination>
</screen>
